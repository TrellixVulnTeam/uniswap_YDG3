{"ast":null,"code":"import _regeneratorRuntime from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _taggedTemplateLiteral from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _defineProperty from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";var _CHAIN_SUBGRAPH_URL,_templateObject,_templateObject2;import{createApi}from'@reduxjs/toolkit/query/react';import{SupportedChainId}from'constants/chains';import{ClientError,gql,GraphQLClient}from'graphql-request';// List of supported subgraphs. Note that the app currently only support one active subgraph at a time\nvar CHAIN_SUBGRAPH_URL=(_CHAIN_SUBGRAPH_URL={},_defineProperty(_CHAIN_SUBGRAPH_URL,SupportedChainId.MAINNET,'https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v3'),_defineProperty(_CHAIN_SUBGRAPH_URL,SupportedChainId.RINKEBY,'https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v3'),_defineProperty(_CHAIN_SUBGRAPH_URL,SupportedChainId.ARBITRUM_ONE,'https://api.thegraph.com/subgraphs/name/ianlapham/arbitrum-minimal'),_defineProperty(_CHAIN_SUBGRAPH_URL,SupportedChainId.OPTIMISM,'https://api.thegraph.com/subgraphs/name/ianlapham/uniswap-optimism-dev'),_defineProperty(_CHAIN_SUBGRAPH_URL,SupportedChainId.POLYGON,'https://api.thegraph.com/subgraphs/name/ianlapham/uniswap-v3-polygon'),_CHAIN_SUBGRAPH_URL);export var api=createApi({reducerPath:'dataApi',baseQuery:graphqlRequestBaseQuery(),endpoints:function endpoints(builder){return{allV3Ticks:builder.query({query:function query(_ref){var poolAddress=_ref.poolAddress,_ref$skip=_ref.skip,skip=_ref$skip===void 0?0:_ref$skip;return{document:gql(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n          query allV3Ticks($poolAddress: String!, $skip: Int!) {\\n            ticks(first: 1000, skip: $skip, where: { poolAddress: $poolAddress }, orderBy: tickIdx) {\\n              tickIdx\\n              liquidityNet\\n              price0\\n              price1\\n            }\\n          }\\n        \"]))),variables:{poolAddress:poolAddress,skip:skip}};}}),feeTierDistribution:builder.query({query:function query(_ref2){var token0=_ref2.token0,token1=_ref2.token1;return{document:gql(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n          query feeTierDistribution($token0: String!, $token1: String!) {\\n            _meta {\\n              block {\\n                number\\n              }\\n            }\\n            asToken0: pools(\\n              orderBy: totalValueLockedToken0\\n              orderDirection: desc\\n              where: { token0: $token0, token1: $token1 }\\n            ) {\\n              feeTier\\n              totalValueLockedToken0\\n              totalValueLockedToken1\\n            }\\n            asToken1: pools(\\n              orderBy: totalValueLockedToken0\\n              orderDirection: desc\\n              where: { token0: $token1, token1: $token0 }\\n            ) {\\n              feeTier\\n              totalValueLockedToken0\\n              totalValueLockedToken1\\n            }\\n          }\\n        \"]))),variables:{token0:token0,token1:token1}};}})};}});// Graphql query client wrapper that builds a dynamic url based on chain id\nfunction graphqlRequestBaseQuery(){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref3,_ref4){var document,variables,getState,chainId,subgraphUrl,name,message,stack,request,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:document=_ref3.document,variables=_ref3.variables;getState=_ref4.getState;_context.prev=2;chainId=getState().application.chainId;subgraphUrl=chainId?CHAIN_SUBGRAPH_URL[chainId]:undefined;if(subgraphUrl){_context.next=7;break;}return _context.abrupt(\"return\",{error:{name:'UnsupportedChainId',message:\"Subgraph queries against ChainId \".concat(chainId,\" are not supported.\"),stack:''}});case 7:_context.next=9;return new GraphQLClient(subgraphUrl).request(document,variables);case 9:_context.t0=_context.sent;_context.t1={};return _context.abrupt(\"return\",{data:_context.t0,meta:_context.t1});case 14:_context.prev=14;_context.t2=_context[\"catch\"](2);if(!(_context.t2 instanceof ClientError)){_context.next=19;break;}name=_context.t2.name,message=_context.t2.message,stack=_context.t2.stack,request=_context.t2.request,response=_context.t2.response;return _context.abrupt(\"return\",{error:{name:name,message:message,stack:stack},meta:{request:request,response:response}});case 19:throw _context.t2;case 20:case\"end\":return _context.stop();}}},_callee,null,[[2,14]]);}));return function(_x,_x2){return _ref5.apply(this,arguments);};}();}","map":{"version":3,"sources":["/Users/safahi/Downloads/interface-4.30.1/src/state/data/slice.ts"],"names":["createApi","SupportedChainId","ClientError","gql","GraphQLClient","CHAIN_SUBGRAPH_URL","MAINNET","RINKEBY","ARBITRUM_ONE","OPTIMISM","POLYGON","api","reducerPath","baseQuery","graphqlRequestBaseQuery","endpoints","builder","allV3Ticks","query","poolAddress","skip","document","variables","feeTierDistribution","token0","token1","getState","chainId","application","subgraphUrl","undefined","error","name","message","stack","request","data","meta","response"],"mappings":"osBACA,OAASA,SAAT,KAA0B,8BAA1B,CACA,OAASC,gBAAT,KAAiC,kBAAjC,CAEA,OAASC,WAAT,CAAsBC,GAAtB,CAA2BC,aAA3B,KAAgD,iBAAhD,CAGA;AACA,GAAMC,CAAAA,kBAA0C,6DAC7CJ,gBAAgB,CAACK,OAD4B,CAClB,4DADkB,sCAE7CL,gBAAgB,CAACM,OAF4B,CAElB,4DAFkB,sCAI7CN,gBAAgB,CAACO,YAJ4B,CAIb,oEAJa,sCAM7CP,gBAAgB,CAACQ,QAN4B,CAMjB,wEANiB,sCAQ7CR,gBAAgB,CAACS,OAR4B,CAQlB,sEARkB,sBAAhD,CAWA,MAAO,IAAMC,CAAAA,GAAG,CAAGX,SAAS,CAAC,CAC3BY,WAAW,CAAE,SADc,CAE3BC,SAAS,CAAEC,uBAAuB,EAFP,CAG3BC,SAAS,CAAE,mBAACC,OAAD,QAAc,CACvBC,UAAU,CAAED,OAAO,CAACE,KAAR,CAAc,CACxBA,KAAK,CAAE,wBAAGC,CAAAA,WAAH,MAAGA,WAAH,gBAAgBC,IAAhB,CAAgBA,IAAhB,oBAAuB,CAAvB,iBAAgC,CACrCC,QAAQ,CAAElB,GAAF,+WAD6B,CAWrCmB,SAAS,CAAE,CACTH,WAAW,CAAXA,WADS,CAETC,IAAI,CAAJA,IAFS,CAX0B,CAAhC,EADiB,CAAd,CADW,CAmBvBG,mBAAmB,CAAEP,OAAO,CAACE,KAAR,CAAc,CACjCA,KAAK,CAAE,yBAAGM,CAAAA,MAAH,OAAGA,MAAH,CAAWC,MAAX,OAAWA,MAAX,OAAyB,CAC9BJ,QAAQ,CAAElB,GAAF,u2BADsB,CA4B9BmB,SAAS,CAAE,CACTE,MAAM,CAANA,MADS,CAETC,MAAM,CAANA,MAFS,CA5BmB,CAAzB,EAD0B,CAAd,CAnBE,CAAd,EAHgB,CAAD,CAArB,CA4DP;AACA,QAASX,CAAAA,uBAAT,EAKE,CACA,gGAAO,sOAASO,QAAT,OAASA,QAAT,CAAmBC,SAAnB,OAAmBA,SAAnB,CAAkCI,QAAlC,OAAkCA,QAAlC,iBAEGC,OAFH,CAEcD,QAAQ,EAAT,CAAyBE,WAAzB,CAAqCD,OAFlD,CAIGE,WAJH,CAIiBF,OAAO,CAAGtB,kBAAkB,CAACsB,OAAD,CAArB,CAAiCG,SAJzD,IAMED,WANF,yDAOM,CACLE,KAAK,CAAE,CACLC,IAAI,CAAE,oBADD,CAELC,OAAO,4CAAsCN,OAAtC,uBAFF,CAGLO,KAAK,CAAE,EAHF,CADF,CAPN,+BAgBkB,IAAI9B,CAAAA,aAAJ,CAAkByB,WAAlB,EAA+BM,OAA/B,CAAuCd,QAAvC,CAAiDC,SAAjD,CAhBlB,8CAgBqF,EAhBrF,kCAgBMc,IAhBN,aAgB+EC,IAhB/E,8EAkBC,sBAAiBnC,CAAAA,WAlBlB,2BAmBO8B,IAnBP,aAmBOA,IAnBP,CAmBaC,OAnBb,aAmBaA,OAnBb,CAmBsBC,KAnBtB,aAmBsBA,KAnBtB,CAmB6BC,OAnB7B,aAmB6BA,OAnB7B,CAmBsCG,QAnBtC,aAmBsCA,QAnBtC,iCAoBM,CAAEP,KAAK,CAAE,CAAEC,IAAI,CAAJA,IAAF,CAAQC,OAAO,CAAPA,OAAR,CAAiBC,KAAK,CAALA,KAAjB,CAAT,CAAmCG,IAAI,CAAE,CAAEF,OAAO,CAAPA,OAAF,CAAWG,QAAQ,CAARA,QAAX,CAAzC,CApBN,iGAAP,oEAyBD","sourcesContent":["import { BaseQueryFn } from '@reduxjs/toolkit/query'\nimport { createApi } from '@reduxjs/toolkit/query/react'\nimport { SupportedChainId } from 'constants/chains'\nimport { DocumentNode } from 'graphql'\nimport { ClientError, gql, GraphQLClient } from 'graphql-request'\nimport { AppState } from 'state'\n\n// List of supported subgraphs. Note that the app currently only support one active subgraph at a time\nconst CHAIN_SUBGRAPH_URL: Record<number, string> = {\n  [SupportedChainId.MAINNET]: 'https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v3',\n  [SupportedChainId.RINKEBY]: 'https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v3',\n\n  [SupportedChainId.ARBITRUM_ONE]: 'https://api.thegraph.com/subgraphs/name/ianlapham/arbitrum-minimal',\n\n  [SupportedChainId.OPTIMISM]: 'https://api.thegraph.com/subgraphs/name/ianlapham/uniswap-optimism-dev',\n\n  [SupportedChainId.POLYGON]: 'https://api.thegraph.com/subgraphs/name/ianlapham/uniswap-v3-polygon',\n}\n\nexport const api = createApi({\n  reducerPath: 'dataApi',\n  baseQuery: graphqlRequestBaseQuery(),\n  endpoints: (builder) => ({\n    allV3Ticks: builder.query({\n      query: ({ poolAddress, skip = 0 }) => ({\n        document: gql`\n          query allV3Ticks($poolAddress: String!, $skip: Int!) {\n            ticks(first: 1000, skip: $skip, where: { poolAddress: $poolAddress }, orderBy: tickIdx) {\n              tickIdx\n              liquidityNet\n              price0\n              price1\n            }\n          }\n        `,\n        variables: {\n          poolAddress,\n          skip,\n        },\n      }),\n    }),\n    feeTierDistribution: builder.query({\n      query: ({ token0, token1 }) => ({\n        document: gql`\n          query feeTierDistribution($token0: String!, $token1: String!) {\n            _meta {\n              block {\n                number\n              }\n            }\n            asToken0: pools(\n              orderBy: totalValueLockedToken0\n              orderDirection: desc\n              where: { token0: $token0, token1: $token1 }\n            ) {\n              feeTier\n              totalValueLockedToken0\n              totalValueLockedToken1\n            }\n            asToken1: pools(\n              orderBy: totalValueLockedToken0\n              orderDirection: desc\n              where: { token0: $token1, token1: $token0 }\n            ) {\n              feeTier\n              totalValueLockedToken0\n              totalValueLockedToken1\n            }\n          }\n        `,\n        variables: {\n          token0,\n          token1,\n        },\n      }),\n    }),\n  }),\n})\n\n// Graphql query client wrapper that builds a dynamic url based on chain id\nfunction graphqlRequestBaseQuery(): BaseQueryFn<\n  { document: string | DocumentNode; variables?: any },\n  unknown,\n  Pick<ClientError, 'name' | 'message' | 'stack'>,\n  Partial<Pick<ClientError, 'request' | 'response'>>\n> {\n  return async ({ document, variables }, { getState }) => {\n    try {\n      const chainId = (getState() as AppState).application.chainId\n\n      const subgraphUrl = chainId ? CHAIN_SUBGRAPH_URL[chainId] : undefined\n\n      if (!subgraphUrl) {\n        return {\n          error: {\n            name: 'UnsupportedChainId',\n            message: `Subgraph queries against ChainId ${chainId} are not supported.`,\n            stack: '',\n          },\n        }\n      }\n\n      return { data: await new GraphQLClient(subgraphUrl).request(document, variables), meta: {} }\n    } catch (error) {\n      if (error instanceof ClientError) {\n        const { name, message, stack, request, response } = error\n        return { error: { name, message, stack }, meta: { request, response } }\n      }\n      throw error\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}