{"ast":null,"code":"import{createReducer}from'@reduxjs/toolkit';import{DEFAULT_DEADLINE_FROM_NOW}from'../../constants/misc';import{updateVersion}from'../global/actions';import{addSerializedPair,addSerializedToken,removeSerializedPair,removeSerializedToken,updateHideClosedPositions,updateMatchesDarkMode,updateUserClientSideRouter,updateUserDarkMode,updateUserDeadline,updateUserExpertMode,updateUserLocale,updateUserSlippageTolerance}from'./actions';var currentTimestamp=function currentTimestamp(){return new Date().getTime();};function pairKey(token0Address,token1Address){return\"\".concat(token0Address,\";\").concat(token1Address);}export var initialState={matchesDarkMode:false,userDarkMode:null,userExpertMode:false,userLocale:null,userClientSideRouter:false,userHideClosedPositions:false,userSlippageTolerance:'auto',userSlippageToleranceHasBeenMigratedToAuto:true,userDeadline:DEFAULT_DEADLINE_FROM_NOW,tokens:{},pairs:{},timestamp:currentTimestamp(),URLWarningVisible:true};export default createReducer(initialState,function(builder){return builder.addCase(updateVersion,function(state){// slippage isnt being tracked in local storage, reset to default\n// noinspection SuspiciousTypeOfGuard\nif(typeof state.userSlippageTolerance!=='number'||!Number.isInteger(state.userSlippageTolerance)||state.userSlippageTolerance<0||state.userSlippageTolerance>5000){state.userSlippageTolerance='auto';}else{if(!state.userSlippageToleranceHasBeenMigratedToAuto&&[10,50,100].indexOf(state.userSlippageTolerance)!==-1){state.userSlippageTolerance='auto';state.userSlippageToleranceHasBeenMigratedToAuto=true;}}// deadline isnt being tracked in local storage, reset to default\n// noinspection SuspiciousTypeOfGuard\nif(typeof state.userDeadline!=='number'||!Number.isInteger(state.userDeadline)||state.userDeadline<60||state.userDeadline>180*60){state.userDeadline=DEFAULT_DEADLINE_FROM_NOW;}state.lastUpdateVersionTimestamp=currentTimestamp();}).addCase(updateUserDarkMode,function(state,action){state.userDarkMode=action.payload.userDarkMode;state.timestamp=currentTimestamp();}).addCase(updateMatchesDarkMode,function(state,action){state.matchesDarkMode=action.payload.matchesDarkMode;state.timestamp=currentTimestamp();}).addCase(updateUserExpertMode,function(state,action){state.userExpertMode=action.payload.userExpertMode;state.timestamp=currentTimestamp();}).addCase(updateUserLocale,function(state,action){state.userLocale=action.payload.userLocale;state.timestamp=currentTimestamp();}).addCase(updateUserSlippageTolerance,function(state,action){state.userSlippageTolerance=action.payload.userSlippageTolerance;state.timestamp=currentTimestamp();}).addCase(updateUserDeadline,function(state,action){state.userDeadline=action.payload.userDeadline;state.timestamp=currentTimestamp();}).addCase(updateUserClientSideRouter,function(state,action){state.userClientSideRouter=action.payload.userClientSideRouter;}).addCase(updateHideClosedPositions,function(state,action){state.userHideClosedPositions=action.payload.userHideClosedPositions;}).addCase(addSerializedToken,function(state,_ref){var serializedToken=_ref.payload.serializedToken;if(!state.tokens){state.tokens={};}state.tokens[serializedToken.chainId]=state.tokens[serializedToken.chainId]||{};state.tokens[serializedToken.chainId][serializedToken.address]=serializedToken;state.timestamp=currentTimestamp();}).addCase(removeSerializedToken,function(state,_ref2){var _ref2$payload=_ref2.payload,address=_ref2$payload.address,chainId=_ref2$payload.chainId;if(!state.tokens){state.tokens={};}state.tokens[chainId]=state.tokens[chainId]||{};delete state.tokens[chainId][address];state.timestamp=currentTimestamp();}).addCase(addSerializedPair,function(state,_ref3){var serializedPair=_ref3.payload.serializedPair;if(serializedPair.token0.chainId===serializedPair.token1.chainId&&serializedPair.token0.address!==serializedPair.token1.address){var _chainId=serializedPair.token0.chainId;state.pairs[_chainId]=state.pairs[_chainId]||{};state.pairs[_chainId][pairKey(serializedPair.token0.address,serializedPair.token1.address)]=serializedPair;}state.timestamp=currentTimestamp();}).addCase(removeSerializedPair,function(state,_ref4){var _ref4$payload=_ref4.payload,chainId=_ref4$payload.chainId,tokenAAddress=_ref4$payload.tokenAAddress,tokenBAddress=_ref4$payload.tokenBAddress;if(state.pairs[chainId]){// just delete both keys if either exists\ndelete state.pairs[chainId][pairKey(tokenAAddress,tokenBAddress)];delete state.pairs[chainId][pairKey(tokenBAddress,tokenAAddress)];}state.timestamp=currentTimestamp();});});","map":{"version":3,"sources":["/Users/safahi/Downloads/interface-4.30.1/src/state/user/reducer.ts"],"names":["createReducer","DEFAULT_DEADLINE_FROM_NOW","updateVersion","addSerializedPair","addSerializedToken","removeSerializedPair","removeSerializedToken","updateHideClosedPositions","updateMatchesDarkMode","updateUserClientSideRouter","updateUserDarkMode","updateUserDeadline","updateUserExpertMode","updateUserLocale","updateUserSlippageTolerance","currentTimestamp","Date","getTime","pairKey","token0Address","token1Address","initialState","matchesDarkMode","userDarkMode","userExpertMode","userLocale","userClientSideRouter","userHideClosedPositions","userSlippageTolerance","userSlippageToleranceHasBeenMigratedToAuto","userDeadline","tokens","pairs","timestamp","URLWarningVisible","builder","addCase","state","Number","isInteger","indexOf","lastUpdateVersionTimestamp","action","payload","serializedToken","chainId","address","serializedPair","token0","token1","tokenAAddress","tokenBAddress"],"mappings":"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","sourcesContent":["import { createReducer } from '@reduxjs/toolkit'\nimport { SupportedLocale } from 'constants/locales'\n\nimport { DEFAULT_DEADLINE_FROM_NOW } from '../../constants/misc'\nimport { updateVersion } from '../global/actions'\nimport {\n  addSerializedPair,\n  addSerializedToken,\n  removeSerializedPair,\n  removeSerializedToken,\n  SerializedPair,\n  SerializedToken,\n  updateHideClosedPositions,\n  updateMatchesDarkMode,\n  updateUserClientSideRouter,\n  updateUserDarkMode,\n  updateUserDeadline,\n  updateUserExpertMode,\n  updateUserLocale,\n  updateUserSlippageTolerance,\n} from './actions'\n\nconst currentTimestamp = () => new Date().getTime()\n\nexport interface UserState {\n  // the timestamp of the last updateVersion action\n  lastUpdateVersionTimestamp?: number\n\n  matchesDarkMode: boolean // whether the dark mode media query matches\n\n  userDarkMode: boolean | null // the user's choice for dark mode or light mode\n  userLocale: SupportedLocale | null\n\n  userExpertMode: boolean\n\n  userClientSideRouter: boolean // whether routes should be calculated with the client side router only\n\n  // hides closed (inactive) positions across the app\n  userHideClosedPositions: boolean\n\n  // user defined slippage tolerance in bips, used in all txns\n  userSlippageTolerance: number | 'auto'\n  userSlippageToleranceHasBeenMigratedToAuto: boolean // temporary flag for migration status\n\n  // deadline set by user in minutes, used in all txns\n  userDeadline: number\n\n  tokens: {\n    [chainId: number]: {\n      [address: string]: SerializedToken\n    }\n  }\n\n  pairs: {\n    [chainId: number]: {\n      // keyed by token0Address:token1Address\n      [key: string]: SerializedPair\n    }\n  }\n\n  timestamp: number\n  URLWarningVisible: boolean\n}\n\nfunction pairKey(token0Address: string, token1Address: string) {\n  return `${token0Address};${token1Address}`\n}\n\nexport const initialState: UserState = {\n  matchesDarkMode: false,\n  userDarkMode: null,\n  userExpertMode: false,\n  userLocale: null,\n  userClientSideRouter: false,\n  userHideClosedPositions: false,\n  userSlippageTolerance: 'auto',\n  userSlippageToleranceHasBeenMigratedToAuto: true,\n  userDeadline: DEFAULT_DEADLINE_FROM_NOW,\n  tokens: {},\n  pairs: {},\n  timestamp: currentTimestamp(),\n  URLWarningVisible: true,\n}\n\nexport default createReducer(initialState, (builder) =>\n  builder\n    .addCase(updateVersion, (state) => {\n      // slippage isnt being tracked in local storage, reset to default\n      // noinspection SuspiciousTypeOfGuard\n      if (\n        typeof state.userSlippageTolerance !== 'number' ||\n        !Number.isInteger(state.userSlippageTolerance) ||\n        state.userSlippageTolerance < 0 ||\n        state.userSlippageTolerance > 5000\n      ) {\n        state.userSlippageTolerance = 'auto'\n      } else {\n        if (\n          !state.userSlippageToleranceHasBeenMigratedToAuto &&\n          [10, 50, 100].indexOf(state.userSlippageTolerance) !== -1\n        ) {\n          state.userSlippageTolerance = 'auto'\n          state.userSlippageToleranceHasBeenMigratedToAuto = true\n        }\n      }\n\n      // deadline isnt being tracked in local storage, reset to default\n      // noinspection SuspiciousTypeOfGuard\n      if (\n        typeof state.userDeadline !== 'number' ||\n        !Number.isInteger(state.userDeadline) ||\n        state.userDeadline < 60 ||\n        state.userDeadline > 180 * 60\n      ) {\n        state.userDeadline = DEFAULT_DEADLINE_FROM_NOW\n      }\n\n      state.lastUpdateVersionTimestamp = currentTimestamp()\n    })\n    .addCase(updateUserDarkMode, (state, action) => {\n      state.userDarkMode = action.payload.userDarkMode\n      state.timestamp = currentTimestamp()\n    })\n    .addCase(updateMatchesDarkMode, (state, action) => {\n      state.matchesDarkMode = action.payload.matchesDarkMode\n      state.timestamp = currentTimestamp()\n    })\n    .addCase(updateUserExpertMode, (state, action) => {\n      state.userExpertMode = action.payload.userExpertMode\n      state.timestamp = currentTimestamp()\n    })\n    .addCase(updateUserLocale, (state, action) => {\n      state.userLocale = action.payload.userLocale\n      state.timestamp = currentTimestamp()\n    })\n    .addCase(updateUserSlippageTolerance, (state, action) => {\n      state.userSlippageTolerance = action.payload.userSlippageTolerance\n      state.timestamp = currentTimestamp()\n    })\n    .addCase(updateUserDeadline, (state, action) => {\n      state.userDeadline = action.payload.userDeadline\n      state.timestamp = currentTimestamp()\n    })\n    .addCase(updateUserClientSideRouter, (state, action) => {\n      state.userClientSideRouter = action.payload.userClientSideRouter\n    })\n    .addCase(updateHideClosedPositions, (state, action) => {\n      state.userHideClosedPositions = action.payload.userHideClosedPositions\n    })\n    .addCase(addSerializedToken, (state, { payload: { serializedToken } }) => {\n      if (!state.tokens) {\n        state.tokens = {}\n      }\n      state.tokens[serializedToken.chainId] = state.tokens[serializedToken.chainId] || {}\n      state.tokens[serializedToken.chainId][serializedToken.address] = serializedToken\n      state.timestamp = currentTimestamp()\n    })\n    .addCase(removeSerializedToken, (state, { payload: { address, chainId } }) => {\n      if (!state.tokens) {\n        state.tokens = {}\n      }\n      state.tokens[chainId] = state.tokens[chainId] || {}\n      delete state.tokens[chainId][address]\n      state.timestamp = currentTimestamp()\n    })\n    .addCase(addSerializedPair, (state, { payload: { serializedPair } }) => {\n      if (\n        serializedPair.token0.chainId === serializedPair.token1.chainId &&\n        serializedPair.token0.address !== serializedPair.token1.address\n      ) {\n        const chainId = serializedPair.token0.chainId\n        state.pairs[chainId] = state.pairs[chainId] || {}\n        state.pairs[chainId][pairKey(serializedPair.token0.address, serializedPair.token1.address)] = serializedPair\n      }\n      state.timestamp = currentTimestamp()\n    })\n    .addCase(removeSerializedPair, (state, { payload: { chainId, tokenAAddress, tokenBAddress } }) => {\n      if (state.pairs[chainId]) {\n        // just delete both keys if either exists\n        delete state.pairs[chainId][pairKey(tokenAAddress, tokenBAddress)]\n        delete state.pairs[chainId][pairKey(tokenBAddress, tokenAAddress)]\n      }\n      state.timestamp = currentTimestamp()\n    })\n)\n"]},"metadata":{},"sourceType":"module"}