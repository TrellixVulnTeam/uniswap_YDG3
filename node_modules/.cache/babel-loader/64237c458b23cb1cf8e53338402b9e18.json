{"ast":null,"code":"import _regeneratorRuntime from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _styled from\"styled-components\";import{Trans}from\"@lingui/react\";import{useState}from'react';import{useStakingContract}from'../../hooks/useContract';import{useActiveWeb3React}from'../../hooks/web3';import{TransactionType}from'../../state/transactions/actions';import{useTransactionAdder}from'../../state/transactions/hooks';import{CloseIcon,ThemedText}from'../../theme';import{ButtonError}from'../Button';import{AutoColumn}from'../Column';import FormattedCurrencyAmount from'../FormattedCurrencyAmount';import Modal from'../Modal';import{LoadingView,SubmittedView}from'../ModalViews';import{RowBetween}from'../Row';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ContentWrapper=_styled(AutoColumn).withConfig({componentId:\"sc-14wre31-0\"})([\"width:100%;padding:1rem;\"]);export default function UnstakingModal(_ref){var _error2,_stakingInfo$stakedAm,_stakingInfo$earnedAm;var isOpen=_ref.isOpen,onDismiss=_ref.onDismiss,stakingInfo=_ref.stakingInfo;var _useActiveWeb3React=useActiveWeb3React(),account=_useActiveWeb3React.account;// monitor call to help UI loading state\nvar addTransaction=useTransactionAdder();var _useState=useState(),_useState2=_slicedToArray(_useState,2),hash=_useState2[0],setHash=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),attempting=_useState4[0],setAttempting=_useState4[1];function wrappedOndismiss(){setHash(undefined);setAttempting(false);onDismiss();}var stakingContract=useStakingContract(stakingInfo.stakingRewardAddress);function onWithdraw(){return _onWithdraw.apply(this,arguments);}function _onWithdraw(){_onWithdraw=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(stakingContract&&(stakingInfo===null||stakingInfo===void 0?void 0:stakingInfo.stakedAmount))){_context.next=4;break;}setAttempting(true);_context.next=4;return stakingContract.exit({gasLimit:300000}).then(function(response){addTransaction(response,{type:TransactionType.WITHDRAW_LIQUIDITY_STAKING,token0Address:stakingInfo.tokens[0].address,token1Address:stakingInfo.tokens[1].address});setHash(response.hash);}).catch(function(error){setAttempting(false);console.log(error);});case 4:case\"end\":return _context.stop();}}},_callee);}));return _onWithdraw.apply(this,arguments);}var error;if(!account){error=/*#__PURE__*/_jsx(Trans,{id:\"Connect a wallet\"});}if(!(stakingInfo===null||stakingInfo===void 0?void 0:stakingInfo.stakedAmount)){var _error;error=(_error=error)!==null&&_error!==void 0?_error:/*#__PURE__*/_jsx(Trans,{id:\"Enter an amount\"});}return/*#__PURE__*/_jsxs(Modal,{isOpen:isOpen,onDismiss:wrappedOndismiss,maxHeight:90,children:[!attempting&&!hash&&/*#__PURE__*/_jsxs(ContentWrapper,{gap:\"lg\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(ThemedText.MediumHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Withdraw\"})}),/*#__PURE__*/_jsx(CloseIcon,{onClick:wrappedOndismiss})]}),(stakingInfo===null||stakingInfo===void 0?void 0:stakingInfo.stakedAmount)&&/*#__PURE__*/_jsxs(AutoColumn,{justify:\"center\",gap:\"md\",children:[/*#__PURE__*/_jsx(ThemedText.Body,{fontWeight:600,fontSize:36,children:/*#__PURE__*/_jsx(FormattedCurrencyAmount,{currencyAmount:stakingInfo.stakedAmount})}),/*#__PURE__*/_jsx(ThemedText.Body,{children:/*#__PURE__*/_jsx(Trans,{id:\"Deposited liquidity:\"})})]}),(stakingInfo===null||stakingInfo===void 0?void 0:stakingInfo.earnedAmount)&&/*#__PURE__*/_jsxs(AutoColumn,{justify:\"center\",gap:\"md\",children:[/*#__PURE__*/_jsx(ThemedText.Body,{fontWeight:600,fontSize:36,children:/*#__PURE__*/_jsx(FormattedCurrencyAmount,{currencyAmount:stakingInfo===null||stakingInfo===void 0?void 0:stakingInfo.earnedAmount})}),/*#__PURE__*/_jsx(ThemedText.Body,{children:/*#__PURE__*/_jsx(Trans,{id:\"Unclaimed UNI\"})})]}),/*#__PURE__*/_jsx(ThemedText.SubHeader,{style:{textAlign:'center'},children:/*#__PURE__*/_jsx(Trans,{id:\"When you withdraw, your UNI is claimed and your liquidity is removed from the mining pool.\"})}),/*#__PURE__*/_jsx(ButtonError,{disabled:!!error,error:!!error&&!!(stakingInfo===null||stakingInfo===void 0?void 0:stakingInfo.stakedAmount),onClick:onWithdraw,children:(_error2=error)!==null&&_error2!==void 0?_error2:/*#__PURE__*/_jsx(Trans,{id:\"Withdraw & Claim\"})})]}),attempting&&!hash&&/*#__PURE__*/_jsx(LoadingView,{onDismiss:wrappedOndismiss,children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"12px\",justify:'center',children:[/*#__PURE__*/_jsx(ThemedText.Body,{fontSize:20,children:/*#__PURE__*/_jsx(Trans,{id:\"Withdrawing {0} UNI-V2\",values:{0:stakingInfo===null||stakingInfo===void 0?void 0:(_stakingInfo$stakedAm=stakingInfo.stakedAmount)===null||_stakingInfo$stakedAm===void 0?void 0:_stakingInfo$stakedAm.toSignificant(4)}})}),/*#__PURE__*/_jsx(ThemedText.Body,{fontSize:20,children:/*#__PURE__*/_jsx(Trans,{id:\"Claiming {0} UNI\",values:{0:stakingInfo===null||stakingInfo===void 0?void 0:(_stakingInfo$earnedAm=stakingInfo.earnedAmount)===null||_stakingInfo$earnedAm===void 0?void 0:_stakingInfo$earnedAm.toSignificant(4)}})})]})}),hash&&/*#__PURE__*/_jsx(SubmittedView,{onDismiss:wrappedOndismiss,hash:hash,children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"12px\",justify:'center',children:[/*#__PURE__*/_jsx(ThemedText.LargeHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Transaction Submitted\"})}),/*#__PURE__*/_jsx(ThemedText.Body,{fontSize:20,children:/*#__PURE__*/_jsx(Trans,{id:\"Withdrew UNI-V2!\"})}),/*#__PURE__*/_jsx(ThemedText.Body,{fontSize:20,children:/*#__PURE__*/_jsx(Trans,{id:\"Claimed UNI!\"})})]})})]});}","map":{"version":3,"sources":["/Users/safahi/Downloads/interface-4.30.1/src/components/earn/UnstakingModal.tsx"],"names":["useState","useStakingContract","useActiveWeb3React","TransactionType","useTransactionAdder","CloseIcon","ThemedText","ButtonError","AutoColumn","FormattedCurrencyAmount","Modal","LoadingView","SubmittedView","RowBetween","ContentWrapper","styled","UnstakingModal","isOpen","onDismiss","stakingInfo","account","addTransaction","hash","setHash","attempting","setAttempting","wrappedOndismiss","undefined","stakingContract","stakingRewardAddress","onWithdraw","stakedAmount","exit","gasLimit","then","response","type","WITHDRAW_LIQUIDITY_STAKING","token0Address","tokens","address","token1Address","catch","error","console","log","earnedAmount","textAlign","toSignificant"],"mappings":"kiBAEA,OAAoBA,QAApB,KAAoC,OAApC,CAGA,OAASC,kBAAT,KAAmC,yBAAnC,CACA,OAASC,kBAAT,KAAmC,kBAAnC,CAEA,OAASC,eAAT,KAAgC,kCAAhC,CACA,OAASC,mBAAT,KAAoC,gCAApC,CACA,OAASC,SAAT,CAAoBC,UAApB,KAAsC,aAAtC,CACA,OAASC,WAAT,KAA4B,WAA5B,CACA,OAASC,UAAT,KAA2B,WAA3B,CACA,MAAOC,CAAAA,uBAAP,KAAoC,4BAApC,CACA,MAAOC,CAAAA,KAAP,KAAkB,UAAlB,CACA,OAASC,WAAT,CAAsBC,aAAtB,KAA2C,eAA3C,CACA,OAASC,UAAT,KAA2B,QAA3B,C,wFAEA,GAAMC,CAAAA,cAAc,CAAGC,OAAM,CAACP,UAAD,CAAT,uEAApB,CAWA,cAAe,SAASQ,CAAAA,cAAT,MAA+E,4DAArDC,CAAAA,MAAqD,MAArDA,MAAqD,CAA7CC,SAA6C,MAA7CA,SAA6C,CAAlCC,WAAkC,MAAlCA,WAAkC,CAC5F,wBAAoBjB,kBAAkB,EAAtC,CAAQkB,OAAR,qBAAQA,OAAR,CAEA;AACA,GAAMC,CAAAA,cAAc,CAAGjB,mBAAmB,EAA1C,CACA,cAAwBJ,QAAQ,EAAhC,wCAAOsB,IAAP,eAAaC,OAAb,eACA,eAAoCvB,QAAQ,CAAC,KAAD,CAA5C,yCAAOwB,UAAP,eAAmBC,aAAnB,eAEA,QAASC,CAAAA,gBAAT,EAA4B,CAC1BH,OAAO,CAACI,SAAD,CAAP,CACAF,aAAa,CAAC,KAAD,CAAb,CACAP,SAAS,GACV,CAED,GAAMU,CAAAA,eAAe,CAAG3B,kBAAkB,CAACkB,WAAW,CAACU,oBAAb,CAA1C,CAd4F,QAgB7EC,CAAAA,UAhB6E,wIAgB5F,wIACMF,eAAe,GAAIT,WAAJ,SAAIA,WAAJ,iBAAIA,WAAW,CAAEY,YAAjB,CADrB,0BAEIN,aAAa,CAAC,IAAD,CAAb,CAFJ,sBAGUG,CAAAA,eAAe,CAClBI,IADG,CACE,CAAEC,QAAQ,CAAE,MAAZ,CADF,EAEHC,IAFG,CAEE,SAACC,QAAD,CAAmC,CACvCd,cAAc,CAACc,QAAD,CAAW,CACvBC,IAAI,CAAEjC,eAAe,CAACkC,0BADC,CAEvBC,aAAa,CAAEnB,WAAW,CAACoB,MAAZ,CAAmB,CAAnB,EAAsBC,OAFd,CAGvBC,aAAa,CAAEtB,WAAW,CAACoB,MAAZ,CAAmB,CAAnB,EAAsBC,OAHd,CAAX,CAAd,CAKAjB,OAAO,CAACY,QAAQ,CAACb,IAAV,CAAP,CACD,CATG,EAUHoB,KAVG,CAUG,SAACC,KAAD,CAAgB,CACrBlB,aAAa,CAAC,KAAD,CAAb,CACAmB,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACD,CAbG,CAHV,uDAhB4F,6CAoC5F,GAAIA,CAAAA,KAAJ,CACA,GAAI,CAACvB,OAAL,CAAc,CACZuB,KAAK,cAAG,mCAAR,CACD,CACD,GAAI,EAACxB,WAAD,SAACA,WAAD,iBAACA,WAAW,CAAEY,YAAd,CAAJ,CAAgC,YAC9BY,KAAK,SAAGA,KAAH,8CAAY,kCAAjB,CACD,CAED,mBACE,MAAC,KAAD,EAAO,MAAM,CAAE1B,MAAf,CAAuB,SAAS,CAAES,gBAAlC,CAAoD,SAAS,CAAE,EAA/D,WACG,CAACF,UAAD,EAAe,CAACF,IAAhB,eACC,MAAC,cAAD,EAAgB,GAAG,CAAC,IAApB,wBACE,MAAC,UAAD,yBACE,KAAC,UAAD,CAAY,YAAZ,wBACE,2BADF,EADF,cAIE,KAAC,SAAD,EAAW,OAAO,CAAEI,gBAApB,EAJF,GADF,CAOG,CAAAP,WAAW,OAAX,EAAAA,WAAW,SAAX,QAAAA,WAAW,CAAEY,YAAb,gBACC,MAAC,UAAD,EAAY,OAAO,CAAC,QAApB,CAA6B,GAAG,CAAC,IAAjC,wBACE,KAAC,UAAD,CAAY,IAAZ,EAAiB,UAAU,CAAE,GAA7B,CAAkC,QAAQ,CAAE,EAA5C,uBACG,KAAC,uBAAD,EAAyB,cAAc,CAAEZ,WAAW,CAACY,YAArD,EADH,EADF,cAIE,KAAC,UAAD,CAAY,IAAZ,wBACE,uCADF,EAJF,GARJ,CAiBG,CAAAZ,WAAW,OAAX,EAAAA,WAAW,SAAX,QAAAA,WAAW,CAAE2B,YAAb,gBACC,MAAC,UAAD,EAAY,OAAO,CAAC,QAApB,CAA6B,GAAG,CAAC,IAAjC,wBACE,KAAC,UAAD,CAAY,IAAZ,EAAiB,UAAU,CAAE,GAA7B,CAAkC,QAAQ,CAAE,EAA5C,uBACG,KAAC,uBAAD,EAAyB,cAAc,CAAE3B,WAAF,SAAEA,WAAF,iBAAEA,WAAW,CAAE2B,YAAtD,EADH,EADF,cAIE,KAAC,UAAD,CAAY,IAAZ,wBACE,gCADF,EAJF,GAlBJ,cA2BE,KAAC,UAAD,CAAY,SAAZ,EAAsB,KAAK,CAAE,CAAEC,SAAS,CAAE,QAAb,CAA7B,uBACE,6GADF,EA3BF,cA8BE,KAAC,WAAD,EAAa,QAAQ,CAAE,CAAC,CAACJ,KAAzB,CAAgC,KAAK,CAAE,CAAC,CAACA,KAAF,EAAW,CAAC,EAACxB,WAAD,SAACA,WAAD,iBAACA,WAAW,CAAEY,YAAd,CAAnD,CAA+E,OAAO,CAAED,UAAxF,mBACGa,KADH,gDACY,mCADZ,EA9BF,GAFJ,CAqCGnB,UAAU,EAAI,CAACF,IAAf,eACC,KAAC,WAAD,EAAa,SAAS,CAAEI,gBAAxB,uBACE,MAAC,UAAD,EAAY,GAAG,CAAC,MAAhB,CAAuB,OAAO,CAAE,QAAhC,wBACE,KAAC,UAAD,CAAY,IAAZ,EAAiB,QAAQ,CAAE,EAA3B,uBACE,kDAAoBP,WAApB,SAAoBA,WAApB,wCAAoBA,WAAW,CAAEY,YAAjC,gDAAoB,sBAA2BiB,aAA3B,CAAyC,CAAzC,CAApB,GADF,EADF,cAIE,KAAC,UAAD,CAAY,IAAZ,EAAiB,QAAQ,CAAE,EAA3B,uBACE,4CAAiB7B,WAAjB,SAAiBA,WAAjB,wCAAiBA,WAAW,CAAE2B,YAA9B,gDAAiB,sBAA2BE,aAA3B,CAAyC,CAAzC,CAAjB,GADF,EAJF,GADF,EAtCJ,CAiDG1B,IAAI,eACH,KAAC,aAAD,EAAe,SAAS,CAAEI,gBAA1B,CAA4C,IAAI,CAAEJ,IAAlD,uBACE,MAAC,UAAD,EAAY,GAAG,CAAC,MAAhB,CAAuB,OAAO,CAAE,QAAhC,wBACE,KAAC,UAAD,CAAY,WAAZ,wBACE,wCADF,EADF,cAIE,KAAC,UAAD,CAAY,IAAZ,EAAiB,QAAQ,CAAE,EAA3B,uBACE,mCADF,EAJF,cAOE,KAAC,UAAD,CAAY,IAAZ,EAAiB,QAAQ,CAAE,EAA3B,uBACE,+BADF,EAPF,GADF,EAlDJ,GADF,CAmED","sourcesContent":["import { TransactionResponse } from '@ethersproject/providers'\nimport { Trans } from '@lingui/macro'\nimport { ReactNode, useState } from 'react'\nimport styled from 'styled-components/macro'\n\nimport { useStakingContract } from '../../hooks/useContract'\nimport { useActiveWeb3React } from '../../hooks/web3'\nimport { StakingInfo } from '../../state/stake/hooks'\nimport { TransactionType } from '../../state/transactions/actions'\nimport { useTransactionAdder } from '../../state/transactions/hooks'\nimport { CloseIcon, ThemedText } from '../../theme'\nimport { ButtonError } from '../Button'\nimport { AutoColumn } from '../Column'\nimport FormattedCurrencyAmount from '../FormattedCurrencyAmount'\nimport Modal from '../Modal'\nimport { LoadingView, SubmittedView } from '../ModalViews'\nimport { RowBetween } from '../Row'\n\nconst ContentWrapper = styled(AutoColumn)`\n  width: 100%;\n  padding: 1rem;\n`\n\ninterface StakingModalProps {\n  isOpen: boolean\n  onDismiss: () => void\n  stakingInfo: StakingInfo\n}\n\nexport default function UnstakingModal({ isOpen, onDismiss, stakingInfo }: StakingModalProps) {\n  const { account } = useActiveWeb3React()\n\n  // monitor call to help UI loading state\n  const addTransaction = useTransactionAdder()\n  const [hash, setHash] = useState<string | undefined>()\n  const [attempting, setAttempting] = useState(false)\n\n  function wrappedOndismiss() {\n    setHash(undefined)\n    setAttempting(false)\n    onDismiss()\n  }\n\n  const stakingContract = useStakingContract(stakingInfo.stakingRewardAddress)\n\n  async function onWithdraw() {\n    if (stakingContract && stakingInfo?.stakedAmount) {\n      setAttempting(true)\n      await stakingContract\n        .exit({ gasLimit: 300000 })\n        .then((response: TransactionResponse) => {\n          addTransaction(response, {\n            type: TransactionType.WITHDRAW_LIQUIDITY_STAKING,\n            token0Address: stakingInfo.tokens[0].address,\n            token1Address: stakingInfo.tokens[1].address,\n          })\n          setHash(response.hash)\n        })\n        .catch((error: any) => {\n          setAttempting(false)\n          console.log(error)\n        })\n    }\n  }\n\n  let error: ReactNode | undefined\n  if (!account) {\n    error = <Trans>Connect a wallet</Trans>\n  }\n  if (!stakingInfo?.stakedAmount) {\n    error = error ?? <Trans>Enter an amount</Trans>\n  }\n\n  return (\n    <Modal isOpen={isOpen} onDismiss={wrappedOndismiss} maxHeight={90}>\n      {!attempting && !hash && (\n        <ContentWrapper gap=\"lg\">\n          <RowBetween>\n            <ThemedText.MediumHeader>\n              <Trans>Withdraw</Trans>\n            </ThemedText.MediumHeader>\n            <CloseIcon onClick={wrappedOndismiss} />\n          </RowBetween>\n          {stakingInfo?.stakedAmount && (\n            <AutoColumn justify=\"center\" gap=\"md\">\n              <ThemedText.Body fontWeight={600} fontSize={36}>\n                {<FormattedCurrencyAmount currencyAmount={stakingInfo.stakedAmount} />}\n              </ThemedText.Body>\n              <ThemedText.Body>\n                <Trans>Deposited liquidity:</Trans>\n              </ThemedText.Body>\n            </AutoColumn>\n          )}\n          {stakingInfo?.earnedAmount && (\n            <AutoColumn justify=\"center\" gap=\"md\">\n              <ThemedText.Body fontWeight={600} fontSize={36}>\n                {<FormattedCurrencyAmount currencyAmount={stakingInfo?.earnedAmount} />}\n              </ThemedText.Body>\n              <ThemedText.Body>\n                <Trans>Unclaimed UNI</Trans>\n              </ThemedText.Body>\n            </AutoColumn>\n          )}\n          <ThemedText.SubHeader style={{ textAlign: 'center' }}>\n            <Trans>When you withdraw, your UNI is claimed and your liquidity is removed from the mining pool.</Trans>\n          </ThemedText.SubHeader>\n          <ButtonError disabled={!!error} error={!!error && !!stakingInfo?.stakedAmount} onClick={onWithdraw}>\n            {error ?? <Trans>Withdraw & Claim</Trans>}\n          </ButtonError>\n        </ContentWrapper>\n      )}\n      {attempting && !hash && (\n        <LoadingView onDismiss={wrappedOndismiss}>\n          <AutoColumn gap=\"12px\" justify={'center'}>\n            <ThemedText.Body fontSize={20}>\n              <Trans>Withdrawing {stakingInfo?.stakedAmount?.toSignificant(4)} UNI-V2</Trans>\n            </ThemedText.Body>\n            <ThemedText.Body fontSize={20}>\n              <Trans>Claiming {stakingInfo?.earnedAmount?.toSignificant(4)} UNI</Trans>\n            </ThemedText.Body>\n          </AutoColumn>\n        </LoadingView>\n      )}\n      {hash && (\n        <SubmittedView onDismiss={wrappedOndismiss} hash={hash}>\n          <AutoColumn gap=\"12px\" justify={'center'}>\n            <ThemedText.LargeHeader>\n              <Trans>Transaction Submitted</Trans>\n            </ThemedText.LargeHeader>\n            <ThemedText.Body fontSize={20}>\n              <Trans>Withdrew UNI-V2!</Trans>\n            </ThemedText.Body>\n            <ThemedText.Body fontSize={20}>\n              <Trans>Claimed UNI!</Trans>\n            </ThemedText.Body>\n          </AutoColumn>\n        </SubmittedView>\n      )}\n    </Modal>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}