{"ast":null,"code":"import _slicedToArray from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _styled from\"styled-components\";var _templateObject;import{Trans}from\"@lingui/react\";import{i18n}from\"@lingui/core\";import{BigNumber}from'@ethersproject/bignumber';// eslint-disable-next-line no-restricted-imports\nimport{useActiveLocale}from'hooks/useActiveLocale';import useCurrentBlockTimestamp from'hooks/useCurrentBlockTimestamp';import JSBI from'jsbi';import{useState}from'react';import{ArrowLeft}from'react-feather';import ReactMarkdown from'react-markdown';import{ButtonPrimary}from'../../components/Button';import{GreyCard}from'../../components/Card';import{AutoColumn}from'../../components/Column';import{CardSection,DataCard}from'../../components/earn/styled';import{RowBetween,RowFixed}from'../../components/Row';import{SwitchLocaleLink}from'../../components/SwitchLocaleLink';import DelegateModal from'../../components/vote/DelegateModal';import VoteModal from'../../components/vote/VoteModal';import{AVERAGE_BLOCK_TIME_IN_SECS,COMMON_CONTRACT_NAMES,DEFAULT_AVERAGE_BLOCK_TIME_IN_SECS}from'../../constants/governance';import{ZERO_ADDRESS}from'../../constants/misc';import{UNI}from'../../constants/tokens';import{useActiveWeb3React}from'../../hooks/web3';import{useBlockNumber,useModalOpen,useToggleDelegateModal,useToggleVoteModal}from'../../state/application/hooks';import{ApplicationModal}from'../../state/application/reducer';import{ProposalState,useProposalData,useUserDelegatee,useUserVotesAsOfBlock}from'../../state/governance/hooks';import{VoteOption}from'../../state/governance/types';import{useTokenBalance}from'../../state/wallet/hooks';import{ExternalLink,StyledInternalLink,ThemedText}from'../../theme';import{isAddress}from'../../utils';import{ExplorerDataType,getExplorerLink}from'../../utils/getExplorerLink';import{ProposalStatus}from'./styled';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PageWrapper=_styled(AutoColumn).withConfig({componentId:\"sc-1vobn0f-0\"})([\"width:100%;\"]);var ProposalInfo=_styled(AutoColumn).withConfig({componentId:\"sc-1vobn0f-1\"})([\"background:\",\";border-radius:12px;padding:1.5rem;position:relative;max-width:640px;width:100%;\"],function(_ref){var theme=_ref.theme;return theme.bg0;});var ArrowWrapper=_styled(StyledInternalLink).withConfig({componentId:\"sc-1vobn0f-2\"})([\"display:flex;align-items:center;gap:8px;height:24px;color:\",\";a{color:\",\";text-decoration:none;}:hover{text-decoration:none;}\"],function(_ref2){var theme=_ref2.theme;return theme.text1;},function(_ref3){var theme=_ref3.theme;return theme.text1;});var CardWrapper=_styled.div.withConfig({componentId:\"sc-1vobn0f-3\"})([\"display:grid;grid-template-columns:1fr 1fr;gap:12px;width:100%;\"]);var StyledDataCard=_styled(DataCard).withConfig({componentId:\"sc-1vobn0f-4\"})([\"width:100%;background:none;background-color:\",\";height:fit-content;z-index:2;\"],function(_ref4){var theme=_ref4.theme;return theme.bg1;});var ProgressWrapper=_styled.div.withConfig({componentId:\"sc-1vobn0f-5\"})([\"width:100%;margin-top:1rem;height:4px;border-radius:4px;background-color:\",\";position:relative;\"],function(_ref5){var theme=_ref5.theme;return theme.bg3;});var Progress=_styled.div.withConfig({componentId:\"sc-1vobn0f-6\"})([\"height:4px;border-radius:4px;background-color:\",\";width:\",\";\"],function(_ref6){var theme=_ref6.theme,status=_ref6.status;return status==='for'?theme.green1:theme.red1;},function(_ref7){var percentageString=_ref7.percentageString;return percentageString;});var MarkDownWrapper=_styled.div.withConfig({componentId:\"sc-1vobn0f-7\"})([\"max-width:640px;overflow:hidden;\"]);var WrapSmall=_styled(RowBetween).withConfig({componentId:\"sc-1vobn0f-8\"})([\"\",\";\"],function(_ref8){var theme=_ref8.theme;return theme.mediaWidth.upToSmall(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    align-items: flex-start;\\n    flex-direction: column;\\n  \"])));});var DetailText=_styled.div.withConfig({componentId:\"sc-1vobn0f-9\"})([\"word-break:break-all;\"]);var ProposerAddressLink=_styled(ExternalLink).withConfig({componentId:\"sc-1vobn0f-10\"})([\"word-break:break-all;\"]);function getDateFromBlock(targetBlock,currentBlock,averageBlockTimeInSeconds,currentTimestamp){if(targetBlock&&currentBlock&&averageBlockTimeInSeconds&&currentTimestamp){var date=new Date();date.setTime(currentTimestamp.add(BigNumber.from(averageBlockTimeInSeconds).mul(BigNumber.from(targetBlock-currentBlock))).toNumber()*1000);return date;}return undefined;}export default function VotePage(_ref9){var _ref10,_ref11,_proposalData$startBl,_proposalData$forCoun,_proposalData$against,_proposalData$details;var _ref9$match$params=_ref9.match.params,governorIndex=_ref9$match$params.governorIndex,id=_ref9$match$params.id;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId,account=_useActiveWeb3React.account;// get data for this specific proposal\nvar proposalData=useProposalData(Number.parseInt(governorIndex),id);// update vote option based on button interactions\nvar _useState=useState(undefined),_useState2=_slicedToArray(_useState,2),voteOption=_useState2[0],setVoteOption=_useState2[1];// modal for casting votes\nvar showVoteModal=useModalOpen(ApplicationModal.VOTE);var toggleVoteModal=useToggleVoteModal();// toggle for showing delegation modal\nvar showDelegateModal=useModalOpen(ApplicationModal.DELEGATE);var toggleDelegateModal=useToggleDelegateModal();// get and format date from data\nvar currentTimestamp=useCurrentBlockTimestamp();var currentBlock=useBlockNumber();var startDate=getDateFromBlock(proposalData===null||proposalData===void 0?void 0:proposalData.startBlock,currentBlock,(_ref10=chainId&&AVERAGE_BLOCK_TIME_IN_SECS[chainId])!==null&&_ref10!==void 0?_ref10:DEFAULT_AVERAGE_BLOCK_TIME_IN_SECS,currentTimestamp);var endDate=getDateFromBlock(proposalData===null||proposalData===void 0?void 0:proposalData.endBlock,currentBlock,(_ref11=chainId&&AVERAGE_BLOCK_TIME_IN_SECS[chainId])!==null&&_ref11!==void 0?_ref11:DEFAULT_AVERAGE_BLOCK_TIME_IN_SECS,currentTimestamp);var now=new Date();var locale=useActiveLocale();var dateFormat={year:'numeric',month:'long',day:'numeric',hour:'numeric',minute:'numeric',timeZoneName:'short'};// get total votes and format percentages for UI\nvar totalVotes=proposalData?proposalData.forCount+proposalData.againstCount:undefined;var forPercentage=/*i18n*/i18n._(\"{0} %\",{0:proposalData&&totalVotes?(proposalData.forCount*100/totalVotes).toFixed(0):'0'});var againstPercentage=/*i18n*/i18n._(\"{0} %\",{0:proposalData&&totalVotes?(proposalData.againstCount*100/totalVotes).toFixed(0):'0'});// only count available votes as of the proposal start block\nvar availableVotes=useUserVotesAsOfBlock((_proposalData$startBl=proposalData===null||proposalData===void 0?void 0:proposalData.startBlock)!==null&&_proposalData$startBl!==void 0?_proposalData$startBl:undefined);// only show voting if user has > 0 votes at proposal start block and proposal is active,\nvar showVotingButtons=availableVotes&&JSBI.greaterThan(availableVotes.quotient,JSBI.BigInt(0))&&proposalData&&proposalData.status===ProposalState.ACTIVE;var uniBalance=useTokenBalance(account!==null&&account!==void 0?account:undefined,chainId?UNI[chainId]:undefined);var userDelegatee=useUserDelegatee();// in blurb link to home page if they are able to unlock\nvar showLinkForUnlock=Boolean(uniBalance&&JSBI.notEqual(uniBalance.quotient,JSBI.BigInt(0))&&userDelegatee===ZERO_ADDRESS);// show links in propsoal details if content is an address\n// if content is contract with common name, replace address with common name\nvar linkIfAddress=function linkIfAddress(content){if(isAddress(content)&&chainId){var _COMMON_CONTRACT_NAME,_COMMON_CONTRACT_NAME2;var commonName=(_COMMON_CONTRACT_NAME=(_COMMON_CONTRACT_NAME2=COMMON_CONTRACT_NAMES[chainId])===null||_COMMON_CONTRACT_NAME2===void 0?void 0:_COMMON_CONTRACT_NAME2[content])!==null&&_COMMON_CONTRACT_NAME!==void 0?_COMMON_CONTRACT_NAME:content;return/*#__PURE__*/_jsx(ExternalLink,{href:getExplorerLink(chainId,content,ExplorerDataType.ADDRESS),children:commonName});}return/*#__PURE__*/_jsx(\"span\",{children:content});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(PageWrapper,{gap:\"lg\",justify:\"center\",children:[/*#__PURE__*/_jsx(VoteModal,{isOpen:showVoteModal,onDismiss:toggleVoteModal,proposalId:proposalData===null||proposalData===void 0?void 0:proposalData.id,voteOption:voteOption}),/*#__PURE__*/_jsx(DelegateModal,{isOpen:showDelegateModal,onDismiss:toggleDelegateModal,title:/*#__PURE__*/_jsx(Trans,{id:\"Unlock Votes\"})}),/*#__PURE__*/_jsxs(ProposalInfo,{gap:\"lg\",justify:\"start\",children:[/*#__PURE__*/_jsxs(RowBetween,{style:{width:'100%'},children:[/*#__PURE__*/_jsx(ArrowWrapper,{to:\"/vote\",children:/*#__PURE__*/_jsx(Trans,{id:\"<0/> All Proposals\",components:{0:/*#__PURE__*/_jsx(ArrowLeft,{size:20})}})}),proposalData&&/*#__PURE__*/_jsx(ProposalStatus,{status:proposalData.status})]}),/*#__PURE__*/_jsxs(AutoColumn,{gap:\"10px\",style:{width:'100%'},children:[/*#__PURE__*/_jsx(ThemedText.LargeHeader,{style:{marginBottom:'.5rem'},children:proposalData===null||proposalData===void 0?void 0:proposalData.title}),/*#__PURE__*/_jsx(RowBetween,{children:/*#__PURE__*/_jsx(ThemedText.Main,{children:startDate&&startDate>now?/*#__PURE__*/_jsx(Trans,{id:\"Voting starts approximately {0}\",values:{0:startDate.toLocaleString(locale,dateFormat)}}):null})}),/*#__PURE__*/_jsx(RowBetween,{children:/*#__PURE__*/_jsx(ThemedText.Main,{children:endDate&&(endDate<now?/*#__PURE__*/_jsx(Trans,{id:\"Voting ended {0}\",values:{0:endDate.toLocaleString(locale,dateFormat)}}):/*#__PURE__*/_jsx(Trans,{id:\"Voting ends approximately {0}\",values:{0:endDate.toLocaleString(locale,dateFormat)}}))})}),proposalData&&proposalData.status===ProposalState.ACTIVE&&!showVotingButtons&&/*#__PURE__*/_jsx(GreyCard,{children:/*#__PURE__*/_jsxs(ThemedText.Black,{children:[/*#__PURE__*/_jsx(Trans,{id:\"Only UNI votes that were self delegated or delegated to another address before block {0} are eligible for voting.\",values:{0:proposalData.startBlock}}),showLinkForUnlock&&/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(Trans,{id:\"<0>Unlock voting</0> to prepare for the next proposal.\",components:{0:/*#__PURE__*/_jsx(StyledInternalLink,{to:\"/vote\"})}})})]})})]}),showVotingButtons?/*#__PURE__*/_jsxs(RowFixed,{style:{width:'100%',gap:'12px'},children:[/*#__PURE__*/_jsx(ButtonPrimary,{padding:\"8px\",$borderRadius:\"8px\",onClick:function onClick(){setVoteOption(VoteOption.For);toggleVoteModal();},children:/*#__PURE__*/_jsx(Trans,{id:\"Vote For\"})}),/*#__PURE__*/_jsx(ButtonPrimary,{padding:\"8px\",$borderRadius:\"8px\",onClick:function onClick(){setVoteOption(VoteOption.Against);toggleVoteModal();},children:/*#__PURE__*/_jsx(Trans,{id:\"Vote Against\"})})]}):'',/*#__PURE__*/_jsxs(CardWrapper,{children:[/*#__PURE__*/_jsx(StyledDataCard,{children:/*#__PURE__*/_jsxs(CardSection,{children:[/*#__PURE__*/_jsx(AutoColumn,{gap:\"md\",children:/*#__PURE__*/_jsxs(WrapSmall,{children:[/*#__PURE__*/_jsx(ThemedText.Black,{fontWeight:600,children:/*#__PURE__*/_jsx(Trans,{id:\"For\"})}),/*#__PURE__*/_jsx(ThemedText.Black,{fontWeight:600,children:proposalData===null||proposalData===void 0?void 0:(_proposalData$forCoun=proposalData.forCount)===null||_proposalData$forCoun===void 0?void 0:_proposalData$forCoun.toLocaleString(undefined,{maximumFractionDigits:0})})]})}),/*#__PURE__*/_jsx(ProgressWrapper,{children:/*#__PURE__*/_jsx(Progress,{status:'for',percentageString:forPercentage})})]})}),/*#__PURE__*/_jsx(StyledDataCard,{children:/*#__PURE__*/_jsxs(CardSection,{children:[/*#__PURE__*/_jsx(AutoColumn,{gap:\"md\",children:/*#__PURE__*/_jsxs(WrapSmall,{children:[/*#__PURE__*/_jsx(ThemedText.Black,{fontWeight:600,children:/*#__PURE__*/_jsx(Trans,{id:\"Against\"})}),/*#__PURE__*/_jsx(ThemedText.Black,{fontWeight:600,children:proposalData===null||proposalData===void 0?void 0:(_proposalData$against=proposalData.againstCount)===null||_proposalData$against===void 0?void 0:_proposalData$against.toLocaleString(undefined,{maximumFractionDigits:0})})]})}),/*#__PURE__*/_jsx(ProgressWrapper,{children:/*#__PURE__*/_jsx(Progress,{status:'against',percentageString:againstPercentage})})]})})]}),/*#__PURE__*/_jsxs(AutoColumn,{gap:\"md\",children:[/*#__PURE__*/_jsx(ThemedText.MediumHeader,{fontWeight:600,children:/*#__PURE__*/_jsx(Trans,{id:\"Details\"})}),proposalData===null||proposalData===void 0?void 0:(_proposalData$details=proposalData.details)===null||_proposalData$details===void 0?void 0:_proposalData$details.map(function(d,i){return/*#__PURE__*/_jsxs(DetailText,{children:[i+1,\": \",linkIfAddress(d.target),\".\",d.functionSig,\"(\",d.callData.split(',').map(function(content,i){return/*#__PURE__*/_jsxs(\"span\",{children:[linkIfAddress(content),d.callData.split(',').length-1===i?'':',']},i);}),\")\"]},i);})]}),/*#__PURE__*/_jsxs(AutoColumn,{gap:\"md\",children:[/*#__PURE__*/_jsx(ThemedText.MediumHeader,{fontWeight:600,children:/*#__PURE__*/_jsx(Trans,{id:\"Description\"})}),/*#__PURE__*/_jsx(MarkDownWrapper,{children:/*#__PURE__*/_jsx(ReactMarkdown,{source:proposalData===null||proposalData===void 0?void 0:proposalData.description})})]}),/*#__PURE__*/_jsxs(AutoColumn,{gap:\"md\",children:[/*#__PURE__*/_jsx(ThemedText.MediumHeader,{fontWeight:600,children:/*#__PURE__*/_jsx(Trans,{id:\"Proposer\"})}),/*#__PURE__*/_jsx(ProposerAddressLink,{href:(proposalData===null||proposalData===void 0?void 0:proposalData.proposer)&&chainId?getExplorerLink(chainId,proposalData===null||proposalData===void 0?void 0:proposalData.proposer,ExplorerDataType.ADDRESS):'',children:/*#__PURE__*/_jsx(ReactMarkdown,{source:proposalData===null||proposalData===void 0?void 0:proposalData.proposer})})]})]})]}),/*#__PURE__*/_jsx(SwitchLocaleLink,{})]});}","map":{"version":3,"sources":["/Users/safahi/Downloads/interface-4.30.1/src/pages/Vote/VotePage.tsx"],"names":["BigNumber","useActiveLocale","useCurrentBlockTimestamp","JSBI","useState","ArrowLeft","ReactMarkdown","ButtonPrimary","GreyCard","AutoColumn","CardSection","DataCard","RowBetween","RowFixed","SwitchLocaleLink","DelegateModal","VoteModal","AVERAGE_BLOCK_TIME_IN_SECS","COMMON_CONTRACT_NAMES","DEFAULT_AVERAGE_BLOCK_TIME_IN_SECS","ZERO_ADDRESS","UNI","useActiveWeb3React","useBlockNumber","useModalOpen","useToggleDelegateModal","useToggleVoteModal","ApplicationModal","ProposalState","useProposalData","useUserDelegatee","useUserVotesAsOfBlock","VoteOption","useTokenBalance","ExternalLink","StyledInternalLink","ThemedText","isAddress","ExplorerDataType","getExplorerLink","ProposalStatus","PageWrapper","styled","ProposalInfo","theme","bg0","ArrowWrapper","text1","CardWrapper","div","StyledDataCard","bg1","ProgressWrapper","bg3","Progress","status","green1","red1","percentageString","MarkDownWrapper","WrapSmall","mediaWidth","upToSmall","DetailText","ProposerAddressLink","getDateFromBlock","targetBlock","currentBlock","averageBlockTimeInSeconds","currentTimestamp","date","Date","setTime","add","from","mul","toNumber","undefined","VotePage","match","params","governorIndex","id","chainId","account","proposalData","Number","parseInt","voteOption","setVoteOption","showVoteModal","VOTE","toggleVoteModal","showDelegateModal","DELEGATE","toggleDelegateModal","startDate","startBlock","endDate","endBlock","now","locale","dateFormat","year","month","day","hour","minute","timeZoneName","totalVotes","forCount","againstCount","forPercentage","toFixed","againstPercentage","availableVotes","showVotingButtons","greaterThan","quotient","BigInt","ACTIVE","uniBalance","userDelegatee","showLinkForUnlock","Boolean","notEqual","linkIfAddress","content","commonName","ADDRESS","width","marginBottom","title","toLocaleString","gap","For","Against","maximumFractionDigits","details","map","d","i","target","functionSig","callData","split","length","description","proposer"],"mappings":"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","sourcesContent":["import { BigNumber } from '@ethersproject/bignumber'\n// eslint-disable-next-line no-restricted-imports\nimport { t, Trans } from '@lingui/macro'\nimport { CurrencyAmount, Token } from '@uniswap/sdk-core'\nimport { useActiveLocale } from 'hooks/useActiveLocale'\nimport useCurrentBlockTimestamp from 'hooks/useCurrentBlockTimestamp'\nimport JSBI from 'jsbi'\nimport { useState } from 'react'\nimport { ArrowLeft } from 'react-feather'\nimport ReactMarkdown from 'react-markdown'\nimport { RouteComponentProps } from 'react-router-dom'\nimport styled from 'styled-components/macro'\n\nimport { ButtonPrimary } from '../../components/Button'\nimport { GreyCard } from '../../components/Card'\nimport { AutoColumn } from '../../components/Column'\nimport { CardSection, DataCard } from '../../components/earn/styled'\nimport { RowBetween, RowFixed } from '../../components/Row'\nimport { SwitchLocaleLink } from '../../components/SwitchLocaleLink'\nimport DelegateModal from '../../components/vote/DelegateModal'\nimport VoteModal from '../../components/vote/VoteModal'\nimport {\n  AVERAGE_BLOCK_TIME_IN_SECS,\n  COMMON_CONTRACT_NAMES,\n  DEFAULT_AVERAGE_BLOCK_TIME_IN_SECS,\n} from '../../constants/governance'\nimport { ZERO_ADDRESS } from '../../constants/misc'\nimport { UNI } from '../../constants/tokens'\nimport { useActiveWeb3React } from '../../hooks/web3'\nimport { useBlockNumber, useModalOpen, useToggleDelegateModal, useToggleVoteModal } from '../../state/application/hooks'\nimport { ApplicationModal } from '../../state/application/reducer'\nimport {\n  ProposalData,\n  ProposalState,\n  useProposalData,\n  useUserDelegatee,\n  useUserVotesAsOfBlock,\n} from '../../state/governance/hooks'\nimport { VoteOption } from '../../state/governance/types'\nimport { useTokenBalance } from '../../state/wallet/hooks'\nimport { ExternalLink, StyledInternalLink, ThemedText } from '../../theme'\nimport { isAddress } from '../../utils'\nimport { ExplorerDataType, getExplorerLink } from '../../utils/getExplorerLink'\nimport { ProposalStatus } from './styled'\n\nconst PageWrapper = styled(AutoColumn)`\n  width: 100%;\n`\n\nconst ProposalInfo = styled(AutoColumn)`\n  background: ${({ theme }) => theme.bg0};\n  border-radius: 12px;\n  padding: 1.5rem;\n  position: relative;\n  max-width: 640px;\n  width: 100%;\n`\n\nconst ArrowWrapper = styled(StyledInternalLink)`\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  height: 24px;\n  color: ${({ theme }) => theme.text1};\n\n  a {\n    color: ${({ theme }) => theme.text1};\n    text-decoration: none;\n  }\n  :hover {\n    text-decoration: none;\n  }\n`\nconst CardWrapper = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 12px;\n  width: 100%;\n`\n\nconst StyledDataCard = styled(DataCard)`\n  width: 100%;\n  background: none;\n  background-color: ${({ theme }) => theme.bg1};\n  height: fit-content;\n  z-index: 2;\n`\n\nconst ProgressWrapper = styled.div`\n  width: 100%;\n  margin-top: 1rem;\n  height: 4px;\n  border-radius: 4px;\n  background-color: ${({ theme }) => theme.bg3};\n  position: relative;\n`\n\nconst Progress = styled.div<{ status: 'for' | 'against'; percentageString?: string }>`\n  height: 4px;\n  border-radius: 4px;\n  background-color: ${({ theme, status }) => (status === 'for' ? theme.green1 : theme.red1)};\n  width: ${({ percentageString }) => percentageString};\n`\n\nconst MarkDownWrapper = styled.div`\n  max-width: 640px;\n  overflow: hidden;\n`\n\nconst WrapSmall = styled(RowBetween)`\n  ${({ theme }) => theme.mediaWidth.upToSmall`\n    align-items: flex-start;\n    flex-direction: column;\n  `};\n`\n\nconst DetailText = styled.div`\n  word-break: break-all;\n`\n\nconst ProposerAddressLink = styled(ExternalLink)`\n  word-break: break-all;\n`\n\nfunction getDateFromBlock(\n  targetBlock: number | undefined,\n  currentBlock: number | undefined,\n  averageBlockTimeInSeconds: number | undefined,\n  currentTimestamp: BigNumber | undefined\n): Date | undefined {\n  if (targetBlock && currentBlock && averageBlockTimeInSeconds && currentTimestamp) {\n    const date = new Date()\n    date.setTime(\n      currentTimestamp\n        .add(BigNumber.from(averageBlockTimeInSeconds).mul(BigNumber.from(targetBlock - currentBlock)))\n        .toNumber() * 1000\n    )\n    return date\n  }\n  return undefined\n}\n\nexport default function VotePage({\n  match: {\n    params: { governorIndex, id },\n  },\n}: RouteComponentProps<{ governorIndex: string; id: string }>) {\n  const { chainId, account } = useActiveWeb3React()\n\n  // get data for this specific proposal\n  const proposalData: ProposalData | undefined = useProposalData(Number.parseInt(governorIndex), id)\n\n  // update vote option based on button interactions\n  const [voteOption, setVoteOption] = useState<VoteOption | undefined>(undefined)\n\n  // modal for casting votes\n  const showVoteModal = useModalOpen(ApplicationModal.VOTE)\n  const toggleVoteModal = useToggleVoteModal()\n\n  // toggle for showing delegation modal\n  const showDelegateModal = useModalOpen(ApplicationModal.DELEGATE)\n  const toggleDelegateModal = useToggleDelegateModal()\n\n  // get and format date from data\n  const currentTimestamp = useCurrentBlockTimestamp()\n  const currentBlock = useBlockNumber()\n  const startDate = getDateFromBlock(\n    proposalData?.startBlock,\n    currentBlock,\n    (chainId && AVERAGE_BLOCK_TIME_IN_SECS[chainId]) ?? DEFAULT_AVERAGE_BLOCK_TIME_IN_SECS,\n    currentTimestamp\n  )\n  const endDate = getDateFromBlock(\n    proposalData?.endBlock,\n    currentBlock,\n    (chainId && AVERAGE_BLOCK_TIME_IN_SECS[chainId]) ?? DEFAULT_AVERAGE_BLOCK_TIME_IN_SECS,\n    currentTimestamp\n  )\n  const now = new Date()\n  const locale = useActiveLocale()\n  const dateFormat: Intl.DateTimeFormatOptions = {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric',\n    hour: 'numeric',\n    minute: 'numeric',\n    timeZoneName: 'short',\n  }\n\n  // get total votes and format percentages for UI\n  const totalVotes: number | undefined = proposalData ? proposalData.forCount + proposalData.againstCount : undefined\n  const forPercentage: string = t`${\n    proposalData && totalVotes ? ((proposalData.forCount * 100) / totalVotes).toFixed(0) : '0'\n  } %`\n  const againstPercentage: string = t`${\n    proposalData && totalVotes ? ((proposalData.againstCount * 100) / totalVotes).toFixed(0) : '0'\n  } %`\n\n  // only count available votes as of the proposal start block\n  const availableVotes: CurrencyAmount<Token> | undefined = useUserVotesAsOfBlock(proposalData?.startBlock ?? undefined)\n\n  // only show voting if user has > 0 votes at proposal start block and proposal is active,\n  const showVotingButtons =\n    availableVotes &&\n    JSBI.greaterThan(availableVotes.quotient, JSBI.BigInt(0)) &&\n    proposalData &&\n    proposalData.status === ProposalState.ACTIVE\n\n  const uniBalance: CurrencyAmount<Token> | undefined = useTokenBalance(\n    account ?? undefined,\n    chainId ? UNI[chainId] : undefined\n  )\n  const userDelegatee: string | undefined = useUserDelegatee()\n\n  // in blurb link to home page if they are able to unlock\n  const showLinkForUnlock = Boolean(\n    uniBalance && JSBI.notEqual(uniBalance.quotient, JSBI.BigInt(0)) && userDelegatee === ZERO_ADDRESS\n  )\n\n  // show links in propsoal details if content is an address\n  // if content is contract with common name, replace address with common name\n  const linkIfAddress = (content: string) => {\n    if (isAddress(content) && chainId) {\n      const commonName = COMMON_CONTRACT_NAMES[chainId]?.[content] ?? content\n      return (\n        <ExternalLink href={getExplorerLink(chainId, content, ExplorerDataType.ADDRESS)}>{commonName}</ExternalLink>\n      )\n    }\n    return <span>{content}</span>\n  }\n\n  return (\n    <>\n      <PageWrapper gap=\"lg\" justify=\"center\">\n        <VoteModal\n          isOpen={showVoteModal}\n          onDismiss={toggleVoteModal}\n          proposalId={proposalData?.id}\n          voteOption={voteOption}\n        />\n        <DelegateModal isOpen={showDelegateModal} onDismiss={toggleDelegateModal} title={<Trans>Unlock Votes</Trans>} />\n        <ProposalInfo gap=\"lg\" justify=\"start\">\n          <RowBetween style={{ width: '100%' }}>\n            <ArrowWrapper to=\"/vote\">\n              <Trans>\n                <ArrowLeft size={20} /> All Proposals\n              </Trans>\n            </ArrowWrapper>\n            {proposalData && <ProposalStatus status={proposalData.status} />}\n          </RowBetween>\n          <AutoColumn gap=\"10px\" style={{ width: '100%' }}>\n            <ThemedText.LargeHeader style={{ marginBottom: '.5rem' }}>{proposalData?.title}</ThemedText.LargeHeader>\n            <RowBetween>\n              <ThemedText.Main>\n                {startDate && startDate > now ? (\n                  <Trans>Voting starts approximately {startDate.toLocaleString(locale, dateFormat)}</Trans>\n                ) : null}\n              </ThemedText.Main>\n            </RowBetween>\n            <RowBetween>\n              <ThemedText.Main>\n                {endDate &&\n                  (endDate < now ? (\n                    <Trans>Voting ended {endDate.toLocaleString(locale, dateFormat)}</Trans>\n                  ) : (\n                    <Trans>Voting ends approximately {endDate.toLocaleString(locale, dateFormat)}</Trans>\n                  ))}\n              </ThemedText.Main>\n            </RowBetween>\n            {proposalData && proposalData.status === ProposalState.ACTIVE && !showVotingButtons && (\n              <GreyCard>\n                <ThemedText.Black>\n                  <Trans>\n                    Only UNI votes that were self delegated or delegated to another address before block{' '}\n                    {proposalData.startBlock} are eligible for voting.{' '}\n                  </Trans>\n                  {showLinkForUnlock && (\n                    <span>\n                      <Trans>\n                        <StyledInternalLink to=\"/vote\">Unlock voting</StyledInternalLink> to prepare for the next\n                        proposal.\n                      </Trans>\n                    </span>\n                  )}\n                </ThemedText.Black>\n              </GreyCard>\n            )}\n          </AutoColumn>\n          {showVotingButtons ? (\n            <RowFixed style={{ width: '100%', gap: '12px' }}>\n              <ButtonPrimary\n                padding=\"8px\"\n                $borderRadius=\"8px\"\n                onClick={() => {\n                  setVoteOption(VoteOption.For)\n                  toggleVoteModal()\n                }}\n              >\n                <Trans>Vote For</Trans>\n              </ButtonPrimary>\n              <ButtonPrimary\n                padding=\"8px\"\n                $borderRadius=\"8px\"\n                onClick={() => {\n                  setVoteOption(VoteOption.Against)\n                  toggleVoteModal()\n                }}\n              >\n                <Trans>Vote Against</Trans>\n              </ButtonPrimary>\n            </RowFixed>\n          ) : (\n            ''\n          )}\n          <CardWrapper>\n            <StyledDataCard>\n              <CardSection>\n                <AutoColumn gap=\"md\">\n                  <WrapSmall>\n                    <ThemedText.Black fontWeight={600}>\n                      <Trans>For</Trans>\n                    </ThemedText.Black>\n                    <ThemedText.Black fontWeight={600}>\n                      {proposalData?.forCount?.toLocaleString(undefined, { maximumFractionDigits: 0 })}\n                    </ThemedText.Black>\n                  </WrapSmall>\n                </AutoColumn>\n                <ProgressWrapper>\n                  <Progress status={'for'} percentageString={forPercentage} />\n                </ProgressWrapper>\n              </CardSection>\n            </StyledDataCard>\n            <StyledDataCard>\n              <CardSection>\n                <AutoColumn gap=\"md\">\n                  <WrapSmall>\n                    <ThemedText.Black fontWeight={600}>\n                      <Trans>Against</Trans>\n                    </ThemedText.Black>\n                    <ThemedText.Black fontWeight={600}>\n                      {proposalData?.againstCount?.toLocaleString(undefined, { maximumFractionDigits: 0 })}\n                    </ThemedText.Black>\n                  </WrapSmall>\n                </AutoColumn>\n                <ProgressWrapper>\n                  <Progress status={'against'} percentageString={againstPercentage} />\n                </ProgressWrapper>\n              </CardSection>\n            </StyledDataCard>\n          </CardWrapper>\n          <AutoColumn gap=\"md\">\n            <ThemedText.MediumHeader fontWeight={600}>\n              <Trans>Details</Trans>\n            </ThemedText.MediumHeader>\n            {proposalData?.details?.map((d, i) => {\n              return (\n                <DetailText key={i}>\n                  {i + 1}: {linkIfAddress(d.target)}.{d.functionSig}(\n                  {d.callData.split(',').map((content, i) => {\n                    return (\n                      <span key={i}>\n                        {linkIfAddress(content)}\n                        {d.callData.split(',').length - 1 === i ? '' : ','}\n                      </span>\n                    )\n                  })}\n                  )\n                </DetailText>\n              )\n            })}\n          </AutoColumn>\n          <AutoColumn gap=\"md\">\n            <ThemedText.MediumHeader fontWeight={600}>\n              <Trans>Description</Trans>\n            </ThemedText.MediumHeader>\n            <MarkDownWrapper>\n              <ReactMarkdown source={proposalData?.description} />\n            </MarkDownWrapper>\n          </AutoColumn>\n          <AutoColumn gap=\"md\">\n            <ThemedText.MediumHeader fontWeight={600}>\n              <Trans>Proposer</Trans>\n            </ThemedText.MediumHeader>\n            <ProposerAddressLink\n              href={\n                proposalData?.proposer && chainId\n                  ? getExplorerLink(chainId, proposalData?.proposer, ExplorerDataType.ADDRESS)\n                  : ''\n              }\n            >\n              <ReactMarkdown source={proposalData?.proposer} />\n            </ProposerAddressLink>\n          </AutoColumn>\n        </ProposalInfo>\n      </PageWrapper>\n      <SwitchLocaleLink />\n    </>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}