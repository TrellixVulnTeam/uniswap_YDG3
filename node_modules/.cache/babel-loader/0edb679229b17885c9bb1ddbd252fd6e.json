{"ast":null,"code":"import _regeneratorRuntime from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Trans}from\"@lingui/react\";import{CurrencyAmount,Percent,Price,Token}from'@uniswap/sdk-core';import{FeeAmount,Pool,Position,priceToClosestTick,TickMath}from'@uniswap/v3-sdk';import Badge,{BadgeVariant}from'components/Badge';import{ButtonConfirmed}from'components/Button';import{BlueCard,DarkGreyCard,LightCard,YellowCard}from'components/Card';import DoubleCurrencyLogo from'components/DoubleLogo';import FeeSelector from'components/FeeSelector';import RangeSelector from'components/RangeSelector';import RateToggle from'components/RateToggle';import SettingsTab from'components/Settings';import{Dots}from'components/swap/styleds';import{ApprovalState,useApproveCallback}from'hooks/useApproveCallback';import useCurrentBlockTimestamp from'hooks/useCurrentBlockTimestamp';import{PoolState,usePool}from'hooks/usePools';import useTheme from'hooks/useTheme';import useTransactionDeadline from'hooks/useTransactionDeadline';import JSBI from'jsbi';import{useCallback,useEffect,useMemo,useState}from'react';import{AlertCircle,AlertTriangle,ArrowDown}from'react-feather';import ReactGA from'react-ga';import{Redirect}from'react-router';import{Text}from'rebass';import{useAppDispatch}from'state/hooks';import{Bound,resetMintState}from'state/mint/v3/actions';import{useRangeHopCallbacks,useV3DerivedMintInfo,useV3MintActionHandlers}from'state/mint/v3/hooks';import{useIsTransactionPending,useTransactionAdder}from'state/transactions/hooks';import{useUserSlippageToleranceWithDefault}from'state/user/hooks';import{formatCurrencyAmount}from'utils/formatCurrencyAmount';import{unwrappedToken}from'utils/unwrappedToken';import{AutoColumn}from'../../components/Column';import CurrencyLogo from'../../components/CurrencyLogo';import FormattedCurrencyAmount from'../../components/FormattedCurrencyAmount';import{AutoRow,RowBetween,RowFixed}from'../../components/Row';import{V2_FACTORY_ADDRESSES}from'../../constants/addresses';import{WRAPPED_NATIVE_CURRENCY}from'../../constants/tokens';import{useToken}from'../../hooks/Tokens';import{usePairContract,useV2MigratorContract}from'../../hooks/useContract';import{useV2LiquidityTokenPermit}from'../../hooks/useERC20Permit';import useIsArgentWallet from'../../hooks/useIsArgentWallet';import{useTotalSupply}from'../../hooks/useTotalSupply';import{useActiveWeb3React}from'../../hooks/web3';import{NEVER_RELOAD,useSingleCallResult}from'../../state/multicall/hooks';import{TransactionType}from'../../state/transactions/actions';import{useTokenBalance}from'../../state/wallet/hooks';import{BackArrow,ExternalLink,ThemedText}from'../../theme';import{isAddress}from'../../utils';import{calculateGasMargin}from'../../utils/calculateGasMargin';import{currencyId}from'../../utils/currencyId';import{ExplorerDataType,getExplorerLink}from'../../utils/getExplorerLink';import{BodyWrapper}from'../AppBody';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ZERO=JSBI.BigInt(0);var DEFAULT_MIGRATE_SLIPPAGE_TOLERANCE=new Percent(75,10000);function EmptyState(_ref){var message=_ref.message;return/*#__PURE__*/_jsx(AutoColumn,{style:{minHeight:200,justifyContent:'center',alignItems:'center'},children:/*#__PURE__*/_jsx(ThemedText.Body,{children:message})});}function LiquidityInfo(_ref2){var token0Amount=_ref2.token0Amount,token1Amount=_ref2.token1Amount;var currency0=unwrappedToken(token0Amount.currency);var currency1=unwrappedToken(token1Amount.currency);return/*#__PURE__*/_jsxs(AutoColumn,{gap:\"8px\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsx(CurrencyLogo,{size:\"20px\",style:{marginRight:'8px'},currency:currency0}),/*#__PURE__*/_jsx(Text,{fontSize:16,fontWeight:500,children:currency0.symbol})]}),/*#__PURE__*/_jsx(Text,{fontSize:16,fontWeight:500,children:/*#__PURE__*/_jsx(FormattedCurrencyAmount,{currencyAmount:token0Amount})})]}),/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsx(CurrencyLogo,{size:\"20px\",style:{marginRight:'8px'},currency:currency1}),/*#__PURE__*/_jsx(Text,{fontSize:16,fontWeight:500,children:currency1.symbol})]}),/*#__PURE__*/_jsx(Text,{fontSize:16,fontWeight:500,children:/*#__PURE__*/_jsx(FormattedCurrencyAmount,{currencyAmount:token1Amount})})]})]});}// hard-code this for now\nvar percentageToMigrate=100;function V2PairMigration(_ref3){var _pairFactory$result,_priceDifferenceFract,_priceDifferenceFract2,_pool$tickCurrent,_pool$sqrtRatioX,_v2SpotPrice$invert,_v2SpotPrice$invert2,_v3SpotPrice$invert,_priceDifferenceFract3,_v3SpotPrice$invert2;var pair=_ref3.pair,pairBalance=_ref3.pairBalance,totalSupply=_ref3.totalSupply,reserve0=_ref3.reserve0,reserve1=_ref3.reserve1,token0=_ref3.token0,token1=_ref3.token1;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId,account=_useActiveWeb3React.account;var theme=useTheme();var v2FactoryAddress=chainId?V2_FACTORY_ADDRESSES[chainId]:undefined;var pairFactory=useSingleCallResult(pair,'factory');var isNotUniswap=((_pairFactory$result=pairFactory.result)===null||_pairFactory$result===void 0?void 0:_pairFactory$result[0])&&pairFactory.result[0]!==v2FactoryAddress;var deadline=useTransactionDeadline();// custom from users settings\nvar blockTimestamp=useCurrentBlockTimestamp();var allowedSlippage=useUserSlippageToleranceWithDefault(DEFAULT_MIGRATE_SLIPPAGE_TOLERANCE);// custom from users\nvar currency0=unwrappedToken(token0);var currency1=unwrappedToken(token1);// this is just getLiquidityValue with the fee off, but for the passed pair\nvar token0Value=useMemo(function(){return CurrencyAmount.fromRawAmount(token0,JSBI.divide(JSBI.multiply(pairBalance.quotient,reserve0.quotient),totalSupply.quotient));},[token0,pairBalance,reserve0,totalSupply]);var token1Value=useMemo(function(){return CurrencyAmount.fromRawAmount(token1,JSBI.divide(JSBI.multiply(pairBalance.quotient,reserve1.quotient),totalSupply.quotient));},[token1,pairBalance,reserve1,totalSupply]);// set up v3 pool\nvar _useState=useState(FeeAmount.MEDIUM),_useState2=_slicedToArray(_useState,2),feeAmount=_useState2[0],setFeeAmount=_useState2[1];var _usePool=usePool(token0,token1,feeAmount),_usePool2=_slicedToArray(_usePool,2),poolState=_usePool2[0],pool=_usePool2[1];var noLiquidity=poolState===PoolState.NOT_EXISTS;// get spot prices + price difference\nvar v2SpotPrice=useMemo(function(){return new Price(token0,token1,reserve0.quotient,reserve1.quotient);},[token0,token1,reserve0,reserve1]);var v3SpotPrice=poolState===PoolState.EXISTS?pool===null||pool===void 0?void 0:pool.token0Price:undefined;var priceDifferenceFraction=v2SpotPrice&&v3SpotPrice?v3SpotPrice.divide(v2SpotPrice).subtract(1).multiply(100):undefined;if((_priceDifferenceFract=priceDifferenceFraction)===null||_priceDifferenceFract===void 0?void 0:_priceDifferenceFract.lessThan(ZERO)){priceDifferenceFraction=priceDifferenceFraction.multiply(-1);}var largePriceDifference=priceDifferenceFraction&&!((_priceDifferenceFract2=priceDifferenceFraction)===null||_priceDifferenceFract2===void 0?void 0:_priceDifferenceFract2.lessThan(JSBI.BigInt(2)));// the following is a small hack to get access to price range data/input handlers\nvar _useState3=useState(token0),_useState4=_slicedToArray(_useState3,2),baseToken=_useState4[0],setBaseToken=_useState4[1];var _useV3DerivedMintInfo=useV3DerivedMintInfo(token0,token1,feeAmount,baseToken),ticks=_useV3DerivedMintInfo.ticks,pricesAtTicks=_useV3DerivedMintInfo.pricesAtTicks,invertPrice=_useV3DerivedMintInfo.invertPrice,invalidRange=_useV3DerivedMintInfo.invalidRange,outOfRange=_useV3DerivedMintInfo.outOfRange,ticksAtLimit=_useV3DerivedMintInfo.ticksAtLimit;// get value and prices at ticks\nvar tickLower=ticks[Bound.LOWER],tickUpper=ticks[Bound.UPPER];var priceLower=pricesAtTicks[Bound.LOWER],priceUpper=pricesAtTicks[Bound.UPPER];var _useRangeHopCallbacks=useRangeHopCallbacks(baseToken,baseToken.equals(token0)?token1:token0,feeAmount,tickLower,tickUpper),getDecrementLower=_useRangeHopCallbacks.getDecrementLower,getIncrementLower=_useRangeHopCallbacks.getIncrementLower,getDecrementUpper=_useRangeHopCallbacks.getDecrementUpper,getIncrementUpper=_useRangeHopCallbacks.getIncrementUpper;var _useV3MintActionHandl=useV3MintActionHandlers(noLiquidity),onLeftRangeInput=_useV3MintActionHandl.onLeftRangeInput,onRightRangeInput=_useV3MintActionHandl.onRightRangeInput;// the v3 tick is either the pool's tickCurrent, or the tick closest to the v2 spot price\nvar tick=(_pool$tickCurrent=pool===null||pool===void 0?void 0:pool.tickCurrent)!==null&&_pool$tickCurrent!==void 0?_pool$tickCurrent:priceToClosestTick(v2SpotPrice);// the price is either the current v3 price, or the price at the tick\nvar sqrtPrice=(_pool$sqrtRatioX=pool===null||pool===void 0?void 0:pool.sqrtRatioX96)!==null&&_pool$sqrtRatioX!==void 0?_pool$sqrtRatioX:TickMath.getSqrtRatioAtTick(tick);var position=typeof tickLower==='number'&&typeof tickUpper==='number'&&!invalidRange?Position.fromAmounts({pool:pool!==null&&pool!==void 0?pool:new Pool(token0,token1,feeAmount,sqrtPrice,0,tick,[]),tickLower:tickLower,tickUpper:tickUpper,amount0:token0Value.quotient,amount1:token1Value.quotient,useFullPrecision:true// we want full precision for the theoretical position\n}):undefined;var _useMemo=useMemo(function(){return position?position.mintAmountsWithSlippage(allowedSlippage):{amount0:undefined,amount1:undefined};},[position,allowedSlippage]),v3Amount0Min=_useMemo.amount0,v3Amount1Min=_useMemo.amount1;var refund0=useMemo(function(){return position&&CurrencyAmount.fromRawAmount(token0,JSBI.subtract(token0Value.quotient,position.amount0.quotient));},[token0Value,position,token0]);var refund1=useMemo(function(){return position&&CurrencyAmount.fromRawAmount(token1,JSBI.subtract(token1Value.quotient,position.amount1.quotient));},[token1Value,position,token1]);var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),confirmingMigration=_useState6[0],setConfirmingMigration=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),pendingMigrationHash=_useState8[0],setPendingMigrationHash=_useState8[1];var migrator=useV2MigratorContract();// approvals\nvar _useApproveCallback=useApproveCallback(pairBalance,migrator===null||migrator===void 0?void 0:migrator.address),_useApproveCallback2=_slicedToArray(_useApproveCallback,2),approval=_useApproveCallback2[0],approveManually=_useApproveCallback2[1];var _useV2LiquidityTokenP=useV2LiquidityTokenPermit(pairBalance,migrator===null||migrator===void 0?void 0:migrator.address),signatureData=_useV2LiquidityTokenP.signatureData,gatherPermitSignature=_useV2LiquidityTokenP.gatherPermitSignature;var isArgentWallet=useIsArgentWallet();var approve=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(isNotUniswap||isArgentWallet)){_context.next=5;break;}_context.next=3;return approveManually();case 3:_context.next=20;break;case 5:if(!gatherPermitSignature){_context.next=18;break;}_context.prev=6;_context.next=9;return gatherPermitSignature();case 9:_context.next=16;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](6);if(!((_context.t0===null||_context.t0===void 0?void 0:_context.t0.code)!==4001)){_context.next=16;break;}_context.next=16;return approveManually();case 16:_context.next=20;break;case 18:_context.next=20;return approveManually();case 20:case\"end\":return _context.stop();}}},_callee,null,[[6,11]]);})),[isNotUniswap,isArgentWallet,gatherPermitSignature,approveManually]);var addTransaction=useTransactionAdder();var isMigrationPending=useIsTransactionPending(pendingMigrationHash!==null&&pendingMigrationHash!==void 0?pendingMigrationHash:undefined);var migrate=useCallback(function(){var _signatureData$deadli;if(!migrator||!account||!deadline||!blockTimestamp||typeof tickLower!=='number'||typeof tickUpper!=='number'||!v3Amount0Min||!v3Amount1Min||!chainId)return;var deadlineToUse=(_signatureData$deadli=signatureData===null||signatureData===void 0?void 0:signatureData.deadline)!==null&&_signatureData$deadli!==void 0?_signatureData$deadli:deadline;var data=[];// permit if necessary\nif(signatureData){data.push(migrator.interface.encodeFunctionData('selfPermit',[pair.address,\"0x\".concat(pairBalance.quotient.toString(16)),deadlineToUse,signatureData.v,signatureData.r,signatureData.s]));}// create/initialize pool if necessary\nif(noLiquidity){data.push(migrator.interface.encodeFunctionData('createAndInitializePoolIfNecessary',[token0.address,token1.address,feeAmount,\"0x\".concat(sqrtPrice.toString(16))]));}// TODO could save gas by not doing this in multicall\ndata.push(migrator.interface.encodeFunctionData('migrate',[{pair:pair.address,liquidityToMigrate:\"0x\".concat(pairBalance.quotient.toString(16)),percentageToMigrate:percentageToMigrate,token0:token0.address,token1:token1.address,fee:feeAmount,tickLower:tickLower,tickUpper:tickUpper,amount0Min:\"0x\".concat(v3Amount0Min.toString(16)),amount1Min:\"0x\".concat(v3Amount1Min.toString(16)),recipient:account,deadline:deadlineToUse,refundAsETH:true// hard-code this for now\n}]));setConfirmingMigration(true);migrator.estimateGas.multicall(data).then(function(gasEstimate){return migrator.multicall(data,{gasLimit:calculateGasMargin(gasEstimate)}).then(function(response){ReactGA.event({category:'Migrate',action:\"\".concat(isNotUniswap?'SushiSwap':'V2',\"->V3\"),label:\"\".concat(currency0.symbol,\"/\").concat(currency1.symbol)});addTransaction(response,{type:TransactionType.MIGRATE_LIQUIDITY_V3,baseCurrencyId:currencyId(currency0),quoteCurrencyId:currencyId(currency1),isFork:isNotUniswap});setPendingMigrationHash(response.hash);});}).catch(function(){setConfirmingMigration(false);});},[chainId,isNotUniswap,migrator,noLiquidity,blockTimestamp,token0,token1,feeAmount,pairBalance,tickLower,tickUpper,sqrtPrice,v3Amount0Min,v3Amount1Min,account,deadline,signatureData,addTransaction,pair,currency0,currency1]);var isSuccessfullyMigrated=!!pendingMigrationHash&&JSBI.equal(pairBalance.quotient,ZERO);return/*#__PURE__*/_jsxs(AutoColumn,{gap:\"20px\",children:[/*#__PURE__*/_jsxs(ThemedText.Body,{my:9,style:{fontWeight:400},children:[/*#__PURE__*/_jsx(Trans,{id:\"This tool will safely migrate your {0} liquidity to V3. The process is completely trustless thanks to the\",values:{0:isNotUniswap?'SushiSwap':'V2'}}),chainId&&migrator&&/*#__PURE__*/_jsx(ExternalLink,{href:getExplorerLink(chainId,migrator.address,ExplorerDataType.ADDRESS),children:/*#__PURE__*/_jsx(ThemedText.Blue,{display:\"inline\",children:/*#__PURE__*/_jsx(Trans,{id:\"Uniswap migration contract\\u2197\"})})}),\".\"]}),/*#__PURE__*/_jsx(LightCard,{children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"lg\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsxs(RowFixed,{style:{marginLeft:'8px'},children:[/*#__PURE__*/_jsx(DoubleCurrencyLogo,{currency0:currency0,currency1:currency1,margin:false,size:20}),/*#__PURE__*/_jsx(ThemedText.MediumHeader,{style:{marginLeft:'8px'},children:/*#__PURE__*/_jsx(Trans,{id:\"{0}/{1} LP Tokens\",values:{0:currency0.symbol,1:currency1.symbol}})})]}),/*#__PURE__*/_jsx(Badge,{variant:BadgeVariant.WARNING,children:isNotUniswap?'Sushi':'V2'})]}),/*#__PURE__*/_jsx(LiquidityInfo,{token0Amount:token0Value,token1Amount:token1Value})]})}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center'},children:/*#__PURE__*/_jsx(ArrowDown,{size:24})}),/*#__PURE__*/_jsx(LightCard,{children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"lg\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsxs(RowFixed,{style:{marginLeft:'8px'},children:[/*#__PURE__*/_jsx(DoubleCurrencyLogo,{currency0:currency0,currency1:currency1,margin:false,size:20}),/*#__PURE__*/_jsx(ThemedText.MediumHeader,{style:{marginLeft:'8px'},children:/*#__PURE__*/_jsx(Trans,{id:\"{0}/{1} LP NFT\",values:{0:currency0.symbol,1:currency1.symbol}})})]}),/*#__PURE__*/_jsx(Badge,{variant:BadgeVariant.PRIMARY,children:\"V3\"})]}),/*#__PURE__*/_jsx(FeeSelector,{feeAmount:feeAmount,handleFeePoolSelect:setFeeAmount}),noLiquidity&&/*#__PURE__*/_jsxs(BlueCard,{style:{display:'flex',flexDirection:'column',alignItems:'center'},children:[/*#__PURE__*/_jsx(AlertCircle,{color:theme.text1,style:{marginBottom:'12px',opacity:0.8}}),/*#__PURE__*/_jsx(ThemedText.Body,{fontSize:14,style:{marginBottom:8,fontWeight:500,opacity:0.8},textAlign:\"center\",children:/*#__PURE__*/_jsx(Trans,{id:\"You are the first liquidity provider for this Uniswap V3 pool. Your liquidity will migrate at the current {0} price.\",values:{0:isNotUniswap?'SushiSwap':'V2'}})}),/*#__PURE__*/_jsx(ThemedText.Body,{fontWeight:500,textAlign:\"center\",fontSize:14,style:{marginTop:'8px',opacity:0.8},children:/*#__PURE__*/_jsx(Trans,{id:\"Your transaction cost will be much higher as it includes the gas to create the pool.\"})}),v2SpotPrice&&/*#__PURE__*/_jsx(AutoColumn,{gap:\"8px\",style:{marginTop:'12px'},children:/*#__PURE__*/_jsx(RowBetween,{children:/*#__PURE__*/_jsxs(ThemedText.Body,{fontWeight:500,fontSize:14,children:[/*#__PURE__*/_jsx(Trans,{id:\"{0} {1} Price:\",values:{0:isNotUniswap?'SushiSwap':'V2',1:invertPrice?currency1.symbol:currency0.symbol}}),' ',invertPrice?\"\".concat(v2SpotPrice===null||v2SpotPrice===void 0?void 0:(_v2SpotPrice$invert=v2SpotPrice.invert())===null||_v2SpotPrice$invert===void 0?void 0:_v2SpotPrice$invert.toSignificant(6),\" \").concat(currency0.symbol):\"\".concat(v2SpotPrice===null||v2SpotPrice===void 0?void 0:v2SpotPrice.toSignificant(6),\" \").concat(currency1.symbol)]})})})]}),largePriceDifference?/*#__PURE__*/_jsxs(YellowCard,{children:[/*#__PURE__*/_jsxs(AutoColumn,{gap:\"8px\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(ThemedText.Body,{fontSize:14,children:/*#__PURE__*/_jsx(Trans,{id:\"{0} {1} Price:\",values:{0:isNotUniswap?'SushiSwap':'V2',1:invertPrice?currency1.symbol:currency0.symbol}})}),/*#__PURE__*/_jsx(ThemedText.Black,{fontSize:14,children:invertPrice?\"\".concat(v2SpotPrice===null||v2SpotPrice===void 0?void 0:(_v2SpotPrice$invert2=v2SpotPrice.invert())===null||_v2SpotPrice$invert2===void 0?void 0:_v2SpotPrice$invert2.toSignificant(6),\" \").concat(currency0.symbol):\"\".concat(v2SpotPrice===null||v2SpotPrice===void 0?void 0:v2SpotPrice.toSignificant(6),\" \").concat(currency1.symbol)})]}),/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(ThemedText.Body,{fontSize:14,children:/*#__PURE__*/_jsx(Trans,{id:\"V3 {0} Price:\",values:{0:invertPrice?currency1.symbol:currency0.symbol}})}),/*#__PURE__*/_jsx(ThemedText.Black,{fontSize:14,children:invertPrice?\"\".concat(v3SpotPrice===null||v3SpotPrice===void 0?void 0:(_v3SpotPrice$invert=v3SpotPrice.invert())===null||_v3SpotPrice$invert===void 0?void 0:_v3SpotPrice$invert.toSignificant(6),\" \").concat(currency0.symbol):\"\".concat(v3SpotPrice===null||v3SpotPrice===void 0?void 0:v3SpotPrice.toSignificant(6),\" \").concat(currency1.symbol)})]}),/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(ThemedText.Body,{fontSize:14,color:\"inherit\",children:/*#__PURE__*/_jsx(Trans,{id:\"Price Difference:\"})}),/*#__PURE__*/_jsx(ThemedText.Black,{fontSize:14,color:\"inherit\",children:/*#__PURE__*/_jsx(Trans,{id:\"{0}%\",values:{0:(_priceDifferenceFract3=priceDifferenceFraction)===null||_priceDifferenceFract3===void 0?void 0:_priceDifferenceFract3.toSignificant(4)}})})]})]}),/*#__PURE__*/_jsx(ThemedText.Body,{fontSize:14,style:{marginTop:8,fontWeight:400},children:/*#__PURE__*/_jsx(Trans,{id:\"You should only deposit liquidity into Uniswap V3 at a price you believe is correct. <0/>If the price seems incorrect, you can either make a swap to move the price or wait for someone else to do so.\",components:{0:/*#__PURE__*/_jsx(\"br\",{})}})})]}):!noLiquidity&&v3SpotPrice?/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(ThemedText.Body,{fontSize:14,children:/*#__PURE__*/_jsx(Trans,{id:\"V3 {0} Price:\",values:{0:invertPrice?currency1.symbol:currency0.symbol}})}),/*#__PURE__*/_jsx(ThemedText.Black,{fontSize:14,children:invertPrice?\"\".concat(v3SpotPrice===null||v3SpotPrice===void 0?void 0:(_v3SpotPrice$invert2=v3SpotPrice.invert())===null||_v3SpotPrice$invert2===void 0?void 0:_v3SpotPrice$invert2.toSignificant(6),\" \").concat(currency0.symbol):\"\".concat(v3SpotPrice===null||v3SpotPrice===void 0?void 0:v3SpotPrice.toSignificant(6),\" \").concat(currency1.symbol)})]}):null,/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(ThemedText.Label,{children:/*#__PURE__*/_jsx(Trans,{id:\"Set Price Range\"})}),/*#__PURE__*/_jsx(RateToggle,{currencyA:invertPrice?currency1:currency0,currencyB:invertPrice?currency0:currency1,handleRateToggle:function handleRateToggle(){onLeftRangeInput('');onRightRangeInput('');setBaseToken(function(base){return base.equals(token0)?token1:token0;});}})]}),/*#__PURE__*/_jsx(RangeSelector,{priceLower:priceLower,priceUpper:priceUpper,getDecrementLower:getDecrementLower,getIncrementLower:getIncrementLower,getDecrementUpper:getDecrementUpper,getIncrementUpper:getIncrementUpper,onLeftRangeInput:onLeftRangeInput,onRightRangeInput:onRightRangeInput,currencyA:invertPrice?currency1:currency0,currencyB:invertPrice?currency0:currency1,feeAmount:feeAmount,ticksAtLimit:ticksAtLimit}),outOfRange?/*#__PURE__*/_jsx(YellowCard,{padding:\"8px 12px\",$borderRadius:\"12px\",children:/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(AlertTriangle,{stroke:theme.yellow3,size:\"16px\"}),/*#__PURE__*/_jsx(ThemedText.Yellow,{ml:\"12px\",fontSize:\"12px\",children:/*#__PURE__*/_jsx(Trans,{id:\"Your position will not earn fees or be used in trades until the market price moves into your range.\"})})]})}):null,invalidRange?/*#__PURE__*/_jsx(YellowCard,{padding:\"8px 12px\",$borderRadius:\"12px\",children:/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(AlertTriangle,{stroke:theme.yellow3,size:\"16px\"}),/*#__PURE__*/_jsx(ThemedText.Yellow,{ml:\"12px\",fontSize:\"12px\",children:/*#__PURE__*/_jsx(Trans,{id:\"Invalid range selected. The min price must be lower than the max price.\"})})]})}):null,position?/*#__PURE__*/_jsx(DarkGreyCard,{children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"md\",children:[/*#__PURE__*/_jsx(LiquidityInfo,{token0Amount:position.amount0,token1Amount:position.amount1}),chainId&&refund0&&refund1?/*#__PURE__*/_jsx(ThemedText.Black,{fontSize:12,children:/*#__PURE__*/_jsx(Trans,{id:\"At least {0} {1} and {2} {3} will be refunded to your wallet due to selected price range.\",values:{0:formatCurrencyAmount(refund0,4),1:token0.equals(WRAPPED_NATIVE_CURRENCY[chainId])?'ETH':token0.symbol,2:formatCurrencyAmount(refund1,4),3:token1.equals(WRAPPED_NATIVE_CURRENCY[chainId])?'ETH':token1.symbol}})}):null]})}):null,/*#__PURE__*/_jsxs(AutoColumn,{gap:\"12px\",children:[!isSuccessfullyMigrated&&!isMigrationPending?/*#__PURE__*/_jsx(AutoColumn,{gap:\"12px\",style:{flex:'1'},children:/*#__PURE__*/_jsx(ButtonConfirmed,{confirmed:approval===ApprovalState.APPROVED||signatureData!==null,disabled:approval!==ApprovalState.NOT_APPROVED||signatureData!==null||!v3Amount0Min||!v3Amount1Min||invalidRange||confirmingMigration,onClick:approve,children:approval===ApprovalState.PENDING?/*#__PURE__*/_jsx(Dots,{children:/*#__PURE__*/_jsx(Trans,{id:\"Approving\"})}):approval===ApprovalState.APPROVED||signatureData!==null?/*#__PURE__*/_jsx(Trans,{id:\"Allowed\"}):/*#__PURE__*/_jsx(Trans,{id:\"Allow LP token migration\"})})}):null,/*#__PURE__*/_jsx(AutoColumn,{gap:\"12px\",style:{flex:'1'},children:/*#__PURE__*/_jsx(ButtonConfirmed,{confirmed:isSuccessfullyMigrated,disabled:!v3Amount0Min||!v3Amount1Min||invalidRange||approval!==ApprovalState.APPROVED&&signatureData===null||confirmingMigration||isMigrationPending||isSuccessfullyMigrated,onClick:migrate,children:isSuccessfullyMigrated?'Success!':isMigrationPending?/*#__PURE__*/_jsx(Dots,{children:/*#__PURE__*/_jsx(Trans,{id:\"Migrating\"})}):/*#__PURE__*/_jsx(Trans,{id:\"Migrate\"})})})]})]})})]});}export default function MigrateV2Pair(_ref5){var _token0AddressCallSta,_useSingleCallResult,_useSingleCallResult$,_useSingleCallResult$2,_useSingleCallResult2;var address=_ref5.match.params.address;// reset mint state on component mount, and as a cleanup (on unmount)\nvar dispatch=useAppDispatch();useEffect(function(){dispatch(resetMintState());return function(){dispatch(resetMintState());};},[dispatch]);var _useActiveWeb3React2=useActiveWeb3React(),chainId=_useActiveWeb3React2.chainId,account=_useActiveWeb3React2.account;// get pair contract\nvar validatedAddress=isAddress(address);var pair=usePairContract(validatedAddress?validatedAddress:undefined);// get token addresses from pair contract\nvar token0AddressCallState=useSingleCallResult(pair,'token0',undefined,NEVER_RELOAD);var token0Address=token0AddressCallState===null||token0AddressCallState===void 0?void 0:(_token0AddressCallSta=token0AddressCallState.result)===null||_token0AddressCallSta===void 0?void 0:_token0AddressCallSta[0];var token1Address=(_useSingleCallResult=useSingleCallResult(pair,'token1',undefined,NEVER_RELOAD))===null||_useSingleCallResult===void 0?void 0:(_useSingleCallResult$=_useSingleCallResult.result)===null||_useSingleCallResult$===void 0?void 0:_useSingleCallResult$[0];// get tokens\nvar token0=useToken(token0Address);var token1=useToken(token1Address);// get liquidity token balance\nvar liquidityToken=useMemo(function(){return chainId&&validatedAddress?new Token(chainId,validatedAddress,18):undefined;},[chainId,validatedAddress]);// get data required for V2 pair migration\nvar pairBalance=useTokenBalance(account!==null&&account!==void 0?account:undefined,liquidityToken);var totalSupply=useTotalSupply(liquidityToken);var _ref6=(_useSingleCallResult$2=(_useSingleCallResult2=useSingleCallResult(pair,'getReserves'))===null||_useSingleCallResult2===void 0?void 0:_useSingleCallResult2.result)!==null&&_useSingleCallResult$2!==void 0?_useSingleCallResult$2:[],_ref7=_slicedToArray(_ref6,2),reserve0Raw=_ref7[0],reserve1Raw=_ref7[1];var reserve0=useMemo(function(){return token0&&reserve0Raw?CurrencyAmount.fromRawAmount(token0,reserve0Raw):undefined;},[token0,reserve0Raw]);var reserve1=useMemo(function(){return token1&&reserve1Raw?CurrencyAmount.fromRawAmount(token1,reserve1Raw):undefined;},[token1,reserve1Raw]);// redirect for invalid url params\nif(!validatedAddress||!pair||pair&&(token0AddressCallState===null||token0AddressCallState===void 0?void 0:token0AddressCallState.valid)&&!(token0AddressCallState===null||token0AddressCallState===void 0?void 0:token0AddressCallState.loading)&&!(token0AddressCallState===null||token0AddressCallState===void 0?void 0:token0AddressCallState.error)&&!token0Address){console.error('Invalid pair address');return/*#__PURE__*/_jsx(Redirect,{to:\"/migrate/v2\"});}return/*#__PURE__*/_jsx(BodyWrapper,{style:{padding:24},children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"16px\",children:[/*#__PURE__*/_jsxs(AutoRow,{style:{alignItems:'center',justifyContent:'space-between'},gap:\"8px\",children:[/*#__PURE__*/_jsx(BackArrow,{to:\"/migrate/v2\"}),/*#__PURE__*/_jsx(ThemedText.MediumHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Migrate V2 Liquidity\"})}),/*#__PURE__*/_jsx(SettingsTab,{placeholderSlippage:DEFAULT_MIGRATE_SLIPPAGE_TOLERANCE})]}),!account?/*#__PURE__*/_jsx(ThemedText.LargeHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"You must connect an account.\"})}):pairBalance&&totalSupply&&reserve0&&reserve1&&token0&&token1?/*#__PURE__*/_jsx(V2PairMigration,{pair:pair,pairBalance:pairBalance,totalSupply:totalSupply,reserve0:reserve0,reserve1:reserve1,token0:token0,token1:token1}):/*#__PURE__*/_jsx(EmptyState,{message:/*#__PURE__*/_jsx(Trans,{id:\"Loading\"})})]})});}","map":{"version":3,"sources":["/Users/safahi/Downloads/interface-4.30.1/src/pages/MigrateV2/MigrateV2Pair.tsx"],"names":["CurrencyAmount","Percent","Price","Token","FeeAmount","Pool","Position","priceToClosestTick","TickMath","Badge","BadgeVariant","ButtonConfirmed","BlueCard","DarkGreyCard","LightCard","YellowCard","DoubleCurrencyLogo","FeeSelector","RangeSelector","RateToggle","SettingsTab","Dots","ApprovalState","useApproveCallback","useCurrentBlockTimestamp","PoolState","usePool","useTheme","useTransactionDeadline","JSBI","useCallback","useEffect","useMemo","useState","AlertCircle","AlertTriangle","ArrowDown","ReactGA","Redirect","Text","useAppDispatch","Bound","resetMintState","useRangeHopCallbacks","useV3DerivedMintInfo","useV3MintActionHandlers","useIsTransactionPending","useTransactionAdder","useUserSlippageToleranceWithDefault","formatCurrencyAmount","unwrappedToken","AutoColumn","CurrencyLogo","FormattedCurrencyAmount","AutoRow","RowBetween","RowFixed","V2_FACTORY_ADDRESSES","WRAPPED_NATIVE_CURRENCY","useToken","usePairContract","useV2MigratorContract","useV2LiquidityTokenPermit","useIsArgentWallet","useTotalSupply","useActiveWeb3React","NEVER_RELOAD","useSingleCallResult","TransactionType","useTokenBalance","BackArrow","ExternalLink","ThemedText","isAddress","calculateGasMargin","currencyId","ExplorerDataType","getExplorerLink","BodyWrapper","ZERO","BigInt","DEFAULT_MIGRATE_SLIPPAGE_TOLERANCE","EmptyState","message","minHeight","justifyContent","alignItems","LiquidityInfo","token0Amount","token1Amount","currency0","currency","currency1","marginRight","symbol","percentageToMigrate","V2PairMigration","pair","pairBalance","totalSupply","reserve0","reserve1","token0","token1","chainId","account","theme","v2FactoryAddress","undefined","pairFactory","isNotUniswap","result","deadline","blockTimestamp","allowedSlippage","token0Value","fromRawAmount","divide","multiply","quotient","token1Value","MEDIUM","feeAmount","setFeeAmount","poolState","pool","noLiquidity","NOT_EXISTS","v2SpotPrice","v3SpotPrice","EXISTS","token0Price","priceDifferenceFraction","subtract","lessThan","largePriceDifference","baseToken","setBaseToken","ticks","pricesAtTicks","invertPrice","invalidRange","outOfRange","ticksAtLimit","tickLower","LOWER","tickUpper","UPPER","priceLower","priceUpper","equals","getDecrementLower","getIncrementLower","getDecrementUpper","getIncrementUpper","onLeftRangeInput","onRightRangeInput","tick","tickCurrent","sqrtPrice","sqrtRatioX96","getSqrtRatioAtTick","position","fromAmounts","amount0","amount1","useFullPrecision","mintAmountsWithSlippage","v3Amount0Min","v3Amount1Min","refund0","refund1","confirmingMigration","setConfirmingMigration","pendingMigrationHash","setPendingMigrationHash","migrator","address","approval","approveManually","signatureData","gatherPermitSignature","isArgentWallet","approve","code","addTransaction","isMigrationPending","migrate","deadlineToUse","data","push","interface","encodeFunctionData","toString","v","r","s","liquidityToMigrate","fee","amount0Min","amount1Min","recipient","refundAsETH","estimateGas","multicall","then","gasEstimate","gasLimit","response","event","category","action","label","type","MIGRATE_LIQUIDITY_V3","baseCurrencyId","quoteCurrencyId","isFork","hash","catch","isSuccessfullyMigrated","equal","fontWeight","ADDRESS","marginLeft","WARNING","display","PRIMARY","flexDirection","text1","marginBottom","opacity","marginTop","invert","toSignificant","base","yellow3","flex","APPROVED","NOT_APPROVED","PENDING","MigrateV2Pair","match","params","dispatch","validatedAddress","token0AddressCallState","token0Address","token1Address","liquidityToken","reserve0Raw","reserve1Raw","valid","loading","error","console","padding"],"mappings":"2fAGA,OAASA,cAAT,CAAmCC,OAAnC,CAA4CC,KAA5C,CAAmDC,KAAnD,KAAgE,mBAAhE,CACA,OAASC,SAAT,CAAoBC,IAApB,CAA0BC,QAA1B,CAAoCC,kBAApC,CAAwDC,QAAxD,KAAwE,iBAAxE,CACA,MAAOC,CAAAA,KAAP,EAAgBC,YAAhB,KAAoC,kBAApC,CACA,OAASC,eAAT,KAAgC,mBAAhC,CACA,OAASC,QAAT,CAAmBC,YAAnB,CAAiCC,SAAjC,CAA4CC,UAA5C,KAA8D,iBAA9D,CACA,MAAOC,CAAAA,kBAAP,KAA+B,uBAA/B,CACA,MAAOC,CAAAA,WAAP,KAAwB,wBAAxB,CACA,MAAOC,CAAAA,aAAP,KAA0B,0BAA1B,CACA,MAAOC,CAAAA,UAAP,KAAuB,uBAAvB,CACA,MAAOC,CAAAA,WAAP,KAAwB,qBAAxB,CACA,OAASC,IAAT,KAAqB,yBAArB,CACA,OAASC,aAAT,CAAwBC,kBAAxB,KAAkD,0BAAlD,CACA,MAAOC,CAAAA,wBAAP,KAAqC,gCAArC,CACA,OAASC,SAAT,CAAoBC,OAApB,KAAmC,gBAAnC,CACA,MAAOC,CAAAA,QAAP,KAAqB,gBAArB,CACA,MAAOC,CAAAA,sBAAP,KAAmC,8BAAnC,CACA,MAAOC,CAAAA,IAAP,KAAiB,MAAjB,CACA,OAAoBC,WAApB,CAAiCC,SAAjC,CAA4CC,OAA5C,CAAqDC,QAArD,KAAqE,OAArE,CACA,OAASC,WAAT,CAAsBC,aAAtB,CAAqCC,SAArC,KAAsD,eAAtD,CACA,MAAOC,CAAAA,OAAP,KAAoB,UAApB,CACA,OAASC,QAAT,KAA8C,cAA9C,CACA,OAASC,IAAT,KAAqB,QAArB,CACA,OAASC,cAAT,KAA+B,aAA/B,CACA,OAASC,KAAT,CAAgBC,cAAhB,KAAsC,uBAAtC,CACA,OAASC,oBAAT,CAA+BC,oBAA/B,CAAqDC,uBAArD,KAAoF,qBAApF,CACA,OAASC,uBAAT,CAAkCC,mBAAlC,KAA6D,0BAA7D,CACA,OAASC,mCAAT,KAAoD,kBAApD,CACA,OAASC,oBAAT,KAAqC,4BAArC,CACA,OAASC,cAAT,KAA+B,sBAA/B,CAEA,OAASC,UAAT,KAA2B,yBAA3B,CACA,MAAOC,CAAAA,YAAP,KAAyB,+BAAzB,CACA,MAAOC,CAAAA,uBAAP,KAAoC,0CAApC,CACA,OAASC,OAAT,CAAkBC,UAAlB,CAA8BC,QAA9B,KAA8C,sBAA9C,CACA,OAASC,oBAAT,KAAqC,2BAArC,CACA,OAASC,uBAAT,KAAwC,wBAAxC,CACA,OAASC,QAAT,KAAyB,oBAAzB,CACA,OAASC,eAAT,CAA0BC,qBAA1B,KAAuD,yBAAvD,CACA,OAASC,yBAAT,KAA0C,4BAA1C,CACA,MAAOC,CAAAA,iBAAP,KAA8B,+BAA9B,CACA,OAASC,cAAT,KAA+B,4BAA/B,CACA,OAASC,kBAAT,KAAmC,kBAAnC,CACA,OAASC,YAAT,CAAuBC,mBAAvB,KAAkD,6BAAlD,CACA,OAASC,eAAT,KAAgC,kCAAhC,CACA,OAASC,eAAT,KAAgC,0BAAhC,CACA,OAASC,SAAT,CAAoBC,YAApB,CAAkCC,UAAlC,KAAoD,aAApD,CACA,OAASC,SAAT,KAA0B,aAA1B,CACA,OAASC,kBAAT,KAAmC,gCAAnC,CACA,OAASC,UAAT,KAA2B,wBAA3B,CACA,OAASC,gBAAT,CAA2BC,eAA3B,KAAkD,6BAAlD,CACA,OAASC,WAAT,KAA4B,YAA5B,C,wFAEA,GAAMC,CAAAA,IAAI,CAAGlD,IAAI,CAACmD,MAAL,CAAY,CAAZ,CAAb,CAEA,GAAMC,CAAAA,kCAAkC,CAAG,GAAIhF,CAAAA,OAAJ,CAAY,EAAZ,CAAgB,KAAhB,CAA3C,CAEA,QAASiF,CAAAA,UAAT,MAAyD,IAAnCC,CAAAA,OAAmC,MAAnCA,OAAmC,CACvD,mBACE,KAAC,UAAD,EAAY,KAAK,CAAE,CAAEC,SAAS,CAAE,GAAb,CAAkBC,cAAc,CAAE,QAAlC,CAA4CC,UAAU,CAAE,QAAxD,CAAnB,uBACE,KAAC,UAAD,CAAY,IAAZ,WAAkBH,OAAlB,EADF,EADF,CAKD,CAED,QAASI,CAAAA,aAAT,OAMG,IALDC,CAAAA,YAKC,OALDA,YAKC,CAJDC,YAIC,OAJDA,YAIC,CACD,GAAMC,CAAAA,SAAS,CAAGxC,cAAc,CAACsC,YAAY,CAACG,QAAd,CAAhC,CACA,GAAMC,CAAAA,SAAS,CAAG1C,cAAc,CAACuC,YAAY,CAACE,QAAd,CAAhC,CAEA,mBACE,MAAC,UAAD,EAAY,GAAG,CAAC,KAAhB,wBACE,MAAC,UAAD,yBACE,MAAC,QAAD,yBACE,KAAC,YAAD,EAAc,IAAI,CAAC,MAAnB,CAA0B,KAAK,CAAE,CAAEE,WAAW,CAAE,KAAf,CAAjC,CAAyD,QAAQ,CAAEH,SAAnE,EADF,cAEE,KAAC,IAAD,EAAM,QAAQ,CAAE,EAAhB,CAAoB,UAAU,CAAE,GAAhC,UACGA,SAAS,CAACI,MADb,EAFF,GADF,cAOE,KAAC,IAAD,EAAM,QAAQ,CAAE,EAAhB,CAAoB,UAAU,CAAE,GAAhC,uBACE,KAAC,uBAAD,EAAyB,cAAc,CAAEN,YAAzC,EADF,EAPF,GADF,cAYE,MAAC,UAAD,yBACE,MAAC,QAAD,yBACE,KAAC,YAAD,EAAc,IAAI,CAAC,MAAnB,CAA0B,KAAK,CAAE,CAAEK,WAAW,CAAE,KAAf,CAAjC,CAAyD,QAAQ,CAAED,SAAnE,EADF,cAEE,KAAC,IAAD,EAAM,QAAQ,CAAE,EAAhB,CAAoB,UAAU,CAAE,GAAhC,UACGA,SAAS,CAACE,MADb,EAFF,GADF,cAQE,KAAC,IAAD,EAAM,QAAQ,CAAE,EAAhB,CAAoB,UAAU,CAAE,GAAhC,uBACE,KAAC,uBAAD,EAAyB,cAAc,CAAEL,YAAzC,EADF,EARF,GAZF,GADF,CA2BD,CAED;AACA,GAAMM,CAAAA,mBAAmB,CAAG,GAA5B,CAEA,QAASC,CAAAA,eAAT,OAgBG,qNAfDC,CAAAA,IAeC,OAfDA,IAeC,CAdDC,WAcC,OAdDA,WAcC,CAbDC,WAaC,OAbDA,WAaC,CAZDC,QAYC,OAZDA,QAYC,CAXDC,QAWC,OAXDA,QAWC,CAVDC,MAUC,OAVDA,MAUC,CATDC,MASC,OATDA,MASC,CACD,wBAA6BtC,kBAAkB,EAA/C,CAAQuC,OAAR,qBAAQA,OAAR,CAAiBC,OAAjB,qBAAiBA,OAAjB,CACA,GAAMC,CAAAA,KAAK,CAAG/E,QAAQ,EAAtB,CACA,GAAMgF,CAAAA,gBAAgB,CAAGH,OAAO,CAAG/C,oBAAoB,CAAC+C,OAAD,CAAvB,CAAmCI,SAAnE,CAEA,GAAMC,CAAAA,WAAW,CAAG1C,mBAAmB,CAAC8B,IAAD,CAAO,SAAP,CAAvC,CACA,GAAMa,CAAAA,YAAY,CAAG,sBAAAD,WAAW,CAACE,MAAZ,kEAAqB,CAArB,IAA2BF,WAAW,CAACE,MAAZ,CAAmB,CAAnB,IAA0BJ,gBAA1E,CAEA,GAAMK,CAAAA,QAAQ,CAAGpF,sBAAsB,EAAvC,CAA0C;AAC1C,GAAMqF,CAAAA,cAAc,CAAGzF,wBAAwB,EAA/C,CACA,GAAM0F,CAAAA,eAAe,CAAGlE,mCAAmC,CAACiC,kCAAD,CAA3D,CAAgG;AAEhG,GAAMS,CAAAA,SAAS,CAAGxC,cAAc,CAACoD,MAAD,CAAhC,CACA,GAAMV,CAAAA,SAAS,CAAG1C,cAAc,CAACqD,MAAD,CAAhC,CAEA;AACA,GAAMY,CAAAA,WAAW,CAAGnF,OAAO,CACzB,iBACEhC,CAAAA,cAAc,CAACoH,aAAf,CACEd,MADF,CAEEzE,IAAI,CAACwF,MAAL,CAAYxF,IAAI,CAACyF,QAAL,CAAcpB,WAAW,CAACqB,QAA1B,CAAoCnB,QAAQ,CAACmB,QAA7C,CAAZ,CAAoEpB,WAAW,CAACoB,QAAhF,CAFF,CADF,EADyB,CAMzB,CAACjB,MAAD,CAASJ,WAAT,CAAsBE,QAAtB,CAAgCD,WAAhC,CANyB,CAA3B,CAQA,GAAMqB,CAAAA,WAAW,CAAGxF,OAAO,CACzB,iBACEhC,CAAAA,cAAc,CAACoH,aAAf,CACEb,MADF,CAEE1E,IAAI,CAACwF,MAAL,CAAYxF,IAAI,CAACyF,QAAL,CAAcpB,WAAW,CAACqB,QAA1B,CAAoClB,QAAQ,CAACkB,QAA7C,CAAZ,CAAoEpB,WAAW,CAACoB,QAAhF,CAFF,CADF,EADyB,CAMzB,CAAChB,MAAD,CAASL,WAAT,CAAsBG,QAAtB,CAAgCF,WAAhC,CANyB,CAA3B,CASA;AACA,cAAkClE,QAAQ,CAAC7B,SAAS,CAACqH,MAAX,CAA1C,wCAAOC,SAAP,eAAkBC,YAAlB,eACA,aAA0BjG,OAAO,CAAC4E,MAAD,CAASC,MAAT,CAAiBmB,SAAjB,CAAjC,sCAAOE,SAAP,cAAkBC,IAAlB,cACA,GAAMC,CAAAA,WAAW,CAAGF,SAAS,GAAKnG,SAAS,CAACsG,UAA5C,CAEA;AACA,GAAMC,CAAAA,WAAW,CAAGhG,OAAO,CACzB,iBAAM,IAAI9B,CAAAA,KAAJ,CAAUoG,MAAV,CAAkBC,MAAlB,CAA0BH,QAAQ,CAACmB,QAAnC,CAA6ClB,QAAQ,CAACkB,QAAtD,CAAN,EADyB,CAEzB,CAACjB,MAAD,CAASC,MAAT,CAAiBH,QAAjB,CAA2BC,QAA3B,CAFyB,CAA3B,CAIA,GAAM4B,CAAAA,WAAW,CAAGL,SAAS,GAAKnG,SAAS,CAACyG,MAAxB,CAAiCL,IAAjC,SAAiCA,IAAjC,iBAAiCA,IAAI,CAAEM,WAAvC,CAAqDvB,SAAzE,CAEA,GAAIwB,CAAAA,uBAA6C,CAC/CJ,WAAW,EAAIC,WAAf,CAA6BA,WAAW,CAACZ,MAAZ,CAAmBW,WAAnB,EAAgCK,QAAhC,CAAyC,CAAzC,EAA4Cf,QAA5C,CAAqD,GAArD,CAA7B,CAAyFV,SAD3F,CAEA,0BAAIwB,uBAAJ,gDAAI,sBAAyBE,QAAzB,CAAkCvD,IAAlC,CAAJ,CAA6C,CAC3CqD,uBAAuB,CAAGA,uBAAuB,CAACd,QAAxB,CAAiC,CAAC,CAAlC,CAA1B,CACD,CAED,GAAMiB,CAAAA,oBAAoB,CAAGH,uBAAuB,EAAI,0BAACA,uBAAD,iDAAC,uBAAyBE,QAAzB,CAAkCzG,IAAI,CAACmD,MAAL,CAAY,CAAZ,CAAlC,CAAD,CAAxD,CAEA;AACA,eAAkC/C,QAAQ,CAACqE,MAAD,CAA1C,yCAAOkC,SAAP,eAAkBC,YAAlB,eACA,0BAAsF7F,oBAAoB,CACxG0D,MADwG,CAExGC,MAFwG,CAGxGmB,SAHwG,CAIxGc,SAJwG,CAA1G,CAAQE,KAAR,uBAAQA,KAAR,CAAeC,aAAf,uBAAeA,aAAf,CAA8BC,WAA9B,uBAA8BA,WAA9B,CAA2CC,YAA3C,uBAA2CA,YAA3C,CAAyDC,UAAzD,uBAAyDA,UAAzD,CAAqEC,YAArE,uBAAqEA,YAArE,CAOA;AACA,GAAuBC,CAAAA,SAAvB,CAA+DN,KAA/D,CAASjG,KAAK,CAACwG,KAAf,EAAiDC,SAAjD,CAA+DR,KAA/D,CAAmCjG,KAAK,CAAC0G,KAAzC,EACA,GAAuBC,CAAAA,UAAvB,CAAiET,aAAjE,CAASlG,KAAK,CAACwG,KAAf,EAAkDI,UAAlD,CAAiEV,aAAjE,CAAoClG,KAAK,CAAC0G,KAA1C,EAEA,0BAAuFxG,oBAAoB,CACzG6F,SADyG,CAEzGA,SAAS,CAACc,MAAV,CAAiBhD,MAAjB,EAA2BC,MAA3B,CAAoCD,MAFqE,CAGzGoB,SAHyG,CAIzGsB,SAJyG,CAKzGE,SALyG,CAA3G,CAAQK,iBAAR,uBAAQA,iBAAR,CAA2BC,iBAA3B,uBAA2BA,iBAA3B,CAA8CC,iBAA9C,uBAA8CA,iBAA9C,CAAiEC,iBAAjE,uBAAiEA,iBAAjE,CAQA,0BAAgD7G,uBAAuB,CAACiF,WAAD,CAAvE,CAAQ6B,gBAAR,uBAAQA,gBAAR,CAA0BC,iBAA1B,uBAA0BA,iBAA1B,CAEA;AACA,GAAMC,CAAAA,IAAI,oBAAGhC,IAAH,SAAGA,IAAH,iBAAGA,IAAI,CAAEiC,WAAT,uDAAwBvJ,kBAAkB,CAACyH,WAAD,CAApD,CACA;AACA,GAAM+B,CAAAA,SAAS,mBAAGlC,IAAH,SAAGA,IAAH,iBAAGA,IAAI,CAAEmC,YAAT,qDAAyBxJ,QAAQ,CAACyJ,kBAAT,CAA4BJ,IAA5B,CAAxC,CACA,GAAMK,CAAAA,QAAQ,CACZ,MAAOlB,CAAAA,SAAP,GAAqB,QAArB,EAAiC,MAAOE,CAAAA,SAAP,GAAqB,QAAtD,EAAkE,CAACL,YAAnE,CACIvI,QAAQ,CAAC6J,WAAT,CAAqB,CACnBtC,IAAI,CAAEA,IAAF,SAAEA,IAAF,UAAEA,IAAF,CAAU,GAAIxH,CAAAA,IAAJ,CAASiG,MAAT,CAAiBC,MAAjB,CAAyBmB,SAAzB,CAAoCqC,SAApC,CAA+C,CAA/C,CAAkDF,IAAlD,CAAwD,EAAxD,CADK,CAEnBb,SAAS,CAATA,SAFmB,CAGnBE,SAAS,CAATA,SAHmB,CAInBkB,OAAO,CAAEjD,WAAW,CAACI,QAJF,CAKnB8C,OAAO,CAAE7C,WAAW,CAACD,QALF,CAMnB+C,gBAAgB,CAAE,IAAM;AANL,CAArB,CADJ,CASI1D,SAVN,CAYA,aAAyD5E,OAAO,CAC9D,iBAAOkI,CAAAA,QAAQ,CAAGA,QAAQ,CAACK,uBAAT,CAAiCrD,eAAjC,CAAH,CAAuD,CAAEkD,OAAO,CAAExD,SAAX,CAAsByD,OAAO,CAAEzD,SAA/B,CAAtE,EAD8D,CAE9D,CAACsD,QAAD,CAAWhD,eAAX,CAF8D,CAAhE,CAAiBsD,YAAjB,UAAQJ,OAAR,CAAwCK,YAAxC,UAA+BJ,OAA/B,CAKA,GAAMK,CAAAA,OAAO,CAAG1I,OAAO,CACrB,iBACEkI,CAAAA,QAAQ,EAAIlK,cAAc,CAACoH,aAAf,CAA6Bd,MAA7B,CAAqCzE,IAAI,CAACwG,QAAL,CAAclB,WAAW,CAACI,QAA1B,CAAoC2C,QAAQ,CAACE,OAAT,CAAiB7C,QAArD,CAArC,CADd,EADqB,CAGrB,CAACJ,WAAD,CAAc+C,QAAd,CAAwB5D,MAAxB,CAHqB,CAAvB,CAKA,GAAMqE,CAAAA,OAAO,CAAG3I,OAAO,CACrB,iBACEkI,CAAAA,QAAQ,EAAIlK,cAAc,CAACoH,aAAf,CAA6Bb,MAA7B,CAAqC1E,IAAI,CAACwG,QAAL,CAAcb,WAAW,CAACD,QAA1B,CAAoC2C,QAAQ,CAACG,OAAT,CAAiB9C,QAArD,CAArC,CADd,EADqB,CAGrB,CAACC,WAAD,CAAc0C,QAAd,CAAwB3D,MAAxB,CAHqB,CAAvB,CAMA,eAAsDtE,QAAQ,CAAU,KAAV,CAA9D,yCAAO2I,mBAAP,eAA4BC,sBAA5B,eACA,eAAwD5I,QAAQ,CAAgB,IAAhB,CAAhE,yCAAO6I,oBAAP,eAA6BC,uBAA7B,eAEA,GAAMC,CAAAA,QAAQ,CAAGnH,qBAAqB,EAAtC,CAEA;AACA,wBAAoCtC,kBAAkB,CAAC2E,WAAD,CAAc8E,QAAd,SAAcA,QAAd,iBAAcA,QAAQ,CAAEC,OAAxB,CAAtD,4DAAOC,QAAP,yBAAiBC,eAAjB,yBACA,0BAAiDrH,yBAAyB,CAACoC,WAAD,CAAc8E,QAAd,SAAcA,QAAd,iBAAcA,QAAQ,CAAEC,OAAxB,CAA1E,CAAQG,aAAR,uBAAQA,aAAR,CAAuBC,qBAAvB,uBAAuBA,qBAAvB,CAEA,GAAMC,CAAAA,cAAc,CAAGvH,iBAAiB,EAAxC,CAEA,GAAMwH,CAAAA,OAAO,CAAGzJ,WAAW,sEAAC,wIACtBgF,YAAY,EAAIwE,cADM,gDAGlBH,CAAAA,eAAe,EAHG,0CAIfE,qBAJe,gEAMhBA,CAAAA,qBAAqB,EANL,8FASlB,6DAAOG,IAAP,IAAgB,IATE,kDAUdL,CAAAA,eAAe,EAVD,+DAclBA,CAAAA,eAAe,EAdG,sEAAD,GAgBxB,CAACrE,YAAD,CAAewE,cAAf,CAA+BD,qBAA/B,CAAsDF,eAAtD,CAhBwB,CAA3B,CAkBA,GAAMM,CAAAA,cAAc,CAAG1I,mBAAmB,EAA1C,CACA,GAAM2I,CAAAA,kBAAkB,CAAG5I,uBAAuB,CAACgI,oBAAD,SAACA,oBAAD,UAACA,oBAAD,CAAyBlE,SAAzB,CAAlD,CAEA,GAAM+E,CAAAA,OAAO,CAAG7J,WAAW,CAAC,UAAM,2BAChC,GACE,CAACkJ,QAAD,EACA,CAACvE,OADD,EAEA,CAACO,QAFD,EAGA,CAACC,cAHD,EAIA,MAAO+B,CAAAA,SAAP,GAAqB,QAJrB,EAKA,MAAOE,CAAAA,SAAP,GAAqB,QALrB,EAMA,CAACsB,YAND,EAOA,CAACC,YAPD,EAQA,CAACjE,OATH,CAWE,OAEF,GAAMoF,CAAAA,aAAa,wBAAGR,aAAH,SAAGA,aAAH,iBAAGA,aAAa,CAAEpE,QAAlB,+DAA8BA,QAAjD,CAEA,GAAM6E,CAAAA,IAAc,CAAG,EAAvB,CAEA;AACA,GAAIT,aAAJ,CAAmB,CACjBS,IAAI,CAACC,IAAL,CACEd,QAAQ,CAACe,SAAT,CAAmBC,kBAAnB,CAAsC,YAAtC,CAAoD,CAClD/F,IAAI,CAACgF,OAD6C,aAE7C/E,WAAW,CAACqB,QAAZ,CAAqB0E,QAArB,CAA8B,EAA9B,CAF6C,EAGlDL,aAHkD,CAIlDR,aAAa,CAACc,CAJoC,CAKlDd,aAAa,CAACe,CALoC,CAMlDf,aAAa,CAACgB,CANoC,CAApD,CADF,EAUD,CAED;AACA,GAAItE,WAAJ,CAAiB,CACf+D,IAAI,CAACC,IAAL,CACEd,QAAQ,CAACe,SAAT,CAAmBC,kBAAnB,CAAsC,oCAAtC,CAA4E,CAC1E1F,MAAM,CAAC2E,OADmE,CAE1E1E,MAAM,CAAC0E,OAFmE,CAG1EvD,SAH0E,aAIrEqC,SAAS,CAACkC,QAAV,CAAmB,EAAnB,CAJqE,EAA5E,CADF,EAQD,CAED;AACAJ,IAAI,CAACC,IAAL,CACEd,QAAQ,CAACe,SAAT,CAAmBC,kBAAnB,CAAsC,SAAtC,CAAiD,CAC/C,CACE/F,IAAI,CAAEA,IAAI,CAACgF,OADb,CAEEoB,kBAAkB,aAAOnG,WAAW,CAACqB,QAAZ,CAAqB0E,QAArB,CAA8B,EAA9B,CAAP,CAFpB,CAGElG,mBAAmB,CAAnBA,mBAHF,CAIEO,MAAM,CAAEA,MAAM,CAAC2E,OAJjB,CAKE1E,MAAM,CAAEA,MAAM,CAAC0E,OALjB,CAMEqB,GAAG,CAAE5E,SANP,CAOEsB,SAAS,CAATA,SAPF,CAQEE,SAAS,CAATA,SARF,CASEqD,UAAU,aAAO/B,YAAY,CAACyB,QAAb,CAAsB,EAAtB,CAAP,CATZ,CAUEO,UAAU,aAAO/B,YAAY,CAACwB,QAAb,CAAsB,EAAtB,CAAP,CAVZ,CAWEQ,SAAS,CAAEhG,OAXb,CAYEO,QAAQ,CAAE4E,aAZZ,CAaEc,WAAW,CAAE,IAAM;AAbrB,CAD+C,CAAjD,CADF,EAoBA7B,sBAAsB,CAAC,IAAD,CAAtB,CAEAG,QAAQ,CAAC2B,WAAT,CACGC,SADH,CACaf,IADb,EAEGgB,IAFH,CAEQ,SAACC,WAAD,CAAiB,CACrB,MAAO9B,CAAAA,QAAQ,CACZ4B,SADI,CACMf,IADN,CACY,CAAEkB,QAAQ,CAAErI,kBAAkB,CAACoI,WAAD,CAA9B,CADZ,EAEJD,IAFI,CAEC,SAACG,QAAD,CAAmC,CACvC3K,OAAO,CAAC4K,KAAR,CAAc,CACZC,QAAQ,CAAE,SADE,CAEZC,MAAM,WAAKrG,YAAY,CAAG,WAAH,CAAiB,IAAlC,QAFM,CAGZsG,KAAK,WAAK1H,SAAS,CAACI,MAAf,aAAyBF,SAAS,CAACE,MAAnC,CAHO,CAAd,EAMA2F,cAAc,CAACuB,QAAD,CAAW,CACvBK,IAAI,CAAEjJ,eAAe,CAACkJ,oBADC,CAEvBC,cAAc,CAAE5I,UAAU,CAACe,SAAD,CAFH,CAGvB8H,eAAe,CAAE7I,UAAU,CAACiB,SAAD,CAHJ,CAIvB6H,MAAM,CAAE3G,YAJe,CAAX,CAAd,CAMAiE,uBAAuB,CAACiC,QAAQ,CAACU,IAAV,CAAvB,CACD,CAhBI,CAAP,CAiBD,CApBH,EAqBGC,KArBH,CAqBS,UAAM,CACX9C,sBAAsB,CAAC,KAAD,CAAtB,CACD,CAvBH,EAwBD,CA3F0B,CA2FxB,CACDrE,OADC,CAEDM,YAFC,CAGDkE,QAHC,CAIDlD,WAJC,CAKDb,cALC,CAMDX,MANC,CAODC,MAPC,CAQDmB,SARC,CASDxB,WATC,CAUD8C,SAVC,CAWDE,SAXC,CAYDa,SAZC,CAaDS,YAbC,CAcDC,YAdC,CAeDhE,OAfC,CAgBDO,QAhBC,CAiBDoE,aAjBC,CAkBDK,cAlBC,CAmBDxF,IAnBC,CAoBDP,SApBC,CAqBDE,SArBC,CA3FwB,CAA3B,CAmHA,GAAMgI,CAAAA,sBAAsB,CAAG,CAAC,CAAC9C,oBAAF,EAA0BjJ,IAAI,CAACgM,KAAL,CAAW3H,WAAW,CAACqB,QAAvB,CAAiCxC,IAAjC,CAAzD,CAEA,mBACE,MAAC,UAAD,EAAY,GAAG,CAAC,MAAhB,wBACE,MAAC,UAAD,CAAY,IAAZ,EAAiB,EAAE,CAAE,CAArB,CAAwB,KAAK,CAAE,CAAE+I,UAAU,CAAE,GAAd,CAA/B,wBACE,qIACsChH,YAAY,CAAG,WAAH,CAAiB,IADnE,GADF,CAKGN,OAAO,EAAIwE,QAAX,eACC,KAAC,YAAD,EAAc,IAAI,CAAEnG,eAAe,CAAC2B,OAAD,CAAUwE,QAAQ,CAACC,OAAnB,CAA4BrG,gBAAgB,CAACmJ,OAA7C,CAAnC,uBACE,KAAC,UAAD,CAAY,IAAZ,EAAiB,OAAO,CAAC,QAAzB,uBACE,mDADF,EADF,EANJ,OADF,cAgBE,KAAC,SAAD,wBACE,MAAC,UAAD,EAAY,GAAG,CAAC,IAAhB,wBACE,MAAC,UAAD,yBACE,MAAC,QAAD,EAAU,KAAK,CAAE,CAAEC,UAAU,CAAE,KAAd,CAAjB,wBACE,KAAC,kBAAD,EAAoB,SAAS,CAAEtI,SAA/B,CAA0C,SAAS,CAAEE,SAArD,CAAgE,MAAM,CAAE,KAAxE,CAA+E,IAAI,CAAE,EAArF,EADF,cAEE,KAAC,UAAD,CAAY,YAAZ,EAAyB,KAAK,CAAE,CAAEoI,UAAU,CAAE,KAAd,CAAhC,uBACE,6CACGtI,SAAS,CAACI,MADb,GACsBF,SAAS,CAACE,MADhC,GADF,EAFF,GADF,cASE,KAAC,KAAD,EAAO,OAAO,CAAEpF,YAAY,CAACuN,OAA7B,UAAuCnH,YAAY,CAAG,OAAH,CAAa,IAAhE,EATF,GADF,cAYE,KAAC,aAAD,EAAe,YAAY,CAAEK,WAA7B,CAA0C,YAAY,CAAEK,WAAxD,EAZF,GADF,EAhBF,cAiCE,YAAK,KAAK,CAAE,CAAE0G,OAAO,CAAE,MAAX,CAAmB7I,cAAc,CAAE,QAAnC,CAAZ,uBACE,KAAC,SAAD,EAAW,IAAI,CAAE,EAAjB,EADF,EAjCF,cAqCE,KAAC,SAAD,wBACE,MAAC,UAAD,EAAY,GAAG,CAAC,IAAhB,wBACE,MAAC,UAAD,yBACE,MAAC,QAAD,EAAU,KAAK,CAAE,CAAE2I,UAAU,CAAE,KAAd,CAAjB,wBACE,KAAC,kBAAD,EAAoB,SAAS,CAAEtI,SAA/B,CAA0C,SAAS,CAAEE,SAArD,CAAgE,MAAM,CAAE,KAAxE,CAA+E,IAAI,CAAE,EAArF,EADF,cAEE,KAAC,UAAD,CAAY,YAAZ,EAAyB,KAAK,CAAE,CAAEoI,UAAU,CAAE,KAAd,CAAhC,uBACE,0CACGtI,SAAS,CAACI,MADb,GACsBF,SAAS,CAACE,MADhC,GADF,EAFF,GADF,cASE,KAAC,KAAD,EAAO,OAAO,CAAEpF,YAAY,CAACyN,OAA7B,gBATF,GADF,cAaE,KAAC,WAAD,EAAa,SAAS,CAAEzG,SAAxB,CAAmC,mBAAmB,CAAEC,YAAxD,EAbF,CAcGG,WAAW,eACV,MAAC,QAAD,EAAU,KAAK,CAAE,CAAEoG,OAAO,CAAE,MAAX,CAAmBE,aAAa,CAAE,QAAlC,CAA4C9I,UAAU,CAAE,QAAxD,CAAjB,wBACE,KAAC,WAAD,EAAa,KAAK,CAAEoB,KAAK,CAAC2H,KAA1B,CAAiC,KAAK,CAAE,CAAEC,YAAY,CAAE,MAAhB,CAAwBC,OAAO,CAAE,GAAjC,CAAxC,EADF,cAEE,KAAC,UAAD,CAAY,IAAZ,EACE,QAAQ,CAAE,EADZ,CAEE,KAAK,CAAE,CAAED,YAAY,CAAE,CAAhB,CAAmBR,UAAU,CAAE,GAA/B,CAAoCS,OAAO,CAAE,GAA7C,CAFT,CAGE,SAAS,CAAC,QAHZ,uBAKE,gJAEWzH,YAAY,CAAG,WAAH,CAAiB,IAFxC,GALF,EAFF,cAaE,KAAC,UAAD,CAAY,IAAZ,EACE,UAAU,CAAE,GADd,CAEE,SAAS,CAAC,QAFZ,CAGE,QAAQ,CAAE,EAHZ,CAIE,KAAK,CAAE,CAAE0H,SAAS,CAAE,KAAb,CAAoBD,OAAO,CAAE,GAA7B,CAJT,uBAME,uGANF,EAbF,CAsBGvG,WAAW,eACV,KAAC,UAAD,EAAY,GAAG,CAAC,KAAhB,CAAsB,KAAK,CAAE,CAAEwG,SAAS,CAAE,MAAb,CAA7B,uBACE,KAAC,UAAD,wBACE,MAAC,UAAD,CAAY,IAAZ,EAAiB,UAAU,CAAE,GAA7B,CAAkC,QAAQ,CAAE,EAA5C,wBACE,0CACG1H,YAAY,CAAG,WAAH,CAAiB,IADhC,GACuC8B,WAAW,CAAGhD,SAAS,CAACE,MAAb,CAAsBJ,SAAS,CAACI,MADlF,GADF,CAGW,GAHX,CAIG8C,WAAW,WACLZ,WADK,SACLA,WADK,sCACLA,WAAW,CAAEyG,MAAb,EADK,8CACL,oBAAuBC,aAAvB,CAAqC,CAArC,CADK,aACsChJ,SAAS,CAACI,MADhD,YAELkC,WAFK,SAELA,WAFK,iBAELA,WAAW,CAAE0G,aAAb,CAA2B,CAA3B,CAFK,aAE4B9I,SAAS,CAACE,MAFtC,CAJd,GADF,EADF,EAvBJ,GAfJ,CAsDGyC,oBAAoB,cACnB,MAAC,UAAD,yBACE,MAAC,UAAD,EAAY,GAAG,CAAC,KAAhB,wBACE,MAAC,UAAD,yBACE,KAAC,UAAD,CAAY,IAAZ,EAAiB,QAAQ,CAAE,EAA3B,uBACE,0CACGzB,YAAY,CAAG,WAAH,CAAiB,IADhC,GACuC8B,WAAW,CAAGhD,SAAS,CAACE,MAAb,CAAsBJ,SAAS,CAACI,MADlF,GADF,EADF,cAME,KAAC,UAAD,CAAY,KAAZ,EAAkB,QAAQ,CAAE,EAA5B,UACG8C,WAAW,WACLZ,WADK,SACLA,WADK,uCACLA,WAAW,CAAEyG,MAAb,EADK,+CACL,qBAAuBC,aAAvB,CAAqC,CAArC,CADK,aACsChJ,SAAS,CAACI,MADhD,YAELkC,WAFK,SAELA,WAFK,iBAELA,WAAW,CAAE0G,aAAb,CAA2B,CAA3B,CAFK,aAE4B9I,SAAS,CAACE,MAFtC,CADd,EANF,GADF,cAcE,MAAC,UAAD,yBACE,KAAC,UAAD,CAAY,IAAZ,EAAiB,QAAQ,CAAE,EAA3B,uBACE,yCAAW8C,WAAW,CAAGhD,SAAS,CAACE,MAAb,CAAsBJ,SAAS,CAACI,MAAtD,GADF,EADF,cAIE,KAAC,UAAD,CAAY,KAAZ,EAAkB,QAAQ,CAAE,EAA5B,UACG8C,WAAW,WACLX,WADK,SACLA,WADK,sCACLA,WAAW,CAAEwG,MAAb,EADK,8CACL,oBAAuBC,aAAvB,CAAqC,CAArC,CADK,aACsChJ,SAAS,CAACI,MADhD,YAELmC,WAFK,SAELA,WAFK,iBAELA,WAAW,CAAEyG,aAAb,CAA2B,CAA3B,CAFK,aAE4B9I,SAAS,CAACE,MAFtC,CADd,EAJF,GAdF,cAyBE,MAAC,UAAD,yBACE,KAAC,UAAD,CAAY,IAAZ,EAAiB,QAAQ,CAAE,EAA3B,CAA+B,KAAK,CAAC,SAArC,uBACE,oCADF,EADF,cAIE,KAAC,UAAD,CAAY,KAAZ,EAAkB,QAAQ,CAAE,EAA5B,CAAgC,KAAK,CAAC,SAAtC,uBACE,wDAAQsC,uBAAR,iDAAQ,uBAAyBsG,aAAzB,CAAuC,CAAvC,CAAR,GADF,EAJF,GAzBF,GADF,cAmCE,KAAC,UAAD,CAAY,IAAZ,EAAiB,QAAQ,CAAE,EAA3B,CAA+B,KAAK,CAAE,CAAEF,SAAS,CAAE,CAAb,CAAgBV,UAAU,CAAE,GAA5B,CAAtC,uBACE,mPACuF,aADvF,GADF,EAnCF,GADmB,CA4CjB,CAAChG,WAAD,EAAgBG,WAAhB,cACF,MAAC,UAAD,yBACE,KAAC,UAAD,CAAY,IAAZ,EAAiB,QAAQ,CAAE,EAA3B,uBACE,yCAAWW,WAAW,CAAGhD,SAAS,CAACE,MAAb,CAAsBJ,SAAS,CAACI,MAAtD,GADF,EADF,cAIE,KAAC,UAAD,CAAY,KAAZ,EAAkB,QAAQ,CAAE,EAA5B,UACG8C,WAAW,WACLX,WADK,SACLA,WADK,uCACLA,WAAW,CAAEwG,MAAb,EADK,+CACL,qBAAuBC,aAAvB,CAAqC,CAArC,CADK,aACsChJ,SAAS,CAACI,MADhD,YAELmC,WAFK,SAELA,WAFK,iBAELA,WAAW,CAAEyG,aAAb,CAA2B,CAA3B,CAFK,aAE4B9I,SAAS,CAACE,MAFtC,CADd,EAJF,GADE,CAWA,IA7GN,cA+GE,MAAC,UAAD,yBACE,KAAC,UAAD,CAAY,KAAZ,wBACE,kCADF,EADF,cAIE,KAAC,UAAD,EACE,SAAS,CAAE8C,WAAW,CAAGhD,SAAH,CAAeF,SADvC,CAEE,SAAS,CAAEkD,WAAW,CAAGlD,SAAH,CAAeE,SAFvC,CAGE,gBAAgB,CAAE,2BAAM,CACtB+D,gBAAgB,CAAC,EAAD,CAAhB,CACAC,iBAAiB,CAAC,EAAD,CAAjB,CACAnB,YAAY,CAAC,SAACkG,IAAD,QAAWA,CAAAA,IAAI,CAACrF,MAAL,CAAYhD,MAAZ,EAAsBC,MAAtB,CAA+BD,MAA1C,EAAD,CAAZ,CACD,CAPH,EAJF,GA/GF,cA8HE,KAAC,aAAD,EACE,UAAU,CAAE8C,UADd,CAEE,UAAU,CAAEC,UAFd,CAGE,iBAAiB,CAAEE,iBAHrB,CAIE,iBAAiB,CAAEC,iBAJrB,CAKE,iBAAiB,CAAEC,iBALrB,CAME,iBAAiB,CAAEC,iBANrB,CAOE,gBAAgB,CAAEC,gBAPpB,CAQE,iBAAiB,CAAEC,iBARrB,CASE,SAAS,CAAEhB,WAAW,CAAGhD,SAAH,CAAeF,SATvC,CAUE,SAAS,CAAEkD,WAAW,CAAGlD,SAAH,CAAeE,SAVvC,CAWE,SAAS,CAAE8B,SAXb,CAYE,YAAY,CAAEqB,YAZhB,EA9HF,CA6IGD,UAAU,cACT,KAAC,UAAD,EAAY,OAAO,CAAC,UAApB,CAA+B,aAAa,CAAC,MAA7C,uBACE,MAAC,UAAD,yBACE,KAAC,aAAD,EAAe,MAAM,CAAEpC,KAAK,CAACkI,OAA7B,CAAsC,IAAI,CAAC,MAA3C,EADF,cAEE,KAAC,UAAD,CAAY,MAAZ,EAAmB,EAAE,CAAC,MAAtB,CAA6B,QAAQ,CAAC,MAAtC,uBACE,sHADF,EAFF,GADF,EADS,CAWP,IAxJN,CA0JG/F,YAAY,cACX,KAAC,UAAD,EAAY,OAAO,CAAC,UAApB,CAA+B,aAAa,CAAC,MAA7C,uBACE,MAAC,UAAD,yBACE,KAAC,aAAD,EAAe,MAAM,CAAEnC,KAAK,CAACkI,OAA7B,CAAsC,IAAI,CAAC,MAA3C,EADF,cAEE,KAAC,UAAD,CAAY,MAAZ,EAAmB,EAAE,CAAC,MAAtB,CAA6B,QAAQ,CAAC,MAAtC,uBACE,0FADF,EAFF,GADF,EADW,CAST,IAnKN,CAqKG1E,QAAQ,cACP,KAAC,YAAD,wBACE,MAAC,UAAD,EAAY,GAAG,CAAC,IAAhB,wBACE,KAAC,aAAD,EAAe,YAAY,CAAEA,QAAQ,CAACE,OAAtC,CAA+C,YAAY,CAAEF,QAAQ,CAACG,OAAtE,EADF,CAEG7D,OAAO,EAAIkE,OAAX,EAAsBC,OAAtB,cACC,KAAC,UAAD,CAAY,KAAZ,EAAkB,QAAQ,CAAE,EAA5B,uBACE,qHACY1H,oBAAoB,CAACyH,OAAD,CAAU,CAAV,CADhC,GAEGpE,MAAM,CAACgD,MAAP,CAAc5F,uBAAuB,CAAC8C,OAAD,CAArC,EAAkD,KAAlD,CAA0DF,MAAM,CAACR,MAFpE,GAGG7C,oBAAoB,CAAC0H,OAAD,CAAU,CAAV,CAHvB,GAIGpE,MAAM,CAAC+C,MAAP,CAAc5F,uBAAuB,CAAC8C,OAAD,CAArC,EAAkD,KAAlD,CAA0DD,MAAM,CAACT,MAJpE,GADF,EADD,CAUG,IAZN,GADF,EADO,CAiBL,IAtLN,cAwLE,MAAC,UAAD,EAAY,GAAG,CAAC,MAAhB,WACG,CAAC8H,sBAAD,EAA2B,CAAClC,kBAA5B,cACC,KAAC,UAAD,EAAY,GAAG,CAAC,MAAhB,CAAuB,KAAK,CAAE,CAAEmD,IAAI,CAAE,GAAR,CAA9B,uBACE,KAAC,eAAD,EACE,SAAS,CAAE3D,QAAQ,GAAK5J,aAAa,CAACwN,QAA3B,EAAuC1D,aAAa,GAAK,IADtE,CAEE,QAAQ,CACNF,QAAQ,GAAK5J,aAAa,CAACyN,YAA3B,EACA3D,aAAa,GAAK,IADlB,EAEA,CAACZ,YAFD,EAGA,CAACC,YAHD,EAIA5B,YAJA,EAKA+B,mBARJ,CAUE,OAAO,CAAEW,OAVX,UAYGL,QAAQ,GAAK5J,aAAa,CAAC0N,OAA3B,cACC,KAAC,IAAD,wBACE,4BADF,EADD,CAIG9D,QAAQ,GAAK5J,aAAa,CAACwN,QAA3B,EAAuC1D,aAAa,GAAK,IAAzD,cACF,0BADE,cAGF,2CAnBJ,EADF,EADD,CAyBG,IA1BN,cA2BE,KAAC,UAAD,EAAY,GAAG,CAAC,MAAhB,CAAuB,KAAK,CAAE,CAAEyD,IAAI,CAAE,GAAR,CAA9B,uBACE,KAAC,eAAD,EACE,SAAS,CAAEjB,sBADb,CAEE,QAAQ,CACN,CAACpD,YAAD,EACA,CAACC,YADD,EAEA5B,YAFA,EAGCqC,QAAQ,GAAK5J,aAAa,CAACwN,QAA3B,EAAuC1D,aAAa,GAAK,IAH1D,EAIAR,mBAJA,EAKAc,kBALA,EAMAkC,sBATJ,CAWE,OAAO,CAAEjC,OAXX,UAaGiC,sBAAsB,CACrB,UADqB,CAEnBlC,kBAAkB,cACpB,KAAC,IAAD,wBACE,4BADF,EADoB,cAKpB,0BApBJ,EADF,EA3BF,GAxLF,GADF,EArCF,GADF,CAwRD,CAED,cAAe,SAASuD,CAAAA,aAAT,OAI8B,sHAF/BhE,CAAAA,OAE+B,OAH3CiE,KAG2C,CAFzCC,MAEyC,CAF/BlE,OAE+B,CAC3C;AACA,GAAMmE,CAAAA,QAAQ,CAAG5M,cAAc,EAA/B,CACAT,SAAS,CAAC,UAAM,CACdqN,QAAQ,CAAC1M,cAAc,EAAf,CAAR,CACA,MAAO,WAAM,CACX0M,QAAQ,CAAC1M,cAAc,EAAf,CAAR,CACD,CAFD,CAGD,CALQ,CAKN,CAAC0M,QAAD,CALM,CAAT,CAOA,yBAA6BnL,kBAAkB,EAA/C,CAAQuC,OAAR,sBAAQA,OAAR,CAAiBC,OAAjB,sBAAiBA,OAAjB,CAEA;AACA,GAAM4I,CAAAA,gBAAgB,CAAG5K,SAAS,CAACwG,OAAD,CAAlC,CACA,GAAMhF,CAAAA,IAAI,CAAGrC,eAAe,CAACyL,gBAAgB,CAAGA,gBAAH,CAAsBzI,SAAvC,CAA5B,CAEA;AACA,GAAM0I,CAAAA,sBAAsB,CAAGnL,mBAAmB,CAAC8B,IAAD,CAAO,QAAP,CAAiBW,SAAjB,CAA4B1C,YAA5B,CAAlD,CACA,GAAMqL,CAAAA,aAAa,CAAGD,sBAAH,SAAGA,sBAAH,wCAAGA,sBAAsB,CAAEvI,MAA3B,gDAAG,sBAAiC,CAAjC,CAAtB,CACA,GAAMyI,CAAAA,aAAa,uBAAGrL,mBAAmB,CAAC8B,IAAD,CAAO,QAAP,CAAiBW,SAAjB,CAA4B1C,YAA5B,CAAtB,sEAAG,qBAA8D6C,MAAjE,gDAAG,sBAAuE,CAAvE,CAAtB,CAEA;AACA,GAAMT,CAAAA,MAAM,CAAG3C,QAAQ,CAAC4L,aAAD,CAAvB,CACA,GAAMhJ,CAAAA,MAAM,CAAG5C,QAAQ,CAAC6L,aAAD,CAAvB,CAEA;AACA,GAAMC,CAAAA,cAAiC,CAAGzN,OAAO,CAC/C,iBAAOwE,CAAAA,OAAO,EAAI6I,gBAAX,CAA8B,GAAIlP,CAAAA,KAAJ,CAAUqG,OAAV,CAAmB6I,gBAAnB,CAAqC,EAArC,CAA9B,CAAyEzI,SAAhF,EAD+C,CAE/C,CAACJ,OAAD,CAAU6I,gBAAV,CAF+C,CAAjD,CAKA;AACA,GAAMnJ,CAAAA,WAAW,CAAG7B,eAAe,CAACoC,OAAD,SAACA,OAAD,UAACA,OAAD,CAAYG,SAAZ,CAAuB6I,cAAvB,CAAnC,CACA,GAAMtJ,CAAAA,WAAW,CAAGnC,cAAc,CAACyL,cAAD,CAAlC,CACA,yDAAmCtL,mBAAmB,CAAC8B,IAAD,CAAO,aAAP,CAAtD,gDAAmC,sBAA0Cc,MAA7E,iEAAuF,EAAvF,+BAAO2I,WAAP,UAAoBC,WAApB,UACA,GAAMvJ,CAAAA,QAAQ,CAAGpE,OAAO,CACtB,iBAAOsE,CAAAA,MAAM,EAAIoJ,WAAV,CAAwB1P,cAAc,CAACoH,aAAf,CAA6Bd,MAA7B,CAAqCoJ,WAArC,CAAxB,CAA4E9I,SAAnF,EADsB,CAEtB,CAACN,MAAD,CAASoJ,WAAT,CAFsB,CAAxB,CAIA,GAAMrJ,CAAAA,QAAQ,CAAGrE,OAAO,CACtB,iBAAOuE,CAAAA,MAAM,EAAIoJ,WAAV,CAAwB3P,cAAc,CAACoH,aAAf,CAA6Bb,MAA7B,CAAqCoJ,WAArC,CAAxB,CAA4E/I,SAAnF,EADsB,CAEtB,CAACL,MAAD,CAASoJ,WAAT,CAFsB,CAAxB,CAKA;AACA,GACE,CAACN,gBAAD,EACA,CAACpJ,IADD,EAECA,IAAI,GACHqJ,sBADG,SACHA,sBADG,iBACHA,sBAAsB,CAAEM,KADrB,CAAJ,EAEC,EAACN,sBAAD,SAACA,sBAAD,iBAACA,sBAAsB,CAAEO,OAAzB,CAFD,EAGC,EAACP,sBAAD,SAACA,sBAAD,iBAACA,sBAAsB,CAAEQ,KAAzB,CAHD,EAIC,CAACP,aAPL,CAQE,CACAQ,OAAO,CAACD,KAAR,CAAc,sBAAd,EACA,mBAAO,KAAC,QAAD,EAAU,EAAE,CAAC,aAAb,EAAP,CACD,CAED,mBACE,KAAC,WAAD,EAAa,KAAK,CAAE,CAAEE,OAAO,CAAE,EAAX,CAApB,uBACE,MAAC,UAAD,EAAY,GAAG,CAAC,MAAhB,wBACE,MAAC,OAAD,EAAS,KAAK,CAAE,CAAE1K,UAAU,CAAE,QAAd,CAAwBD,cAAc,CAAE,eAAxC,CAAhB,CAA2E,GAAG,CAAC,KAA/E,wBACE,KAAC,SAAD,EAAW,EAAE,CAAC,aAAd,EADF,cAEE,KAAC,UAAD,CAAY,YAAZ,wBACE,uCADF,EAFF,cAKE,KAAC,WAAD,EAAa,mBAAmB,CAAEJ,kCAAlC,EALF,GADF,CASG,CAACwB,OAAD,cACC,KAAC,UAAD,CAAY,WAAZ,wBACE,+CADF,EADD,CAIGP,WAAW,EAAIC,WAAf,EAA8BC,QAA9B,EAA0CC,QAA1C,EAAsDC,MAAtD,EAAgEC,MAAhE,cACF,KAAC,eAAD,EACE,IAAI,CAAEN,IADR,CAEE,WAAW,CAAEC,WAFf,CAGE,WAAW,CAAEC,WAHf,CAIE,QAAQ,CAAEC,QAJZ,CAKE,QAAQ,CAAEC,QALZ,CAME,MAAM,CAAEC,MANV,CAOE,MAAM,CAAEC,MAPV,EADE,cAWF,KAAC,UAAD,EAAY,OAAO,cAAE,0BAArB,EAxBJ,GADF,EADF,CA+BD","sourcesContent":["import { Contract } from '@ethersproject/contracts'\nimport { TransactionResponse } from '@ethersproject/providers'\nimport { Trans } from '@lingui/macro'\nimport { CurrencyAmount, Fraction, Percent, Price, Token } from '@uniswap/sdk-core'\nimport { FeeAmount, Pool, Position, priceToClosestTick, TickMath } from '@uniswap/v3-sdk'\nimport Badge, { BadgeVariant } from 'components/Badge'\nimport { ButtonConfirmed } from 'components/Button'\nimport { BlueCard, DarkGreyCard, LightCard, YellowCard } from 'components/Card'\nimport DoubleCurrencyLogo from 'components/DoubleLogo'\nimport FeeSelector from 'components/FeeSelector'\nimport RangeSelector from 'components/RangeSelector'\nimport RateToggle from 'components/RateToggle'\nimport SettingsTab from 'components/Settings'\nimport { Dots } from 'components/swap/styleds'\nimport { ApprovalState, useApproveCallback } from 'hooks/useApproveCallback'\nimport useCurrentBlockTimestamp from 'hooks/useCurrentBlockTimestamp'\nimport { PoolState, usePool } from 'hooks/usePools'\nimport useTheme from 'hooks/useTheme'\nimport useTransactionDeadline from 'hooks/useTransactionDeadline'\nimport JSBI from 'jsbi'\nimport { ReactNode, useCallback, useEffect, useMemo, useState } from 'react'\nimport { AlertCircle, AlertTriangle, ArrowDown } from 'react-feather'\nimport ReactGA from 'react-ga'\nimport { Redirect, RouteComponentProps } from 'react-router'\nimport { Text } from 'rebass'\nimport { useAppDispatch } from 'state/hooks'\nimport { Bound, resetMintState } from 'state/mint/v3/actions'\nimport { useRangeHopCallbacks, useV3DerivedMintInfo, useV3MintActionHandlers } from 'state/mint/v3/hooks'\nimport { useIsTransactionPending, useTransactionAdder } from 'state/transactions/hooks'\nimport { useUserSlippageToleranceWithDefault } from 'state/user/hooks'\nimport { formatCurrencyAmount } from 'utils/formatCurrencyAmount'\nimport { unwrappedToken } from 'utils/unwrappedToken'\n\nimport { AutoColumn } from '../../components/Column'\nimport CurrencyLogo from '../../components/CurrencyLogo'\nimport FormattedCurrencyAmount from '../../components/FormattedCurrencyAmount'\nimport { AutoRow, RowBetween, RowFixed } from '../../components/Row'\nimport { V2_FACTORY_ADDRESSES } from '../../constants/addresses'\nimport { WRAPPED_NATIVE_CURRENCY } from '../../constants/tokens'\nimport { useToken } from '../../hooks/Tokens'\nimport { usePairContract, useV2MigratorContract } from '../../hooks/useContract'\nimport { useV2LiquidityTokenPermit } from '../../hooks/useERC20Permit'\nimport useIsArgentWallet from '../../hooks/useIsArgentWallet'\nimport { useTotalSupply } from '../../hooks/useTotalSupply'\nimport { useActiveWeb3React } from '../../hooks/web3'\nimport { NEVER_RELOAD, useSingleCallResult } from '../../state/multicall/hooks'\nimport { TransactionType } from '../../state/transactions/actions'\nimport { useTokenBalance } from '../../state/wallet/hooks'\nimport { BackArrow, ExternalLink, ThemedText } from '../../theme'\nimport { isAddress } from '../../utils'\nimport { calculateGasMargin } from '../../utils/calculateGasMargin'\nimport { currencyId } from '../../utils/currencyId'\nimport { ExplorerDataType, getExplorerLink } from '../../utils/getExplorerLink'\nimport { BodyWrapper } from '../AppBody'\n\nconst ZERO = JSBI.BigInt(0)\n\nconst DEFAULT_MIGRATE_SLIPPAGE_TOLERANCE = new Percent(75, 10_000)\n\nfunction EmptyState({ message }: { message: ReactNode }) {\n  return (\n    <AutoColumn style={{ minHeight: 200, justifyContent: 'center', alignItems: 'center' }}>\n      <ThemedText.Body>{message}</ThemedText.Body>\n    </AutoColumn>\n  )\n}\n\nfunction LiquidityInfo({\n  token0Amount,\n  token1Amount,\n}: {\n  token0Amount: CurrencyAmount<Token>\n  token1Amount: CurrencyAmount<Token>\n}) {\n  const currency0 = unwrappedToken(token0Amount.currency)\n  const currency1 = unwrappedToken(token1Amount.currency)\n\n  return (\n    <AutoColumn gap=\"8px\">\n      <RowBetween>\n        <RowFixed>\n          <CurrencyLogo size=\"20px\" style={{ marginRight: '8px' }} currency={currency0} />\n          <Text fontSize={16} fontWeight={500}>\n            {currency0.symbol}\n          </Text>\n        </RowFixed>\n        <Text fontSize={16} fontWeight={500}>\n          <FormattedCurrencyAmount currencyAmount={token0Amount} />\n        </Text>\n      </RowBetween>\n      <RowBetween>\n        <RowFixed>\n          <CurrencyLogo size=\"20px\" style={{ marginRight: '8px' }} currency={currency1} />\n          <Text fontSize={16} fontWeight={500}>\n            {currency1.symbol}\n          </Text>\n        </RowFixed>\n\n        <Text fontSize={16} fontWeight={500}>\n          <FormattedCurrencyAmount currencyAmount={token1Amount} />\n        </Text>\n      </RowBetween>\n    </AutoColumn>\n  )\n}\n\n// hard-code this for now\nconst percentageToMigrate = 100\n\nfunction V2PairMigration({\n  pair,\n  pairBalance,\n  totalSupply,\n  reserve0,\n  reserve1,\n  token0,\n  token1,\n}: {\n  pair: Contract\n  pairBalance: CurrencyAmount<Token>\n  totalSupply: CurrencyAmount<Token>\n  reserve0: CurrencyAmount<Token>\n  reserve1: CurrencyAmount<Token>\n  token0: Token\n  token1: Token\n}) {\n  const { chainId, account } = useActiveWeb3React()\n  const theme = useTheme()\n  const v2FactoryAddress = chainId ? V2_FACTORY_ADDRESSES[chainId] : undefined\n\n  const pairFactory = useSingleCallResult(pair, 'factory')\n  const isNotUniswap = pairFactory.result?.[0] && pairFactory.result[0] !== v2FactoryAddress\n\n  const deadline = useTransactionDeadline() // custom from users settings\n  const blockTimestamp = useCurrentBlockTimestamp()\n  const allowedSlippage = useUserSlippageToleranceWithDefault(DEFAULT_MIGRATE_SLIPPAGE_TOLERANCE) // custom from users\n\n  const currency0 = unwrappedToken(token0)\n  const currency1 = unwrappedToken(token1)\n\n  // this is just getLiquidityValue with the fee off, but for the passed pair\n  const token0Value = useMemo(\n    () =>\n      CurrencyAmount.fromRawAmount(\n        token0,\n        JSBI.divide(JSBI.multiply(pairBalance.quotient, reserve0.quotient), totalSupply.quotient)\n      ),\n    [token0, pairBalance, reserve0, totalSupply]\n  )\n  const token1Value = useMemo(\n    () =>\n      CurrencyAmount.fromRawAmount(\n        token1,\n        JSBI.divide(JSBI.multiply(pairBalance.quotient, reserve1.quotient), totalSupply.quotient)\n      ),\n    [token1, pairBalance, reserve1, totalSupply]\n  )\n\n  // set up v3 pool\n  const [feeAmount, setFeeAmount] = useState(FeeAmount.MEDIUM)\n  const [poolState, pool] = usePool(token0, token1, feeAmount)\n  const noLiquidity = poolState === PoolState.NOT_EXISTS\n\n  // get spot prices + price difference\n  const v2SpotPrice = useMemo(\n    () => new Price(token0, token1, reserve0.quotient, reserve1.quotient),\n    [token0, token1, reserve0, reserve1]\n  )\n  const v3SpotPrice = poolState === PoolState.EXISTS ? pool?.token0Price : undefined\n\n  let priceDifferenceFraction: Fraction | undefined =\n    v2SpotPrice && v3SpotPrice ? v3SpotPrice.divide(v2SpotPrice).subtract(1).multiply(100) : undefined\n  if (priceDifferenceFraction?.lessThan(ZERO)) {\n    priceDifferenceFraction = priceDifferenceFraction.multiply(-1)\n  }\n\n  const largePriceDifference = priceDifferenceFraction && !priceDifferenceFraction?.lessThan(JSBI.BigInt(2))\n\n  // the following is a small hack to get access to price range data/input handlers\n  const [baseToken, setBaseToken] = useState(token0)\n  const { ticks, pricesAtTicks, invertPrice, invalidRange, outOfRange, ticksAtLimit } = useV3DerivedMintInfo(\n    token0,\n    token1,\n    feeAmount,\n    baseToken\n  )\n\n  // get value and prices at ticks\n  const { [Bound.LOWER]: tickLower, [Bound.UPPER]: tickUpper } = ticks\n  const { [Bound.LOWER]: priceLower, [Bound.UPPER]: priceUpper } = pricesAtTicks\n\n  const { getDecrementLower, getIncrementLower, getDecrementUpper, getIncrementUpper } = useRangeHopCallbacks(\n    baseToken,\n    baseToken.equals(token0) ? token1 : token0,\n    feeAmount,\n    tickLower,\n    tickUpper\n  )\n\n  const { onLeftRangeInput, onRightRangeInput } = useV3MintActionHandlers(noLiquidity)\n\n  // the v3 tick is either the pool's tickCurrent, or the tick closest to the v2 spot price\n  const tick = pool?.tickCurrent ?? priceToClosestTick(v2SpotPrice)\n  // the price is either the current v3 price, or the price at the tick\n  const sqrtPrice = pool?.sqrtRatioX96 ?? TickMath.getSqrtRatioAtTick(tick)\n  const position =\n    typeof tickLower === 'number' && typeof tickUpper === 'number' && !invalidRange\n      ? Position.fromAmounts({\n          pool: pool ?? new Pool(token0, token1, feeAmount, sqrtPrice, 0, tick, []),\n          tickLower,\n          tickUpper,\n          amount0: token0Value.quotient,\n          amount1: token1Value.quotient,\n          useFullPrecision: true, // we want full precision for the theoretical position\n        })\n      : undefined\n\n  const { amount0: v3Amount0Min, amount1: v3Amount1Min } = useMemo(\n    () => (position ? position.mintAmountsWithSlippage(allowedSlippage) : { amount0: undefined, amount1: undefined }),\n    [position, allowedSlippage]\n  )\n\n  const refund0 = useMemo(\n    () =>\n      position && CurrencyAmount.fromRawAmount(token0, JSBI.subtract(token0Value.quotient, position.amount0.quotient)),\n    [token0Value, position, token0]\n  )\n  const refund1 = useMemo(\n    () =>\n      position && CurrencyAmount.fromRawAmount(token1, JSBI.subtract(token1Value.quotient, position.amount1.quotient)),\n    [token1Value, position, token1]\n  )\n\n  const [confirmingMigration, setConfirmingMigration] = useState<boolean>(false)\n  const [pendingMigrationHash, setPendingMigrationHash] = useState<string | null>(null)\n\n  const migrator = useV2MigratorContract()\n\n  // approvals\n  const [approval, approveManually] = useApproveCallback(pairBalance, migrator?.address)\n  const { signatureData, gatherPermitSignature } = useV2LiquidityTokenPermit(pairBalance, migrator?.address)\n\n  const isArgentWallet = useIsArgentWallet()\n\n  const approve = useCallback(async () => {\n    if (isNotUniswap || isArgentWallet) {\n      // sushi has to be manually approved\n      await approveManually()\n    } else if (gatherPermitSignature) {\n      try {\n        await gatherPermitSignature()\n      } catch (error) {\n        // try to approve if gatherPermitSignature failed for any reason other than the user rejecting it\n        if (error?.code !== 4001) {\n          await approveManually()\n        }\n      }\n    } else {\n      await approveManually()\n    }\n  }, [isNotUniswap, isArgentWallet, gatherPermitSignature, approveManually])\n\n  const addTransaction = useTransactionAdder()\n  const isMigrationPending = useIsTransactionPending(pendingMigrationHash ?? undefined)\n\n  const migrate = useCallback(() => {\n    if (\n      !migrator ||\n      !account ||\n      !deadline ||\n      !blockTimestamp ||\n      typeof tickLower !== 'number' ||\n      typeof tickUpper !== 'number' ||\n      !v3Amount0Min ||\n      !v3Amount1Min ||\n      !chainId\n    )\n      return\n\n    const deadlineToUse = signatureData?.deadline ?? deadline\n\n    const data: string[] = []\n\n    // permit if necessary\n    if (signatureData) {\n      data.push(\n        migrator.interface.encodeFunctionData('selfPermit', [\n          pair.address,\n          `0x${pairBalance.quotient.toString(16)}`,\n          deadlineToUse,\n          signatureData.v,\n          signatureData.r,\n          signatureData.s,\n        ])\n      )\n    }\n\n    // create/initialize pool if necessary\n    if (noLiquidity) {\n      data.push(\n        migrator.interface.encodeFunctionData('createAndInitializePoolIfNecessary', [\n          token0.address,\n          token1.address,\n          feeAmount,\n          `0x${sqrtPrice.toString(16)}`,\n        ])\n      )\n    }\n\n    // TODO could save gas by not doing this in multicall\n    data.push(\n      migrator.interface.encodeFunctionData('migrate', [\n        {\n          pair: pair.address,\n          liquidityToMigrate: `0x${pairBalance.quotient.toString(16)}`,\n          percentageToMigrate,\n          token0: token0.address,\n          token1: token1.address,\n          fee: feeAmount,\n          tickLower,\n          tickUpper,\n          amount0Min: `0x${v3Amount0Min.toString(16)}`,\n          amount1Min: `0x${v3Amount1Min.toString(16)}`,\n          recipient: account,\n          deadline: deadlineToUse,\n          refundAsETH: true, // hard-code this for now\n        },\n      ])\n    )\n\n    setConfirmingMigration(true)\n\n    migrator.estimateGas\n      .multicall(data)\n      .then((gasEstimate) => {\n        return migrator\n          .multicall(data, { gasLimit: calculateGasMargin(gasEstimate) })\n          .then((response: TransactionResponse) => {\n            ReactGA.event({\n              category: 'Migrate',\n              action: `${isNotUniswap ? 'SushiSwap' : 'V2'}->V3`,\n              label: `${currency0.symbol}/${currency1.symbol}`,\n            })\n\n            addTransaction(response, {\n              type: TransactionType.MIGRATE_LIQUIDITY_V3,\n              baseCurrencyId: currencyId(currency0),\n              quoteCurrencyId: currencyId(currency1),\n              isFork: isNotUniswap,\n            })\n            setPendingMigrationHash(response.hash)\n          })\n      })\n      .catch(() => {\n        setConfirmingMigration(false)\n      })\n  }, [\n    chainId,\n    isNotUniswap,\n    migrator,\n    noLiquidity,\n    blockTimestamp,\n    token0,\n    token1,\n    feeAmount,\n    pairBalance,\n    tickLower,\n    tickUpper,\n    sqrtPrice,\n    v3Amount0Min,\n    v3Amount1Min,\n    account,\n    deadline,\n    signatureData,\n    addTransaction,\n    pair,\n    currency0,\n    currency1,\n  ])\n\n  const isSuccessfullyMigrated = !!pendingMigrationHash && JSBI.equal(pairBalance.quotient, ZERO)\n\n  return (\n    <AutoColumn gap=\"20px\">\n      <ThemedText.Body my={9} style={{ fontWeight: 400 }}>\n        <Trans>\n          This tool will safely migrate your {isNotUniswap ? 'SushiSwap' : 'V2'} liquidity to V3. The process is\n          completely trustless thanks to the{' '}\n        </Trans>\n        {chainId && migrator && (\n          <ExternalLink href={getExplorerLink(chainId, migrator.address, ExplorerDataType.ADDRESS)}>\n            <ThemedText.Blue display=\"inline\">\n              <Trans>Uniswap migration contract↗</Trans>\n            </ThemedText.Blue>\n          </ExternalLink>\n        )}\n        .\n      </ThemedText.Body>\n\n      <LightCard>\n        <AutoColumn gap=\"lg\">\n          <RowBetween>\n            <RowFixed style={{ marginLeft: '8px' }}>\n              <DoubleCurrencyLogo currency0={currency0} currency1={currency1} margin={false} size={20} />\n              <ThemedText.MediumHeader style={{ marginLeft: '8px' }}>\n                <Trans>\n                  {currency0.symbol}/{currency1.symbol} LP Tokens\n                </Trans>\n              </ThemedText.MediumHeader>\n            </RowFixed>\n            <Badge variant={BadgeVariant.WARNING}>{isNotUniswap ? 'Sushi' : 'V2'}</Badge>\n          </RowBetween>\n          <LiquidityInfo token0Amount={token0Value} token1Amount={token1Value} />\n        </AutoColumn>\n      </LightCard>\n\n      <div style={{ display: 'flex', justifyContent: 'center' }}>\n        <ArrowDown size={24} />\n      </div>\n\n      <LightCard>\n        <AutoColumn gap=\"lg\">\n          <RowBetween>\n            <RowFixed style={{ marginLeft: '8px' }}>\n              <DoubleCurrencyLogo currency0={currency0} currency1={currency1} margin={false} size={20} />\n              <ThemedText.MediumHeader style={{ marginLeft: '8px' }}>\n                <Trans>\n                  {currency0.symbol}/{currency1.symbol} LP NFT\n                </Trans>\n              </ThemedText.MediumHeader>\n            </RowFixed>\n            <Badge variant={BadgeVariant.PRIMARY}>V3</Badge>\n          </RowBetween>\n\n          <FeeSelector feeAmount={feeAmount} handleFeePoolSelect={setFeeAmount} />\n          {noLiquidity && (\n            <BlueCard style={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n              <AlertCircle color={theme.text1} style={{ marginBottom: '12px', opacity: 0.8 }} />\n              <ThemedText.Body\n                fontSize={14}\n                style={{ marginBottom: 8, fontWeight: 500, opacity: 0.8 }}\n                textAlign=\"center\"\n              >\n                <Trans>\n                  You are the first liquidity provider for this Uniswap V3 pool. Your liquidity will migrate at the\n                  current {isNotUniswap ? 'SushiSwap' : 'V2'} price.\n                </Trans>\n              </ThemedText.Body>\n\n              <ThemedText.Body\n                fontWeight={500}\n                textAlign=\"center\"\n                fontSize={14}\n                style={{ marginTop: '8px', opacity: 0.8 }}\n              >\n                <Trans>Your transaction cost will be much higher as it includes the gas to create the pool.</Trans>\n              </ThemedText.Body>\n\n              {v2SpotPrice && (\n                <AutoColumn gap=\"8px\" style={{ marginTop: '12px' }}>\n                  <RowBetween>\n                    <ThemedText.Body fontWeight={500} fontSize={14}>\n                      <Trans>\n                        {isNotUniswap ? 'SushiSwap' : 'V2'} {invertPrice ? currency1.symbol : currency0.symbol} Price:\n                      </Trans>{' '}\n                      {invertPrice\n                        ? `${v2SpotPrice?.invert()?.toSignificant(6)} ${currency0.symbol}`\n                        : `${v2SpotPrice?.toSignificant(6)} ${currency1.symbol}`}\n                    </ThemedText.Body>\n                  </RowBetween>\n                </AutoColumn>\n              )}\n            </BlueCard>\n          )}\n\n          {largePriceDifference ? (\n            <YellowCard>\n              <AutoColumn gap=\"8px\">\n                <RowBetween>\n                  <ThemedText.Body fontSize={14}>\n                    <Trans>\n                      {isNotUniswap ? 'SushiSwap' : 'V2'} {invertPrice ? currency1.symbol : currency0.symbol} Price:\n                    </Trans>\n                  </ThemedText.Body>\n                  <ThemedText.Black fontSize={14}>\n                    {invertPrice\n                      ? `${v2SpotPrice?.invert()?.toSignificant(6)} ${currency0.symbol}`\n                      : `${v2SpotPrice?.toSignificant(6)} ${currency1.symbol}`}\n                  </ThemedText.Black>\n                </RowBetween>\n\n                <RowBetween>\n                  <ThemedText.Body fontSize={14}>\n                    <Trans>V3 {invertPrice ? currency1.symbol : currency0.symbol} Price:</Trans>\n                  </ThemedText.Body>\n                  <ThemedText.Black fontSize={14}>\n                    {invertPrice\n                      ? `${v3SpotPrice?.invert()?.toSignificant(6)} ${currency0.symbol}`\n                      : `${v3SpotPrice?.toSignificant(6)} ${currency1.symbol}`}\n                  </ThemedText.Black>\n                </RowBetween>\n\n                <RowBetween>\n                  <ThemedText.Body fontSize={14} color=\"inherit\">\n                    <Trans>Price Difference:</Trans>\n                  </ThemedText.Body>\n                  <ThemedText.Black fontSize={14} color=\"inherit\">\n                    <Trans>{priceDifferenceFraction?.toSignificant(4)}%</Trans>\n                  </ThemedText.Black>\n                </RowBetween>\n              </AutoColumn>\n              <ThemedText.Body fontSize={14} style={{ marginTop: 8, fontWeight: 400 }}>\n                <Trans>\n                  You should only deposit liquidity into Uniswap V3 at a price you believe is correct. <br />\n                  If the price seems incorrect, you can either make a swap to move the price or wait for someone else to\n                  do so.\n                </Trans>\n              </ThemedText.Body>\n            </YellowCard>\n          ) : !noLiquidity && v3SpotPrice ? (\n            <RowBetween>\n              <ThemedText.Body fontSize={14}>\n                <Trans>V3 {invertPrice ? currency1.symbol : currency0.symbol} Price:</Trans>\n              </ThemedText.Body>\n              <ThemedText.Black fontSize={14}>\n                {invertPrice\n                  ? `${v3SpotPrice?.invert()?.toSignificant(6)} ${currency0.symbol}`\n                  : `${v3SpotPrice?.toSignificant(6)} ${currency1.symbol}`}\n              </ThemedText.Black>\n            </RowBetween>\n          ) : null}\n\n          <RowBetween>\n            <ThemedText.Label>\n              <Trans>Set Price Range</Trans>\n            </ThemedText.Label>\n            <RateToggle\n              currencyA={invertPrice ? currency1 : currency0}\n              currencyB={invertPrice ? currency0 : currency1}\n              handleRateToggle={() => {\n                onLeftRangeInput('')\n                onRightRangeInput('')\n                setBaseToken((base) => (base.equals(token0) ? token1 : token0))\n              }}\n            />\n          </RowBetween>\n\n          <RangeSelector\n            priceLower={priceLower}\n            priceUpper={priceUpper}\n            getDecrementLower={getDecrementLower}\n            getIncrementLower={getIncrementLower}\n            getDecrementUpper={getDecrementUpper}\n            getIncrementUpper={getIncrementUpper}\n            onLeftRangeInput={onLeftRangeInput}\n            onRightRangeInput={onRightRangeInput}\n            currencyA={invertPrice ? currency1 : currency0}\n            currencyB={invertPrice ? currency0 : currency1}\n            feeAmount={feeAmount}\n            ticksAtLimit={ticksAtLimit}\n          />\n\n          {outOfRange ? (\n            <YellowCard padding=\"8px 12px\" $borderRadius=\"12px\">\n              <RowBetween>\n                <AlertTriangle stroke={theme.yellow3} size=\"16px\" />\n                <ThemedText.Yellow ml=\"12px\" fontSize=\"12px\">\n                  <Trans>\n                    Your position will not earn fees or be used in trades until the market price moves into your range.\n                  </Trans>\n                </ThemedText.Yellow>\n              </RowBetween>\n            </YellowCard>\n          ) : null}\n\n          {invalidRange ? (\n            <YellowCard padding=\"8px 12px\" $borderRadius=\"12px\">\n              <RowBetween>\n                <AlertTriangle stroke={theme.yellow3} size=\"16px\" />\n                <ThemedText.Yellow ml=\"12px\" fontSize=\"12px\">\n                  <Trans>Invalid range selected. The min price must be lower than the max price.</Trans>\n                </ThemedText.Yellow>\n              </RowBetween>\n            </YellowCard>\n          ) : null}\n\n          {position ? (\n            <DarkGreyCard>\n              <AutoColumn gap=\"md\">\n                <LiquidityInfo token0Amount={position.amount0} token1Amount={position.amount1} />\n                {chainId && refund0 && refund1 ? (\n                  <ThemedText.Black fontSize={12}>\n                    <Trans>\n                      At least {formatCurrencyAmount(refund0, 4)}{' '}\n                      {token0.equals(WRAPPED_NATIVE_CURRENCY[chainId]) ? 'ETH' : token0.symbol} and{' '}\n                      {formatCurrencyAmount(refund1, 4)}{' '}\n                      {token1.equals(WRAPPED_NATIVE_CURRENCY[chainId]) ? 'ETH' : token1.symbol} will be refunded to your\n                      wallet due to selected price range.\n                    </Trans>\n                  </ThemedText.Black>\n                ) : null}\n              </AutoColumn>\n            </DarkGreyCard>\n          ) : null}\n\n          <AutoColumn gap=\"12px\">\n            {!isSuccessfullyMigrated && !isMigrationPending ? (\n              <AutoColumn gap=\"12px\" style={{ flex: '1' }}>\n                <ButtonConfirmed\n                  confirmed={approval === ApprovalState.APPROVED || signatureData !== null}\n                  disabled={\n                    approval !== ApprovalState.NOT_APPROVED ||\n                    signatureData !== null ||\n                    !v3Amount0Min ||\n                    !v3Amount1Min ||\n                    invalidRange ||\n                    confirmingMigration\n                  }\n                  onClick={approve}\n                >\n                  {approval === ApprovalState.PENDING ? (\n                    <Dots>\n                      <Trans>Approving</Trans>\n                    </Dots>\n                  ) : approval === ApprovalState.APPROVED || signatureData !== null ? (\n                    <Trans>Allowed</Trans>\n                  ) : (\n                    <Trans>Allow LP token migration</Trans>\n                  )}\n                </ButtonConfirmed>\n              </AutoColumn>\n            ) : null}\n            <AutoColumn gap=\"12px\" style={{ flex: '1' }}>\n              <ButtonConfirmed\n                confirmed={isSuccessfullyMigrated}\n                disabled={\n                  !v3Amount0Min ||\n                  !v3Amount1Min ||\n                  invalidRange ||\n                  (approval !== ApprovalState.APPROVED && signatureData === null) ||\n                  confirmingMigration ||\n                  isMigrationPending ||\n                  isSuccessfullyMigrated\n                }\n                onClick={migrate}\n              >\n                {isSuccessfullyMigrated ? (\n                  'Success!'\n                ) : isMigrationPending ? (\n                  <Dots>\n                    <Trans>Migrating</Trans>\n                  </Dots>\n                ) : (\n                  <Trans>Migrate</Trans>\n                )}\n              </ButtonConfirmed>\n            </AutoColumn>\n          </AutoColumn>\n        </AutoColumn>\n      </LightCard>\n    </AutoColumn>\n  )\n}\n\nexport default function MigrateV2Pair({\n  match: {\n    params: { address },\n  },\n}: RouteComponentProps<{ address: string }>) {\n  // reset mint state on component mount, and as a cleanup (on unmount)\n  const dispatch = useAppDispatch()\n  useEffect(() => {\n    dispatch(resetMintState())\n    return () => {\n      dispatch(resetMintState())\n    }\n  }, [dispatch])\n\n  const { chainId, account } = useActiveWeb3React()\n\n  // get pair contract\n  const validatedAddress = isAddress(address)\n  const pair = usePairContract(validatedAddress ? validatedAddress : undefined)\n\n  // get token addresses from pair contract\n  const token0AddressCallState = useSingleCallResult(pair, 'token0', undefined, NEVER_RELOAD)\n  const token0Address = token0AddressCallState?.result?.[0]\n  const token1Address = useSingleCallResult(pair, 'token1', undefined, NEVER_RELOAD)?.result?.[0]\n\n  // get tokens\n  const token0 = useToken(token0Address)\n  const token1 = useToken(token1Address)\n\n  // get liquidity token balance\n  const liquidityToken: Token | undefined = useMemo(\n    () => (chainId && validatedAddress ? new Token(chainId, validatedAddress, 18) : undefined),\n    [chainId, validatedAddress]\n  )\n\n  // get data required for V2 pair migration\n  const pairBalance = useTokenBalance(account ?? undefined, liquidityToken)\n  const totalSupply = useTotalSupply(liquidityToken)\n  const [reserve0Raw, reserve1Raw] = useSingleCallResult(pair, 'getReserves')?.result ?? []\n  const reserve0 = useMemo(\n    () => (token0 && reserve0Raw ? CurrencyAmount.fromRawAmount(token0, reserve0Raw) : undefined),\n    [token0, reserve0Raw]\n  )\n  const reserve1 = useMemo(\n    () => (token1 && reserve1Raw ? CurrencyAmount.fromRawAmount(token1, reserve1Raw) : undefined),\n    [token1, reserve1Raw]\n  )\n\n  // redirect for invalid url params\n  if (\n    !validatedAddress ||\n    !pair ||\n    (pair &&\n      token0AddressCallState?.valid &&\n      !token0AddressCallState?.loading &&\n      !token0AddressCallState?.error &&\n      !token0Address)\n  ) {\n    console.error('Invalid pair address')\n    return <Redirect to=\"/migrate/v2\" />\n  }\n\n  return (\n    <BodyWrapper style={{ padding: 24 }}>\n      <AutoColumn gap=\"16px\">\n        <AutoRow style={{ alignItems: 'center', justifyContent: 'space-between' }} gap=\"8px\">\n          <BackArrow to=\"/migrate/v2\" />\n          <ThemedText.MediumHeader>\n            <Trans>Migrate V2 Liquidity</Trans>\n          </ThemedText.MediumHeader>\n          <SettingsTab placeholderSlippage={DEFAULT_MIGRATE_SLIPPAGE_TOLERANCE} />\n        </AutoRow>\n\n        {!account ? (\n          <ThemedText.LargeHeader>\n            <Trans>You must connect an account.</Trans>\n          </ThemedText.LargeHeader>\n        ) : pairBalance && totalSupply && reserve0 && reserve1 && token0 && token1 ? (\n          <V2PairMigration\n            pair={pair}\n            pairBalance={pairBalance}\n            totalSupply={totalSupply}\n            reserve0={reserve0}\n            reserve1={reserve1}\n            token0={token0}\n            token1={token1}\n          />\n        ) : (\n          <EmptyState message={<Trans>Loading</Trans>} />\n        )}\n      </AutoColumn>\n    </BodyWrapper>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}