{"ast":null,"code":"import _slicedToArray from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import{keyframes as _keyframes}from\"styled-components\";import _styled from\"styled-components\";var _templateObject,_templateObject2;import{Trans}from\"@lingui/react\";import{RowFixed}from'components/Row';import{CHAIN_INFO}from'constants/chains';import useCurrentBlockTimestamp from'hooks/useCurrentBlockTimestamp';import useGasPrice from'hooks/useGasPrice';import useMachineTimeMs from'hooks/useMachineTime';import useTheme from'hooks/useTheme';import{useActiveWeb3React}from'hooks/web3';import JSBI from'jsbi';import{useEffect,useState}from'react';import{useBlockNumber}from'state/application/hooks';import{ExternalLink,ThemedText}from'theme';import{ExplorerDataType,getExplorerLink}from'utils/getExplorerLink';import{MouseoverTooltip}from'../Tooltip';import{ChainConnectivityWarning}from'./ChainConnectivityWarning';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var StyledPolling=_styled.div.withConfig({componentId:\"sc-123dig8-0\"})([\"position:fixed;display:flex;align-items:center;right:0;bottom:0;padding:1rem;color:\",\";transition:250ms ease color;\",\"\"],function(_ref){var theme=_ref.theme,warning=_ref.warning;return warning?theme.yellow3:theme.green1;},function(_ref2){var theme=_ref2.theme;return theme.mediaWidth.upToMedium(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    display: none;\\n  \"])));});var StyledPollingNumber=_styled(ThemedText.Small).withConfig({componentId:\"sc-123dig8-1\"})([\"transition:opacity 0.25s ease;opacity:\",\";:hover{opacity:1;}a{color:unset;}a:hover{text-decoration:none;color:unset;}\"],function(_ref3){var breathe=_ref3.breathe,hovering=_ref3.hovering;return hovering?0.7:breathe?1:0.5;});var StyledPollingDot=_styled.div.withConfig({componentId:\"sc-123dig8-2\"})([\"width:8px;height:8px;min-height:8px;min-width:8px;border-radius:50%;position:relative;background-color:\",\";transition:250ms ease background-color;\"],function(_ref4){var theme=_ref4.theme,warning=_ref4.warning;return warning?theme.yellow3:theme.green1;});var StyledGasDot=_styled.div.withConfig({componentId:\"sc-123dig8-3\"})([\"background-color:\",\";border-radius:50%;height:4px;min-height:4px;min-width:4px;position:relative;transition:250ms ease background-color;width:4px;\"],function(_ref5){var theme=_ref5.theme;return theme.text3;});var rotate360=_keyframes(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  from {\\n    transform: rotate(0deg);\\n  }\\n  to {\\n    transform: rotate(360deg);\\n  }\\n\"])));var Spinner=_styled.div.withConfig({componentId:\"sc-123dig8-4\"})([\"animation:\",\" 1s cubic-bezier(0.83,0,0.17,1) infinite;transform:translateZ(0);border-top:1px solid transparent;border-right:1px solid transparent;border-bottom:1px solid transparent;border-left:2px solid \",\";background:transparent;width:14px;height:14px;border-radius:50%;position:relative;transition:250ms ease border-color;left:-3px;top:-3px;\"],rotate360,function(_ref6){var theme=_ref6.theme,warning=_ref6.warning;return warning?theme.yellow3:theme.green1;});var DEFAULT_MS_BEFORE_WARNING=600000;var NETWORK_HEALTH_CHECK_MS=10000;export default function Polling(){var _ref7,_CHAIN_INFO$chainId;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId;var blockNumber=useBlockNumber();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isMounting=_useState2[0],setIsMounting=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isHover=_useState4[0],setIsHover=_useState4[1];var machineTime=useMachineTimeMs(NETWORK_HEALTH_CHECK_MS);var blockTime=useCurrentBlockTimestamp();var theme=useTheme();var ethGasPrice=useGasPrice();var priceGwei=ethGasPrice?JSBI.divide(ethGasPrice,JSBI.BigInt(1000000000)):undefined;var waitMsBeforeWarning=(_ref7=chainId?(_CHAIN_INFO$chainId=CHAIN_INFO[chainId])===null||_CHAIN_INFO$chainId===void 0?void 0:_CHAIN_INFO$chainId.blockWaitMsBeforeWarning:DEFAULT_MS_BEFORE_WARNING)!==null&&_ref7!==void 0?_ref7:DEFAULT_MS_BEFORE_WARNING;var warning=Boolean(!!blockTime&&machineTime-blockTime.mul(1000).toNumber()>waitMsBeforeWarning);useEffect(function(){if(!blockNumber){return;}setIsMounting(true);var mountingTimer=setTimeout(function(){return setIsMounting(false);},1000);// this will clear Timeout when component unmount like in willComponentUnmount\nreturn function(){clearTimeout(mountingTimer);};},[blockNumber]//useEffect will run only one time\n//if you pass a value to array, like this [data] than clearTimeout will run every time this value changes (useEffect re-run)\n);//TODO - chainlink gas oracle is really slow. Can we get a better data source?\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsxs(StyledPolling,{onMouseEnter:function onMouseEnter(){return setIsHover(true);},onMouseLeave:function onMouseLeave(){return setIsHover(false);},warning:warning,children:[/*#__PURE__*/_jsx(ExternalLink,{href:'https://etherscan.io/gastracker',children:priceGwei?/*#__PURE__*/_jsxs(RowFixed,{style:{marginRight:'8px'},children:[/*#__PURE__*/_jsx(ThemedText.Main,{fontSize:\"11px\",mr:\"8px\",color:theme.text3,children:/*#__PURE__*/_jsxs(MouseoverTooltip,{text:/*#__PURE__*/_jsx(Trans,{id:\"The current fast gas amount for sending a transaction on L1. Gas fees are paid in Ethereum's native currency Ether (ETH) and denominated in GWEI.\"}),children:[priceGwei.toString(),\" \",/*#__PURE__*/_jsx(Trans,{id:\"gwei\"})]})}),/*#__PURE__*/_jsx(StyledGasDot,{})]}):null}),/*#__PURE__*/_jsx(StyledPollingNumber,{breathe:isMounting,hovering:isHover,children:/*#__PURE__*/_jsx(ExternalLink,{href:chainId&&blockNumber?getExplorerLink(chainId,blockNumber.toString(),ExplorerDataType.BLOCK):'',children:/*#__PURE__*/_jsxs(MouseoverTooltip,{text:/*#__PURE__*/_jsx(Trans,{id:\"The most recent block number on this network. Prices update on every block.\"}),children:[blockNumber,\"\\u2002\"]})})}),/*#__PURE__*/_jsx(StyledPollingDot,{warning:warning,children:isMounting&&/*#__PURE__*/_jsx(Spinner,{warning:warning})}),' ']}),warning&&/*#__PURE__*/_jsx(ChainConnectivityWarning,{})]})});}","map":{"version":3,"sources":["/Users/safahi/Downloads/interface-4.30.1/src/components/Header/Polling.tsx"],"names":["RowFixed","CHAIN_INFO","useCurrentBlockTimestamp","useGasPrice","useMachineTimeMs","useTheme","useActiveWeb3React","JSBI","useEffect","useState","useBlockNumber","ExternalLink","ThemedText","ExplorerDataType","getExplorerLink","MouseoverTooltip","ChainConnectivityWarning","StyledPolling","styled","div","theme","warning","yellow3","green1","mediaWidth","upToMedium","StyledPollingNumber","Small","breathe","hovering","StyledPollingDot","StyledGasDot","text3","rotate360","keyframes","Spinner","DEFAULT_MS_BEFORE_WARNING","NETWORK_HEALTH_CHECK_MS","Polling","chainId","blockNumber","isMounting","setIsMounting","isHover","setIsHover","machineTime","blockTime","ethGasPrice","priceGwei","divide","BigInt","undefined","waitMsBeforeWarning","blockWaitMsBeforeWarning","Boolean","mul","toNumber","mountingTimer","setTimeout","clearTimeout","marginRight","toString","BLOCK"],"mappings":"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","sourcesContent":["import { Trans } from '@lingui/macro'\nimport { RowFixed } from 'components/Row'\nimport { CHAIN_INFO } from 'constants/chains'\nimport useCurrentBlockTimestamp from 'hooks/useCurrentBlockTimestamp'\nimport useGasPrice from 'hooks/useGasPrice'\nimport useMachineTimeMs from 'hooks/useMachineTime'\nimport useTheme from 'hooks/useTheme'\nimport { useActiveWeb3React } from 'hooks/web3'\nimport JSBI from 'jsbi'\nimport ms from 'ms.macro'\nimport { useEffect, useState } from 'react'\nimport { useBlockNumber } from 'state/application/hooks'\nimport styled, { keyframes } from 'styled-components/macro'\nimport { ExternalLink, ThemedText } from 'theme'\nimport { ExplorerDataType, getExplorerLink } from 'utils/getExplorerLink'\n\nimport { MouseoverTooltip } from '../Tooltip'\nimport { ChainConnectivityWarning } from './ChainConnectivityWarning'\n\nconst StyledPolling = styled.div<{ warning: boolean }>`\n  position: fixed;\n  display: flex;\n  align-items: center;\n  right: 0;\n  bottom: 0;\n  padding: 1rem;\n  color: ${({ theme, warning }) => (warning ? theme.yellow3 : theme.green1)};\n  transition: 250ms ease color;\n\n  ${({ theme }) => theme.mediaWidth.upToMedium`\n    display: none;\n  `}\n`\nconst StyledPollingNumber = styled(ThemedText.Small)<{ breathe: boolean; hovering: boolean }>`\n  transition: opacity 0.25s ease;\n  opacity: ${({ breathe, hovering }) => (hovering ? 0.7 : breathe ? 1 : 0.5)};\n  :hover {\n    opacity: 1;\n  }\n\n  a {\n    color: unset;\n  }\n  a:hover {\n    text-decoration: none;\n    color: unset;\n  }\n`\nconst StyledPollingDot = styled.div<{ warning: boolean }>`\n  width: 8px;\n  height: 8px;\n  min-height: 8px;\n  min-width: 8px;\n  border-radius: 50%;\n  position: relative;\n  background-color: ${({ theme, warning }) => (warning ? theme.yellow3 : theme.green1)};\n  transition: 250ms ease background-color;\n`\n\nconst StyledGasDot = styled.div`\n  background-color: ${({ theme }) => theme.text3};\n  border-radius: 50%;\n  height: 4px;\n  min-height: 4px;\n  min-width: 4px;\n  position: relative;\n  transition: 250ms ease background-color;\n  width: 4px;\n`\n\nconst rotate360 = keyframes`\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n`\n\nconst Spinner = styled.div<{ warning: boolean }>`\n  animation: ${rotate360} 1s cubic-bezier(0.83, 0, 0.17, 1) infinite;\n  transform: translateZ(0);\n\n  border-top: 1px solid transparent;\n  border-right: 1px solid transparent;\n  border-bottom: 1px solid transparent;\n  border-left: 2px solid ${({ theme, warning }) => (warning ? theme.yellow3 : theme.green1)};\n  background: transparent;\n  width: 14px;\n  height: 14px;\n  border-radius: 50%;\n  position: relative;\n  transition: 250ms ease border-color;\n\n  left: -3px;\n  top: -3px;\n`\n\nconst DEFAULT_MS_BEFORE_WARNING = ms`10m`\nconst NETWORK_HEALTH_CHECK_MS = ms`10s`\n\nexport default function Polling() {\n  const { chainId } = useActiveWeb3React()\n  const blockNumber = useBlockNumber()\n  const [isMounting, setIsMounting] = useState(false)\n  const [isHover, setIsHover] = useState(false)\n  const machineTime = useMachineTimeMs(NETWORK_HEALTH_CHECK_MS)\n  const blockTime = useCurrentBlockTimestamp()\n  const theme = useTheme()\n\n  const ethGasPrice = useGasPrice()\n  const priceGwei = ethGasPrice ? JSBI.divide(ethGasPrice, JSBI.BigInt(1000000000)) : undefined\n\n  const waitMsBeforeWarning =\n    (chainId ? CHAIN_INFO[chainId]?.blockWaitMsBeforeWarning : DEFAULT_MS_BEFORE_WARNING) ?? DEFAULT_MS_BEFORE_WARNING\n\n  const warning = Boolean(!!blockTime && machineTime - blockTime.mul(1000).toNumber() > waitMsBeforeWarning)\n\n  useEffect(\n    () => {\n      if (!blockNumber) {\n        return\n      }\n\n      setIsMounting(true)\n      const mountingTimer = setTimeout(() => setIsMounting(false), 1000)\n\n      // this will clear Timeout when component unmount like in willComponentUnmount\n      return () => {\n        clearTimeout(mountingTimer)\n      }\n    },\n    [blockNumber] //useEffect will run only one time\n    //if you pass a value to array, like this [data] than clearTimeout will run every time this value changes (useEffect re-run)\n  )\n\n  //TODO - chainlink gas oracle is really slow. Can we get a better data source?\n\n  return (\n    <>\n      <RowFixed>\n        <StyledPolling onMouseEnter={() => setIsHover(true)} onMouseLeave={() => setIsHover(false)} warning={warning}>\n          <ExternalLink href={'https://etherscan.io/gastracker'}>\n            {priceGwei ? (\n              <RowFixed style={{ marginRight: '8px' }}>\n                <ThemedText.Main fontSize=\"11px\" mr=\"8px\" color={theme.text3}>\n                  <MouseoverTooltip\n                    text={\n                      <Trans>\n                        The current fast gas amount for sending a transaction on L1. Gas fees are paid in\n                        Ethereum&apos;s native currency Ether (ETH) and denominated in GWEI.\n                      </Trans>\n                    }\n                  >\n                    {priceGwei.toString()} <Trans>gwei</Trans>\n                  </MouseoverTooltip>\n                </ThemedText.Main>\n                <StyledGasDot />\n              </RowFixed>\n            ) : null}\n          </ExternalLink>\n          <StyledPollingNumber breathe={isMounting} hovering={isHover}>\n            <ExternalLink\n              href={\n                chainId && blockNumber ? getExplorerLink(chainId, blockNumber.toString(), ExplorerDataType.BLOCK) : ''\n              }\n            >\n              <MouseoverTooltip\n                text={<Trans>The most recent block number on this network. Prices update on every block.</Trans>}\n              >\n                {blockNumber}&ensp;\n              </MouseoverTooltip>\n            </ExternalLink>\n          </StyledPollingNumber>\n          <StyledPollingDot warning={warning}>{isMounting && <Spinner warning={warning} />}</StyledPollingDot>{' '}\n        </StyledPolling>\n        {warning && <ChainConnectivityWarning />}\n      </RowFixed>\n    </>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}