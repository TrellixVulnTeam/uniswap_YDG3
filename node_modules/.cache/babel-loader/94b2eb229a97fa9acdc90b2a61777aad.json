{"ast":null,"code":"import _regeneratorRuntime from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _styled from\"styled-components\";import{Trans}from\"@lingui/react\";import{isAddress}from'@ethersproject/address';import{useState}from'react';import{X}from'react-feather';import{formatCurrencyAmount}from'utils/formatCurrencyAmount';import{UNI}from'../../constants/tokens';import useENS from'../../hooks/useENS';import{useActiveWeb3React}from'../../hooks/web3';import{useDelegateCallback}from'../../state/governance/hooks';import{useTokenBalance}from'../../state/wallet/hooks';import{ThemedText}from'../../theme';import AddressInputPanel from'../AddressInputPanel';import{ButtonPrimary}from'../Button';import{AutoColumn}from'../Column';import Modal from'../Modal';import{LoadingView,SubmittedView}from'../ModalViews';import{RowBetween}from'../Row';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ContentWrapper=_styled(AutoColumn).withConfig({componentId:\"sc-1t2p2c9-0\"})([\"width:100%;padding:24px;\"]);var StyledClosed=_styled(X).withConfig({componentId:\"sc-1t2p2c9-1\"})([\":hover{cursor:pointer;}\"]);var TextButton=_styled.div.withConfig({componentId:\"sc-1t2p2c9-2\"})([\":hover{cursor:pointer;}\"]);export default function DelegateModal(_ref){var isOpen=_ref.isOpen,onDismiss=_ref.onDismiss,title=_ref.title;var _useActiveWeb3React=useActiveWeb3React(),account=_useActiveWeb3React.account,chainId=_useActiveWeb3React.chainId;// state for delegate input\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),usingDelegate=_useState2[0],setUsingDelegate=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),typed=_useState4[0],setTyped=_useState4[1];function handleRecipientType(val){setTyped(val);}// monitor for self delegation or input for third part delegate\n// default is self delegation\nvar activeDelegate=usingDelegate?typed:account;var _useENS=useENS(activeDelegate),parsedAddress=_useENS.address;// get the number of votes available to delegate\nvar uniBalance=useTokenBalance(account!==null&&account!==void 0?account:undefined,chainId?UNI[chainId]:undefined);var delegateCallback=useDelegateCallback();// monitor call to help UI loading state\nvar _useState5=useState(),_useState6=_slicedToArray(_useState5,2),hash=_useState6[0],setHash=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),attempting=_useState8[0],setAttempting=_useState8[1];// wrapper to reset state on modal close\nfunction wrappedOndismiss(){setHash(undefined);setAttempting(false);onDismiss();}function onDelegate(){return _onDelegate.apply(this,arguments);}function _onDelegate(){_onDelegate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _delegateCallback;var hash;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setAttempting(true);// if callback not returned properly ignore\nif(delegateCallback){_context.next=3;break;}return _context.abrupt(\"return\");case 3:_context.next=5;return(_delegateCallback=delegateCallback(parsedAddress!==null&&parsedAddress!==void 0?parsedAddress:undefined))===null||_delegateCallback===void 0?void 0:_delegateCallback.catch(function(error){setAttempting(false);console.log(error);});case 5:hash=_context.sent;if(hash){setHash(hash);}case 7:case\"end\":return _context.stop();}}},_callee);}));return _onDelegate.apply(this,arguments);}return/*#__PURE__*/_jsxs(Modal,{isOpen:isOpen,onDismiss:wrappedOndismiss,maxHeight:90,children:[!attempting&&!hash&&/*#__PURE__*/_jsx(ContentWrapper,{gap:\"lg\",children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"lg\",justify:\"center\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(ThemedText.MediumHeader,{fontWeight:500,children:title}),/*#__PURE__*/_jsx(StyledClosed,{stroke:\"black\",onClick:wrappedOndismiss})]}),/*#__PURE__*/_jsx(ThemedText.Body,{children:/*#__PURE__*/_jsx(Trans,{id:\"Earned UNI tokens represent voting shares in Uniswap governance.\"})}),/*#__PURE__*/_jsx(ThemedText.Body,{children:/*#__PURE__*/_jsx(Trans,{id:\"You can either vote on each proposal yourself or delegate your votes to a third party.\"})}),usingDelegate&&/*#__PURE__*/_jsx(AddressInputPanel,{value:typed,onChange:handleRecipientType}),/*#__PURE__*/_jsx(ButtonPrimary,{disabled:!isAddress(parsedAddress!==null&&parsedAddress!==void 0?parsedAddress:''),onClick:onDelegate,children:/*#__PURE__*/_jsx(ThemedText.MediumHeader,{color:\"white\",children:usingDelegate?/*#__PURE__*/_jsx(Trans,{id:\"Delegate Votes\"}):/*#__PURE__*/_jsx(Trans,{id:\"Self Delegate\"})})}),/*#__PURE__*/_jsx(TextButton,{onClick:function onClick(){return setUsingDelegate(!usingDelegate);},children:/*#__PURE__*/_jsx(ThemedText.Blue,{children:usingDelegate?/*#__PURE__*/_jsx(Trans,{id:\"Remove Delegate\"}):/*#__PURE__*/_jsx(Trans,{id:\"Add Delegate +\"})})})]})}),attempting&&!hash&&/*#__PURE__*/_jsx(LoadingView,{onDismiss:wrappedOndismiss,children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"12px\",justify:'center',children:[/*#__PURE__*/_jsx(ThemedText.LargeHeader,{children:usingDelegate?/*#__PURE__*/_jsx(Trans,{id:\"Delegating votes\"}):/*#__PURE__*/_jsx(Trans,{id:\"Unlocking Votes\"})}),/*#__PURE__*/_jsxs(ThemedText.Main,{fontSize:36,children:[\" \",formatCurrencyAmount(uniBalance,4)]})]})}),hash&&/*#__PURE__*/_jsx(SubmittedView,{onDismiss:wrappedOndismiss,hash:hash,children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"12px\",justify:'center',children:[/*#__PURE__*/_jsx(ThemedText.LargeHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Transaction Submitted\"})}),/*#__PURE__*/_jsx(ThemedText.Main,{fontSize:36,children:formatCurrencyAmount(uniBalance,4)})]})})]});}","map":{"version":3,"sources":["/Users/safahi/Downloads/interface-4.30.1/src/components/vote/DelegateModal.tsx"],"names":["isAddress","useState","X","formatCurrencyAmount","UNI","useENS","useActiveWeb3React","useDelegateCallback","useTokenBalance","ThemedText","AddressInputPanel","ButtonPrimary","AutoColumn","Modal","LoadingView","SubmittedView","RowBetween","ContentWrapper","styled","StyledClosed","TextButton","div","DelegateModal","isOpen","onDismiss","title","account","chainId","usingDelegate","setUsingDelegate","typed","setTyped","handleRecipientType","val","activeDelegate","parsedAddress","address","uniBalance","undefined","delegateCallback","hash","setHash","attempting","setAttempting","wrappedOndismiss","onDelegate","catch","error","console","log"],"mappings":"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","sourcesContent":["import { isAddress } from '@ethersproject/address'\nimport { Trans } from '@lingui/macro'\nimport { ReactNode, useState } from 'react'\nimport { X } from 'react-feather'\nimport styled from 'styled-components/macro'\nimport { formatCurrencyAmount } from 'utils/formatCurrencyAmount'\n\nimport { UNI } from '../../constants/tokens'\nimport useENS from '../../hooks/useENS'\nimport { useActiveWeb3React } from '../../hooks/web3'\nimport { useDelegateCallback } from '../../state/governance/hooks'\nimport { useTokenBalance } from '../../state/wallet/hooks'\nimport { ThemedText } from '../../theme'\nimport AddressInputPanel from '../AddressInputPanel'\nimport { ButtonPrimary } from '../Button'\nimport { AutoColumn } from '../Column'\nimport Modal from '../Modal'\nimport { LoadingView, SubmittedView } from '../ModalViews'\nimport { RowBetween } from '../Row'\n\nconst ContentWrapper = styled(AutoColumn)`\n  width: 100%;\n  padding: 24px;\n`\n\nconst StyledClosed = styled(X)`\n  :hover {\n    cursor: pointer;\n  }\n`\n\nconst TextButton = styled.div`\n  :hover {\n    cursor: pointer;\n  }\n`\n\ninterface VoteModalProps {\n  isOpen: boolean\n  onDismiss: () => void\n  title: ReactNode\n}\n\nexport default function DelegateModal({ isOpen, onDismiss, title }: VoteModalProps) {\n  const { account, chainId } = useActiveWeb3React()\n\n  // state for delegate input\n  const [usingDelegate, setUsingDelegate] = useState(false)\n  const [typed, setTyped] = useState('')\n  function handleRecipientType(val: string) {\n    setTyped(val)\n  }\n\n  // monitor for self delegation or input for third part delegate\n  // default is self delegation\n  const activeDelegate = usingDelegate ? typed : account\n  const { address: parsedAddress } = useENS(activeDelegate)\n\n  // get the number of votes available to delegate\n  const uniBalance = useTokenBalance(account ?? undefined, chainId ? UNI[chainId] : undefined)\n\n  const delegateCallback = useDelegateCallback()\n\n  // monitor call to help UI loading state\n  const [hash, setHash] = useState<string | undefined>()\n  const [attempting, setAttempting] = useState(false)\n\n  // wrapper to reset state on modal close\n  function wrappedOndismiss() {\n    setHash(undefined)\n    setAttempting(false)\n    onDismiss()\n  }\n\n  async function onDelegate() {\n    setAttempting(true)\n\n    // if callback not returned properly ignore\n    if (!delegateCallback) return\n\n    // try delegation and store hash\n    const hash = await delegateCallback(parsedAddress ?? undefined)?.catch((error) => {\n      setAttempting(false)\n      console.log(error)\n    })\n\n    if (hash) {\n      setHash(hash)\n    }\n  }\n\n  return (\n    <Modal isOpen={isOpen} onDismiss={wrappedOndismiss} maxHeight={90}>\n      {!attempting && !hash && (\n        <ContentWrapper gap=\"lg\">\n          <AutoColumn gap=\"lg\" justify=\"center\">\n            <RowBetween>\n              <ThemedText.MediumHeader fontWeight={500}>{title}</ThemedText.MediumHeader>\n              <StyledClosed stroke=\"black\" onClick={wrappedOndismiss} />\n            </RowBetween>\n            <ThemedText.Body>\n              <Trans>Earned UNI tokens represent voting shares in Uniswap governance.</Trans>\n            </ThemedText.Body>\n            <ThemedText.Body>\n              <Trans>You can either vote on each proposal yourself or delegate your votes to a third party.</Trans>\n            </ThemedText.Body>\n            {usingDelegate && <AddressInputPanel value={typed} onChange={handleRecipientType} />}\n            <ButtonPrimary disabled={!isAddress(parsedAddress ?? '')} onClick={onDelegate}>\n              <ThemedText.MediumHeader color=\"white\">\n                {usingDelegate ? <Trans>Delegate Votes</Trans> : <Trans>Self Delegate</Trans>}\n              </ThemedText.MediumHeader>\n            </ButtonPrimary>\n            <TextButton onClick={() => setUsingDelegate(!usingDelegate)}>\n              <ThemedText.Blue>\n                {usingDelegate ? <Trans>Remove Delegate</Trans> : <Trans>Add Delegate +</Trans>}\n              </ThemedText.Blue>\n            </TextButton>\n          </AutoColumn>\n        </ContentWrapper>\n      )}\n      {attempting && !hash && (\n        <LoadingView onDismiss={wrappedOndismiss}>\n          <AutoColumn gap=\"12px\" justify={'center'}>\n            <ThemedText.LargeHeader>\n              {usingDelegate ? <Trans>Delegating votes</Trans> : <Trans>Unlocking Votes</Trans>}\n            </ThemedText.LargeHeader>\n            <ThemedText.Main fontSize={36}> {formatCurrencyAmount(uniBalance, 4)}</ThemedText.Main>\n          </AutoColumn>\n        </LoadingView>\n      )}\n      {hash && (\n        <SubmittedView onDismiss={wrappedOndismiss} hash={hash}>\n          <AutoColumn gap=\"12px\" justify={'center'}>\n            <ThemedText.LargeHeader>\n              <Trans>Transaction Submitted</Trans>\n            </ThemedText.LargeHeader>\n            <ThemedText.Main fontSize={36}>{formatCurrencyAmount(uniBalance, 4)}</ThemedText.Main>\n          </AutoColumn>\n        </SubmittedView>\n      )}\n    </Modal>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}