{"ast":null,"code":"import _regeneratorRuntime from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{ThemeContext as _ThemeContext}from\"styled-components\";import _styled from\"styled-components\";import{Trans}from\"@lingui/react\";import{useContext,useState}from'react';import{ArrowUpCircle,X}from'react-feather';import{formatCurrencyAmount}from'utils/formatCurrencyAmount';import Circle from\"../../assets/images/blue-loader.svg\";import{useActiveWeb3React}from'../../hooks/web3';import{useUserVotes,useVoteCallback}from'../../state/governance/hooks';import{VoteOption}from'../../state/governance/types';import{CustomLightSpinner,ThemedText}from'../../theme';import{ExternalLink}from'../../theme';import{ExplorerDataType,getExplorerLink}from'../../utils/getExplorerLink';import{ButtonPrimary}from'../Button';import{AutoColumn,ColumnCenter}from'../Column';import Modal from'../Modal';import{RowBetween}from'../Row';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ContentWrapper=_styled(AutoColumn).withConfig({componentId:\"sc-km2t4x-0\"})([\"width:100%;padding:24px;\"]);var StyledClosed=_styled(X).withConfig({componentId:\"sc-km2t4x-1\"})([\":hover{cursor:pointer;}\"]);var ConfirmOrLoadingWrapper=_styled.div.withConfig({componentId:\"sc-km2t4x-2\"})([\"width:100%;padding:24px;\"]);var ConfirmedIcon=_styled(ColumnCenter).withConfig({componentId:\"sc-km2t4x-3\"})([\"padding:60px 0;\"]);export default function VoteModal(_ref){var isOpen=_ref.isOpen,onDismiss=_ref.onDismiss,proposalId=_ref.proposalId,voteOption=_ref.voteOption;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId;var _useVoteCallback=useVoteCallback(),voteCallback=_useVoteCallback.voteCallback;var _useUserVotes=useUserVotes(),availableVotes=_useUserVotes.votes;// monitor call to help UI loading state\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),hash=_useState2[0],setHash=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),attempting=_useState4[0],setAttempting=_useState4[1];// get theme for colors\nvar theme=useContext(_ThemeContext);// wrapper to reset state on modal close\nfunction wrappedOndismiss(){setHash(undefined);setAttempting(false);onDismiss();}function onVote(){return _onVote.apply(this,arguments);}function _onVote(){_onVote=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _voteCallback;var hash;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setAttempting(true);// if callback not returned properly ignore\nif(!(!voteCallback||voteOption===undefined)){_context.next=3;break;}return _context.abrupt(\"return\");case 3:_context.next=5;return(_voteCallback=voteCallback(proposalId,voteOption))===null||_voteCallback===void 0?void 0:_voteCallback.catch(function(error){setAttempting(false);console.log(error);});case 5:hash=_context.sent;if(hash){setHash(hash);}case 7:case\"end\":return _context.stop();}}},_callee);}));return _onVote.apply(this,arguments);}return/*#__PURE__*/_jsxs(Modal,{isOpen:isOpen,onDismiss:wrappedOndismiss,maxHeight:90,children:[!attempting&&!hash&&/*#__PURE__*/_jsx(ContentWrapper,{gap:\"lg\",children:/*#__PURE__*/_jsxs(AutoColumn,{gap:\"lg\",justify:\"center\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(ThemedText.MediumHeader,{fontWeight:500,children:voteOption===VoteOption.Against?/*#__PURE__*/_jsx(Trans,{id:\"Vote against proposal {proposalId}\",values:{proposalId:proposalId}}):voteOption===VoteOption.For?/*#__PURE__*/_jsx(Trans,{id:\"Vote for proposal {proposalId}\",values:{proposalId:proposalId}}):/*#__PURE__*/_jsx(Trans,{id:\"Vote to abstain on proposal {proposalId}\",values:{proposalId:proposalId}})}),/*#__PURE__*/_jsx(StyledClosed,{stroke:\"black\",onClick:wrappedOndismiss})]}),/*#__PURE__*/_jsx(ThemedText.LargeHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"{0} Votes\",values:{0:formatCurrencyAmount(availableVotes,4)}})}),/*#__PURE__*/_jsx(ButtonPrimary,{onClick:onVote,children:/*#__PURE__*/_jsx(ThemedText.MediumHeader,{color:\"white\",children:voteOption===VoteOption.Against?/*#__PURE__*/_jsx(Trans,{id:\"Vote against proposal {proposalId}\",values:{proposalId:proposalId}}):voteOption===VoteOption.For?/*#__PURE__*/_jsx(Trans,{id:\"Vote for proposal {proposalId}\",values:{proposalId:proposalId}}):/*#__PURE__*/_jsx(Trans,{id:\"Vote to abstain on proposal {proposalId}\",values:{proposalId:proposalId}})})})]})}),attempting&&!hash&&/*#__PURE__*/_jsxs(ConfirmOrLoadingWrapper,{children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(StyledClosed,{onClick:wrappedOndismiss})]}),/*#__PURE__*/_jsx(ConfirmedIcon,{children:/*#__PURE__*/_jsx(CustomLightSpinner,{src:Circle,alt:\"loader\",size:'90px'})}),/*#__PURE__*/_jsxs(AutoColumn,{gap:\"100px\",justify:'center',children:[/*#__PURE__*/_jsx(AutoColumn,{gap:\"12px\",justify:'center',children:/*#__PURE__*/_jsx(ThemedText.LargeHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Submitting Vote\"})})}),/*#__PURE__*/_jsx(ThemedText.SubHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Confirm this transaction in your wallet\"})})]})]}),hash&&/*#__PURE__*/_jsxs(ConfirmOrLoadingWrapper,{children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(StyledClosed,{onClick:wrappedOndismiss})]}),/*#__PURE__*/_jsx(ConfirmedIcon,{children:/*#__PURE__*/_jsx(ArrowUpCircle,{strokeWidth:0.5,size:90,color:theme.primary1})}),/*#__PURE__*/_jsxs(AutoColumn,{gap:\"100px\",justify:'center',children:[/*#__PURE__*/_jsx(AutoColumn,{gap:\"12px\",justify:'center',children:/*#__PURE__*/_jsx(ThemedText.LargeHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"Transaction Submitted\"})})}),chainId&&/*#__PURE__*/_jsx(ExternalLink,{href:getExplorerLink(chainId,hash,ExplorerDataType.TRANSACTION),style:{marginLeft:'4px'},children:/*#__PURE__*/_jsx(ThemedText.SubHeader,{children:/*#__PURE__*/_jsx(Trans,{id:\"View transaction on Explorer\"})})})]})]})]});}","map":{"version":3,"sources":["/Users/safahi/Downloads/interface-4.30.1/src/components/vote/VoteModal.tsx"],"names":["useContext","useState","ArrowUpCircle","X","formatCurrencyAmount","useActiveWeb3React","useUserVotes","useVoteCallback","VoteOption","CustomLightSpinner","ThemedText","ExternalLink","ExplorerDataType","getExplorerLink","ButtonPrimary","AutoColumn","ColumnCenter","Modal","RowBetween","ContentWrapper","styled","StyledClosed","ConfirmOrLoadingWrapper","div","ConfirmedIcon","VoteModal","isOpen","onDismiss","proposalId","voteOption","chainId","voteCallback","availableVotes","votes","hash","setHash","attempting","setAttempting","theme","ThemeContext","wrappedOndismiss","undefined","onVote","catch","error","console","log","Against","For","Circle","primary1","TRANSACTION","marginLeft"],"mappings":"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","sourcesContent":["import { Trans } from '@lingui/macro'\nimport { useContext, useState } from 'react'\nimport { ArrowUpCircle, X } from 'react-feather'\nimport styled, { ThemeContext } from 'styled-components/macro'\nimport { formatCurrencyAmount } from 'utils/formatCurrencyAmount'\n\nimport Circle from '../../assets/images/blue-loader.svg'\nimport { useActiveWeb3React } from '../../hooks/web3'\nimport { useUserVotes, useVoteCallback } from '../../state/governance/hooks'\nimport { VoteOption } from '../../state/governance/types'\nimport { CustomLightSpinner, ThemedText } from '../../theme'\nimport { ExternalLink } from '../../theme'\nimport { ExplorerDataType, getExplorerLink } from '../../utils/getExplorerLink'\nimport { ButtonPrimary } from '../Button'\nimport { AutoColumn, ColumnCenter } from '../Column'\nimport Modal from '../Modal'\nimport { RowBetween } from '../Row'\n\nconst ContentWrapper = styled(AutoColumn)`\n  width: 100%;\n  padding: 24px;\n`\n\nconst StyledClosed = styled(X)`\n  :hover {\n    cursor: pointer;\n  }\n`\n\nconst ConfirmOrLoadingWrapper = styled.div`\n  width: 100%;\n  padding: 24px;\n`\n\nconst ConfirmedIcon = styled(ColumnCenter)`\n  padding: 60px 0;\n`\n\ninterface VoteModalProps {\n  isOpen: boolean\n  onDismiss: () => void\n  voteOption: VoteOption | undefined\n  proposalId: string | undefined // id for the proposal to vote on\n}\n\nexport default function VoteModal({ isOpen, onDismiss, proposalId, voteOption }: VoteModalProps) {\n  const { chainId } = useActiveWeb3React()\n  const { voteCallback } = useVoteCallback()\n  const { votes: availableVotes } = useUserVotes()\n\n  // monitor call to help UI loading state\n  const [hash, setHash] = useState<string | undefined>()\n  const [attempting, setAttempting] = useState<boolean>(false)\n\n  // get theme for colors\n  const theme = useContext(ThemeContext)\n\n  // wrapper to reset state on modal close\n  function wrappedOndismiss() {\n    setHash(undefined)\n    setAttempting(false)\n    onDismiss()\n  }\n\n  async function onVote() {\n    setAttempting(true)\n\n    // if callback not returned properly ignore\n    if (!voteCallback || voteOption === undefined) return\n\n    // try delegation and store hash\n    const hash = await voteCallback(proposalId, voteOption)?.catch((error) => {\n      setAttempting(false)\n      console.log(error)\n    })\n\n    if (hash) {\n      setHash(hash)\n    }\n  }\n\n  return (\n    <Modal isOpen={isOpen} onDismiss={wrappedOndismiss} maxHeight={90}>\n      {!attempting && !hash && (\n        <ContentWrapper gap=\"lg\">\n          <AutoColumn gap=\"lg\" justify=\"center\">\n            <RowBetween>\n              <ThemedText.MediumHeader fontWeight={500}>\n                {voteOption === VoteOption.Against ? (\n                  <Trans>Vote against proposal {proposalId}</Trans>\n                ) : voteOption === VoteOption.For ? (\n                  <Trans>Vote for proposal {proposalId}</Trans>\n                ) : (\n                  <Trans>Vote to abstain on proposal {proposalId}</Trans>\n                )}\n              </ThemedText.MediumHeader>\n              <StyledClosed stroke=\"black\" onClick={wrappedOndismiss} />\n            </RowBetween>\n            <ThemedText.LargeHeader>\n              <Trans>{formatCurrencyAmount(availableVotes, 4)} Votes</Trans>\n            </ThemedText.LargeHeader>\n            <ButtonPrimary onClick={onVote}>\n              <ThemedText.MediumHeader color=\"white\">\n                {voteOption === VoteOption.Against ? (\n                  <Trans>Vote against proposal {proposalId}</Trans>\n                ) : voteOption === VoteOption.For ? (\n                  <Trans>Vote for proposal {proposalId}</Trans>\n                ) : (\n                  <Trans>Vote to abstain on proposal {proposalId}</Trans>\n                )}\n              </ThemedText.MediumHeader>\n            </ButtonPrimary>\n          </AutoColumn>\n        </ContentWrapper>\n      )}\n      {attempting && !hash && (\n        <ConfirmOrLoadingWrapper>\n          <RowBetween>\n            <div />\n            <StyledClosed onClick={wrappedOndismiss} />\n          </RowBetween>\n          <ConfirmedIcon>\n            <CustomLightSpinner src={Circle} alt=\"loader\" size={'90px'} />\n          </ConfirmedIcon>\n          <AutoColumn gap=\"100px\" justify={'center'}>\n            <AutoColumn gap=\"12px\" justify={'center'}>\n              <ThemedText.LargeHeader>\n                <Trans>Submitting Vote</Trans>\n              </ThemedText.LargeHeader>\n            </AutoColumn>\n            <ThemedText.SubHeader>\n              <Trans>Confirm this transaction in your wallet</Trans>\n            </ThemedText.SubHeader>\n          </AutoColumn>\n        </ConfirmOrLoadingWrapper>\n      )}\n      {hash && (\n        <ConfirmOrLoadingWrapper>\n          <RowBetween>\n            <div />\n            <StyledClosed onClick={wrappedOndismiss} />\n          </RowBetween>\n          <ConfirmedIcon>\n            <ArrowUpCircle strokeWidth={0.5} size={90} color={theme.primary1} />\n          </ConfirmedIcon>\n          <AutoColumn gap=\"100px\" justify={'center'}>\n            <AutoColumn gap=\"12px\" justify={'center'}>\n              <ThemedText.LargeHeader>\n                <Trans>Transaction Submitted</Trans>\n              </ThemedText.LargeHeader>\n            </AutoColumn>\n            {chainId && (\n              <ExternalLink\n                href={getExplorerLink(chainId, hash, ExplorerDataType.TRANSACTION)}\n                style={{ marginLeft: '4px' }}\n              >\n                <ThemedText.SubHeader>\n                  <Trans>View transaction on Explorer</Trans>\n                </ThemedText.SubHeader>\n              </ExternalLink>\n            )}\n          </AutoColumn>\n        </ConfirmOrLoadingWrapper>\n      )}\n    </Modal>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}